var gif = [];
gif[0] =
  "data:img/gif;base64,R0lGODlhFQAVAJEAAAAAAP//AL29vQAAACH5BAAHAP8ALAAAAAAVABUAAAJAlI+py50AoUMwWCsduBy33XXAAoaiUlZY+nBq8MKUSY9HSbtzft4X/vu1MCLhcBXRoXgyBlD5AWYmgsiUis0yCgA7";
gif[1] =
  "data:img/gif;base64,R0lGODlhFQAVAJEAAAAAAP//AMDAwICAACH5BAAHAP8ALAAAAAAVABUAAAJHlI+py50AoUMwWCsduBy33XXAAoaiAkZqFYwUprZx+27xTR/swMoD/DKZXIaSkEMsXoytJQo58zyPOdIxSWJmJoIV9wueFAAAOw==";
gif[2] =
  "data:img/gif;base64,R0lGODlhFQAVAJEAAAAAAP//AMDAwAAAACH5BAAHAP8ALAAAAAAVABUAAAJDlI+py50AoUMwWCsduBy33XXAAm5gYHrPdWLs6p6parShSN36eNg6LbBFKhxejyV6wXwo4PGH+vyMDCKLqhlOttxuAQA7";
var gfs = [];
for (var i = 0; i < 4; i++) {
  gfs[i] = new Image();
}
gfs[0].src =
  "data:img/gif;base64,R0lGODlhGQAZAJEAAP///8DAwICAgAAAACH5BAQUAP8ALAAAAAAZABkAAAJKhI+pFrH/GpwnCFGb3nxfzHQi92XjWYbnmAIrepkvGauzV7s3Deq71vrhekJgrtgIIpVFptD5g+6kN+osZflot9xPsgvufsPkSwEAOw==";
gfs[1].src =
  "data:img/gif;base64,R0lGODlhGQAZAKIAAP///8DAwICAgP8AAAAAAAAAAAAAAAAAACH5BAAHAP8ALAAAAAAZABkAAANsCLrcriG8OSO9KwiRo//gt3FQaIJjZw7DmZYh25ovEMtzWH+47G6qno8GhAWEOVTRBur9SMxbUrQ8BQiEpyqE1RpBXSLUGtZVI9i0Wu3ZodfwbMR9ja/bZ6s3qjeTNCOBgoMjc4SHhIaIixsJADs=";
gfs[2].src =
  "data:img/gif;base64,R0lGODlhGQAZAJEAAP///4CAgP8AAAAAACH5BAQUAP8ALAAAAAAZABkAAAJgjI+py70Co5wUmhrHwPFyzVlBCIYeBGqqik6nkK4s7I6TjFOvCvR42bGhND3AbyPZEX2/GuwILV2iUZGEOgtesUhthuu8VcNbqE74fOZoSTQFiHm9u3G3OCSQ4yv6/aQAADs=";
gfs[3].src =
  "data:img/gif;base64,R0lGODlhGQAZAJEAAP///76+voKCggAAACH5BAAHAP8ALAAAAAAZABkAAAJglI+py70Bo5wUmhrHwPFyzVlCCIYeBGqqik5nkK4s7I6TjFOvCvR42bGhND3AbyPZEX2/GuwILV2iUZGEOgtesUhthuu8VcNbqE74fOZoSTQFiHm9u3G3OBSQ4yv6/aQAADs=";
var gfd = [];
for (var i = 0; i < 10; i++) {
  gfd[i] = new Image();
}
gfd[0].src =
  "data:img/gif;base64,R0lGODlhDQAXAJEAAP8AAIAAAAAAAAAAACH5BAQUAP8ALAAAAAANABcAAAI5lI8Jy3wgmoMRymoc0vqt/G1hB1JkZVKKaQSC60YI/NZPW8dpApZrqvKhfkIPkIi5jFANWUkS5CUKADs=";
gfd[1].src =
  "data:img/gif;base64,R0lGODlhDQAXAJEAAP8AAIAAAAAAAAAAACH5BAQUAP8ALAAAAAANABcAAAI3lI8psc33mDQAmilAdUnv1mkXeHhWuGGlOCpsxGXIpII0dYbjs358v0PlgDGiDfQKPj6cmkJRAAA7";
gfd[2].src =
  "data:img/gif;base64,R0lGODlhDQAXAJEAAP8AAIAAAAAAAAAAACH5BAQUAP8ALAAAAAANABcAAAI8lI8Jy3whmgMvNmsgRC4nSwmaslRkOHKl962QVIYgfFAwta3JBu6i0UHwgp6cztQT/jCSZWTmGN5kn08BADs=";
gfd[3].src =
  "data:img/gif;base64,R0lGODlhDQAXAJEAAP8AAIAAAAAAAAAAACH5BAQUAP8ALAAAAAANABcAAAI5lI8Jy3whmgMvNmsgRC4nSwmaslRkOHKl962QVIYgXMGUvJFebnRi6/qpcECU8OB7XYK2CNIm+3wKADs=";
gfd[4].src =
  "data:img/gif;base64,R0lGODlhDQAXAJEAAP8AAIAAAAAAAAAAACH5BAQUAP8ALAAAAAANABcAAAI8lI8psc0HDJsmCmDptdhCXIFIF3rlOYpkyplftXWgJ9cHU8+3skkNu0usNB/PA+gQin4a0YPyMEF/PF4BADs=";
gfd[5].src =
  "data:img/gif;base64,R0lGODlhDQAXAJEAAP8AAIAAAAAAAAAAACH5BAQUAP8ALAAAAAANABcAAAI5lI8Jy3wgmgtmxSZotYhql2gX1GUbWZ6heSWGCEkWLHNmHR0iwnmKvVOZgiAWr2cU3jBIHKpmc7kKADs=";
gfd[6].src =
  "data:img/gif;base64,R0lGODlhDQAXAJEAAP8AAIAAAAAAAAAAACH5BAQUAP8ALAAAAAANABcAAAI5lI8Jy3wgmgtmxSZotYhql2gX1GUbWZ6heSWGCEkWLHPRiJE2woFPvxupeEDU0HeM5XQ4B6oWdCEKADs=";
gfd[7].src =
  "data:img/gif;base64,R0lGODlhDQAXAJEAAP8AAIAAAAAAAAAAACH5BAQUAP8ALAAAAAANABcAAAI5lI8Jy3whmgMvNmsgRC4nSwmaslRkOHKl963buIUejLziHZnkfOpHl/qtcCoU0dDBpVy8WO0W/EgLADs=";
gfd[8].src =
  "data:img/gif;base64,R0lGODlhDQAXAIAAAP8AAAAAACH5BAQUAP8ALAAAAAANABcAAAI0jI8Jy3wQmoMRymoc0vqt/G1hB1JkZVKKiTaRJ4VvbIGJja6pWvbirvPBbJdRawKL3ZaGAgA7";
gfd[9].src =
  "data:img/gif;base64,R0lGODlhDQAXAJEAAP8AAIAAAAAAAAAAACH5BAQUAP8ALAAAAAANABcAAAI6lI8Jy3wgmoMRymoc0vqt/G1hB1JkZVKKiTaRJ4VC0E4HnWDzLqp4b6D9SrecRrjy1XS0mAUWy0kNBQA7";
var gfb = [];
for (var i = 0; i < 9; i++) {
  gfb[i] = new Image();
}
gfb[0].src =
  "data:img/gif;base64,R0lGODlhGQAZAKIAAM7OzsbGxr6+vra2trKysqampoKCggAAACH5BAAHAP8ALAAAAAAZABkAAANHaLrc3mWQSau9xAwQuv9gGBhEIJxoqq4CabLw6sY0Otf0jcP6Lpc+HjD4exFTvWNrqDwlj09iNDj1VXdXXLa2zTGb3VgYlgAAOw==";
gfb[1].src =
  "data:img/gif;base64,R0lGODlhGQAZAJEAAMDAwICAgAAA/wAAACH5BAQUAP8ALAAAAAAZABkAAAJMjI+py70Ao5wUmorxzTxuLIRC9lFiSAbZOWqqybZVCcWoC8fpeu5gj/uJfBUWMXebvYpAJdJGoQFsTc8yQh1OpJ3otesEH8XbLzlSAAA7";
gfb[2].src =
  "data:img/gif;base64,R0lGODlhGQAZALMAAMDAwKu5q6i4qKW3pZy0nJaylpCwkIquioCAgACAAAAAAAAAAAAAAAAAAAAAAAAAACH5BAAHAP8ALAAAAAAZABkAAAReEMlJq704X8C7/yAnhSQ5lmh3cknrvi64wvT7zXV9I50N+ipeihXzrFACoEhYMtB2pSSsIGN6CrRBIHQEEGjb0pEmGOJch+Gyl3samW13kB0vztViKx665+r7a4AfEQA7";
gfb[3].src =
  "data:img/gif;base64,R0lGODlhGQAZAJEAAMDAwICAgP8AAAAAACH5BAQUAP8ALAAAAAAZABkAAAJOjI+py70Ao5wUmorxzTxuIITiOFIfiZbSmabT16le0EWyRdeg+OZTGzL5JECBsFI86m4AGIfpzEB9RVLPVuWtqFnjVZeJgmdjzbBMRk8KADs=";
gfb[4].src =
  "data:img/gif;base64,R0lGODlhGQAZAJEAAMDAwICAgAAAmQAAgCH5BAAHAP8ALAAAAAAZABkAAAJdjI+py70Ao5wUmorxzTzuOgjAQJLUN5FiaU5oVK7sGVAxxA50Gor47KrBVJLc7hfilY6jnHMp+TynwYjgisXmfB4hx1jtgKPezLjbaULJ6bOlnK684mG6HG5H5ykFADs=";
gfb[5].src =
  "data:img/gif;base64,R0lGODlhGQAZAJEAAMDAwICAgIAAAAAAACH5BAQUAP8ALAAAAAAZABkAAAJOjI+py70Ao5wUmorxzTxuIITiSE4fiY5mEKXu2oodDKmzx9bybeWgW6L9gDZcjLgz3oo9HhPw6TxPyGRTVxUIs1ohjxL9SsLia3nsO0MKADs=";
gfb[6].src =
  "data:img/gif;base64,R0lGODlhGQAZAJEAAMDAwICAgACAgAAAACH5BAQUAP8ALAAAAAAZABkAAAJTjI+py70Ao5wUmorxzTxuKITiKFIfiZbTmaJmEI3dCoPqbNWAjOdxS3r9gDyPjhiUsEKVos/GpDgBS0Hz9twhsdTjNmqUfIU9ja5MQ1c+6nBbUgAAOw==";
gfb[7].src =
  "data:img/gif;base64,R0lGODlhGQAZAJEAAL6+voKCggAAAAAAACH5BAAHAP8ALAAAAAAZABkAAAJMjI+py70Ao5wUmorxzTxuIITiSE4fiY5mEKXu2rUiHIOz9HElznY771NRcpQfrWI8TpJK2S1DtD2hPWeoRhTGojVgV1P9NsWWMBlSAAA7";
gfb[8].src =
  "data:img/gif;base64,R0lGODlhGQAZAIAAAMDAwICAgCH5BAQUAP8ALAAAAAAZABkAAAJKjI+py70Ao5wUmorxzTxu63xeMIYi8JnHlK4UwpLgOctjaUuwnqtvb/rxQsJaZXcz/k4tGsqVfPp4OCK1yih2OM7t1avJgWNjTAEAOw==";
document.oncontextmenu = function () {
  return false;
};
document.onselectstart = function () {
  return false;
};
function consoleOpenCallback() {
  window.close();
  window.location = "about:blank";
}
var isTest = 1;
function $(a) {
  return document.getElementById(a);
}

function shake(ele, cls, times) {
  var i = 0,
    t = false,
    c = "",
    o = ele.getAttribute("class"),
    times = times || 2;
  if (o == null) o = "";
  if (t) return;
  t = setInterval(function () {
    i++;
    c = i % 2 ? o + cls : o;
    ele.setAttribute("class", c);
    if (i == 2 * times) {
      clearInterval(t);
      ele.removeAttribute(cls);
    }
  }, 200);
}
Date.prototype.Format = function (fmt) {
  var o = {
    "M+": this.getMonth() + 1,
    "d+": this.getDate(),
    "h+": this.getHours(),
    "m+": this.getMinutes(),
    "s+": this.getSeconds(),
    "q+": Math.floor((this.getMonth() + 3) / 3),
    S: this.getMilliseconds(),
  };
  if (/(y+)/.test(fmt))
    fmt = fmt.replace(
      RegExp.$1,
      (this.getFullYear() + "").substr(4 - RegExp.$1.length)
    );
  for (var k in o)
    if (new RegExp("(" + k + ")").test(fmt))
      fmt = fmt.replace(
        RegExp.$1,
        RegExp.$1.length == 1 ? o[k] : ("00" + o[k]).substr(("" + o[k]).length)
      );
  return fmt;
};
var d31 = [];
var X, Y, M;
var CX = [-1, -1, -1, 0, 0, 1, 1, 1, 0];
var CY = [-1, 0, 1, -1, 1, -1, 0, 1, 0];
var _gs;
function S98(h, j) {
  ctx.drawImage(gfb[0], h * 25, j * 25);
  setTimeout(function () {
    if (d31[j][h][0] == 0) {
      ctx.drawImage(gfs[0], h * 25, j * 25);
    }
  }, 120);
}
function c67(h, j) {
  var K = 0,
    L = 0;
  var q, s;
  var E;
  var u, A;
  for (E = 0; E < 8; E++) {
    s = j + CY[E];
    q = h + CX[E];
    if (s >= 0 && s < Y && q >= 0 && q < X) {
      u = d31[s][q];
      A = u[0];
      if (A == 2) {
        K++;
      } else {
        if (A == 0) {
          if (u[1] == 1) {
            L = 1;
          }
        }
      }
    }
  }
  var t = d31[j][h];
  var N = K >= t[2];
  for (E = 0; E < 8; E++) {
    s = j + CY[E];
    q = h + CX[E];
    if (s >= 0 && s < Y && q >= 0 && q < X) {
      var u = d31[s][q];
      if (u[0] == 0) {
        if (N) {
          if (L) {
            if (u[1] == 1) {
              ctx.drawImage(gfs[2], q * 25, s * 25);
              u[0] = 1;
            }
          } else {
            o0o(q, s);
          }
        } else {
          S98(q, s);
        }
      }
    }
  }
  if (N && L) {
    fail();
  }
}
function fail() {
  _edn();
  $("face").src = gif[2];
  _gs = 3;
  var h, j;
  var t;
  for (j = 0; j < Y; j++) {
    for (h = 0; h < X; h++) {
      t = d31[j][h];
      if (t[0] == 0) {
        if (t[1] == 1) {
          ctx.drawImage(gfs[3], h * 25, j * 25);
        }
      } else {
        if (t[0] == 2) {
          if (t[1] == 0) {
            h_f[f_n++] = setInterval(
              (function (h, j) {
                var ba = 0;
                return function () {
                  ctx.drawImage(
                    ba == 0 ? gfb[d31[j][h][2]] : gfs[1],
                    h * 25,
                    j * 25
                  );
                  ba = !ba;
                };
              })(h, j),
              800
            );
          }
        }
      }
    }
  }
}
var _ln;
function see() {
  _ln = [];
  var h, j, t;
  var bm = 0,
    bn = 0;
  for (j = 0; j < Y; j++) {
    for (h = 0; h < X; h++) {
      t = d31[j][h];
      if (t[0] == 2 && t[1] != 1) {
        return 1;
      }
      if (t[0] == 0 && t[3] == 0) {
        if (t[1] == 1) {
          bm++;
        } else {
          bn++;
        }
        _ln.push([h, j]);
      }
    }
  }
  if (bm != bn) {
    return 2;
  }
  return 0;
}
function gtm(h, j) {
  var w = 0;
  var q, s;
  for (var E = 0; E < 8; E++) {
    s = j + CY[E];
    q = h + CX[E];
    if (s >= 0 && s < Y && q >= 0 && q < X) {
      if (d31[s][q][1] == 1) {
        w++;
      }
    }
  }
  return w;
}
function rv() {
  var c, d, u;
  for (d = 0; d < _ln.length; d++) {
    c = _ln[d];
    u = d31[c[1]][c[0]];
    u[1] = u[1] == 0 ? 1 : 0;
  }
}
function ck() {
  if (see() != 0) {
    return 1;
  }
  rv();
  var h, j, t;
  var w;
  for (j = 0; j < Y; j++) {
    for (h = 0; h < X; h++) {
      t = d31[j][h];
      w = t[2];
      if (t[0] == 1 && w != 0) {
        if (gtm(h, j) != w) {
          rv();
          return 2;
        }
      }
    }
  }
  for (j = 0; j < Y; j++) {
    for (h = 0; h < X; h++) {
      t = d31[j][h];
      if (t[0] != 1) {
        t[2] = gtm(h, j);
      }
    }
  }
  return 0;
}
function ab(C, D) {
  var t, u;
  var s, q;
  var A;
  var B, w;
  var h, j;
  var E, c;
  for (c = 0; c < 9; c++) {
    j = D + CY[c];
    h = C + CX[c];
    if (j >= 0 && j < Y && h >= 0 && h < X) {
      t = d31[j][h];
      w = t[2];
      if (t[0] == 1 && w > 0) {
        B = 0;
        for (E = 0; E < 8; E++) {
          s = j + CY[E];
          q = h + CX[E];
          if (s >= 0 && s < Y && q >= 0 && q < X) {
            u = d31[s][q];
            A = u[0];
            if (A == 0) {
              B++;
            } else {
              if (A == 2) {
                if (u[1] == 1) {
                  w--;
                }
              }
            }
          }
        }
        if (B > 0 && w == B) {
          for (E = 0; E < 8; E++) {
            s = j + CY[E];
            q = h + CX[E];
            if (s >= 0 && s < Y && q >= 0 && q < X) {
              u = d31[s][q];
              A = u[0];
              if (A != 1) {
                u[3] = 1;
              }
              if (A == 0) {
                if (_automine == 1) {
                  M5k(q, s);
                }
              }
            }
          }
        }
      }
    }
  }
}
function o0o(h, j) {
  var t = d31[j][h];
  if (t[1] == 1) {
    if (_gs == 1) {
      ck();
    }
    if (t[1] == 1) {
      ctx.drawImage(gfs[2], h * 25, j * 25);
      t[0] = 1;
      fail();
      return 1;
    }
  }
  t[0] = 1;
  ctx.drawImage(gfb[t[2]], h * 25, j * 25);
  RB--;
  if (RB == 0) {
    success();
  } else {
    if (t[2] == 0) {
      var E, s, q;
      for (E = 0; E < 8; E++) {
        s = j + CY[E];
        q = h + CX[E];
        if (s >= 0 && s < Y && q >= 0 && q < X) {
          if (d31[s][q][0] == 0) {
            o0o(q, s);
          }
        }
      }
    }
  }
  ab(h, j);
  return 0;
}
function success() {
  _gs = 2;
  _edn();
  var h, j, t;
  for (j = 0; j < Y; j++) {
    for (h = 0; h < X; h++) {
      t = d31[j][h];
      if (t[0] == 0) {
        if (t[1] != 1) {
          bug(1, h, j);
        } else {
          M5k(h, j);
        }
      }
    }
  }
  if (RM != 0) {
    bug(2, h, j);
  }
  crm(M);
  $("face").src = gif[1];
}
var _level;

function DS(O) {
  var P = $(O);
  var R = P.getContext("2d");
  var Q = 3;
  return function (T) {
    if (T < 10) {
      T = "00" + T;
    } else {
      if (T < 100) {
        T = "0" + T;
      } else {
        T = T.toString();
      }
    }
    var S = T.length;
    if (S != Q) {
      P.width = S * 13;
      Q = S;
    }
    for (var d = 0; d < S; d++) {
      R.drawImage(gfd[parseInt(T.charAt(d))], d * 13, 0);
    }
  };
}
function oneclick(bg, bh) {
  var start_time = new Date().valueOf();
  const t1 = {
    start_time: start_time,
    start_level: localStorage.getItem("level"),
  };
  var E;
  var j, h;
  var bf = RB;
  for (E = 8; E >= 0 && bf > 0; E--) {
    j = bh + CY[E];
    h = bg + CX[E];
    if (j >= 0 && j < Y && h >= 0 && h < X) {
      var Z = p32[j * X + h];
      if (d31[j][h][1] == 1) {
        var W = Math.floor(Math.random() * bf);
        mplus(Z, -1);
        mplus(W, 1);
        bf--;
        ex(W, bf);
      } else {
        bf--;
        ex(Z, bf);
      }
    }
  }
  _es();
}
var d32 = [],
  p32 = [];
function _gnt() {
  var h, j;
  var o;
  var p;
  for (j = 0; j < Y; j++) {
    d31[j] = [];
    for (h = 0; h < X; h++) {
      d31[j][h] = [0, 0, 0, 0];
    }
  }
  for (p = 0; p < XY; p++) {
    d32[p] = p;
    p32[p] = p;
  }
  RB = XY;
  for (o = 0; o < M; o++) {
    p = Math.floor(Math.random() * RB);
    RB--;
    ex(p, RB);
  }
  for (p = RB; p < XY; p++) {
    mplus(p, 1);
  }
  RM = M;
  RB = XY - M;
}
function ex(W, Z) {
  var U = d32[W];
  var V = d32[Z];
  d32[W] = V;
  d32[Z] = U;
  p32[U] = Z;
  p32[V] = W;
}
function mplus(p, bj) {
  var bl, bk;
  var rv = d32[p];
  bl = Math.floor(rv / X);
  bk = rv % X;
  d31[bl][bk][1] += bj;
  for (z = 0; z < 8; z++) {
    cy = bl + CY[z];
    cx = bk + CX[z];
    if (cy >= 0 && cy < Y && cx >= 0 && cx < X) {
      d31[cy][cx][2] += bj;
    }
  }
}
var h_f = [];
var f_n = 0;
function restart() {
  if (he > 0) {
    clearInterval(he);
    he = 0;
  }
  for (var d = 0; d < f_n; d++) {
    clearInterval(h_f[d]);
  }
  f_n = 0;
  _gnt();
  _d46();
  _x0 = -1;
  _y0 = -1;
  _gs = 0;
}
var _mp1, _mp2;
var _x0;
var _y0;
function _onmousedown(e) {
  if (_tch || _gs > 1) {
    return;
  }
  var f = paf.getBoundingClientRect();
  var h = Math.floor((e.clientX - f.left) / 25);
  var j = Math.floor((e.clientY - f.top) / 25);
  if (h < 0 || h == X || j < 0 || j == Y) {
    return;
  }
  _x0 = h;
  _y0 = j;
  var g = d31[j][h][0];
  if (e.button == 2) {
    if (_mp2 != 1) {
      if (g == 1) {
        c67(h, j);
      } else {
        M5k(h, j);
      }
    }
  } else {
    if (_mp1 != 1) {
      if (g == 0) {
        if (_gs == 0) {
          oneclick(h, j);
        }
        o0o(h, j);
      } else {
        if (g == 1) {
          c67(h, j);
        } else {
          M5k(h, j);
        }
      }
    }
  }
}
function _onmouseup(e) {
  if (_tch || _gs > 1) {
    return;
  }
  var f = paf.getBoundingClientRect();
  var h = Math.floor((e.clientX - f.left) / 25);
  var j = Math.floor((e.clientY - f.top) / 25);
  if (h < 0 || h == X || j < 0 || j == Y) {
    return;
  }
  var g = d31[j][h][0];
  if (e.button == 2) {
    if (_mp2 != null) {
      if (g == 1) {
        c67(h, j);
      } else {
        M5k(h, j);
      }
    }
  } else {
    if (_mp1 != null) {
      if (g == 0) {
        if (_gs == 0) {
          oneclick(h, j);
        }
        o0o(h, j);
      } else {
        if (g == 1) {
          c67(h, j);
        } else {
          M5k(h, j);
        }
      }
    }
  }
}
function _ontouchstart(e) {
  if (_gs > 1) {
    return;
  }
  _tch = 1;
  var f = paf.getBoundingClientRect();
  var h = Math.floor((e.touches[0].clientX - f.left) / 25);
  var j = Math.floor((e.touches[0].clientY - f.top) / 25);
  if (h < 0 || h == X || j < 0 || j == Y) {
    return;
  }
  if (d31[j][h][0] == 1) {
    c67(h, j);
  } else {
    _hl = setTimeout(function () {
      return lgt(h, j);
    }, 320);
  }
}
var _hl;
function lgt(h, j) {
  if (_opn == 1 && _tpn == null) {
    return;
  }
  if (_gs == 0) {
    oneclick(h, j);
    o0o(h, j);
    return;
  }
  _tch = 3;
  if (_tpn == null) {
    if (d31[j][h][0] == 2) {
      M5k(h, j);
    }
    if (d31[j][h][0] == 0) {
      o0o(h, j);
    }
  } else {
    M5k(h, j);
  }
}
var tc0 = 0;
function _ontouchend(e) {
  if (_tch == 1) {
    var f = paf.getBoundingClientRect();
    var h = Math.floor((e.changedTouches[0].clientX - f.left) / 25);
    var j = Math.floor((e.changedTouches[0].clientY - f.top) / 25);
    if (h < 0 || h == X || j < 0 || j == Y) {
      return;
    }
    var g = d31[j][h][0];
    if (_gs == 0) {
      oneclick(h, j);
      o0o(h, j);
      return;
    }
    if (_tpn == null) {
      if (g != 1) {
        var k = Date.now();
        var l;
        if (h == _x0 && j == _y0) {
          l = k - tc0;
        } else {
          _x0 = h;
          _y0 = j;
          tc0 = Date.now();
          l = 1000;
        }
        if (_opn == 1 && l < 400 && g == 0) {
          o0o(h, j);
        } else {
          M5k(h, j);
        }
      }
    } else {
      if (g == 0) {
        o0o(h, j);
      } else {
        if (g == 2) {
          M5k(h, j);
        }
      }
    }
    _tch = 4;
    clearTimeout(_hl);
    tc0 = k;
  }
  if (e.preventDefault) {
    e.preventDefault();
  } else {
    window.event.returnValue = false;
  }
}
var _automine;
function automine() {
  _automine = $("automine").checked ? 1 : 0;
  localStorage.setItem("automine", _automine);
  restart();
}
function _d46() {
  _edn();
  he = 0;
  _tch = 0;
  _mp1 = localStorage.getItem("mp1");
  _mp2 = localStorage.getItem("mp2");
  _tpn = localStorage.getItem("tpn");
  _opn = localStorage.getItem("opn");
  _automine = localStorage.getItem("automine");
  if (_automine == null) _automine = 0;
  var n = X * 25;
  $("p42").style.width = n + 4 + "px";
  paf.width = n;
  paf.height = Y * 25;
  $("face").src = gif[0];
  for (var d = 0; d < X; d++) {
    for (var m = 0; m < Y; m++) {
      ctx.drawImage(gfs[0], d * 25, m * 25);
    }
  }
  paf.onmousedown = function (e) {
    _onmousedown(e);
  };
  paf.onmouseup = function (e) {
    _onmouseup(e);
  };
  paf.ontouchstart = function (e) {
    _ontouchstart(e);
  };
  paf.ontouchmove = function () {
    _tch = 2;
    clearTimeout(_hl);
  };
  paf.ontouchend = function (e) {
    _ontouchend(e);
  };
  crm(RM);
  ces(0);
  $("automine").checked = parseInt(_automine);
}
function sopen() {
  var bq = 0;
  var br = -1,
    bs = -1;
  for (var d = 0; d < X; d++) {
    var bt = 0;
    for (var m = 0; m < Y; m++) {
      if (d31[m][d][2] == 0 && d31[m][d][1] == 0) {
        bt++;
      } else {
        if (bt > bq) {
          bq = bt;
          br = d;
          bs = m - 1;
        }
        bt = 0;
      }
    }
    if (bt > bq) {
      bq = bt;
      br = d;
      bs = m - 1;
    }
  }
  if (br >= 0 && bs >= 0) {
    o0o(br, bs);
  }
}
function _edn() {
  if (he > 0) {
    clearInterval(he);
    he = 0;
    _t0 = Date.now() - _t0;
    ces(parseInt(_t0 / 1000));
    _t0 = Math.ceil(_t0 / 100);
  } else {
    _t0 = 0;
  }
}
var he = 0;
var _t0;
var step;
function _es() {
  _t0 = Date.now();
  step = 0;
  _gs = 1;
  he = setInterval(function () {
    ces(++step);
  }, 1000);
}
var _tpn;
var _opn;
var _tch;
var RM;
var RB;
function M5k(h, j) {
  var t = d31[j][h];
  if (t[0] == 0) {
    if (RM > 0) {
      if (t[1] == 0) {
        ck();
      }
      ctx.drawImage(gfs[1], h * 25, j * 25);
      t[0] = 2;
      crm(--RM);
    }
  } else {
    if (t[0] == 2) {
      ctx.drawImage(gfs[0], h * 25, j * 25);
      t[0] = 0;
      crm(++RM);
    }
  }
}
var paf;
var ctx;
var crm;
var ces;
function init() {
  var bv = localStorage.getItem("custom");
  if (bv == null) {
    $("diywidth").value = 15;
    $("diyheight").value = 15;
    $("diymines").value = 20;
  } else {
    var bu = bv.split(";");
    $("diywidth").value = bu[0];
    $("diyheight").value = bu[1];
    $("diymines").value = bu[2];
  }
  paf = $("paf");
  ctx = paf.getContext("2d");
  crm = DS("rm");
  ces = DS("es");
  set_level(localStorage.getItem("level"));
}
var _id = null;
function getid() {
  if (_id != null) {
    return _id;
  }
  var name = localStorage.getItem("uid");
  if (name != null) {
    if (name != "匿名") {
      $("tip").innerHTML = "";
    } else {
      $("tip").innerHTML = "(←单击可改)";
      shake($("tip"), "shake-red", 3);
    }
  } else {
    name = "匿名";
    $("tip").innerHTML = "(←单击可改)";
    shake($("tip"), "shake-red", 3);
  }
  return name;
}
function guid() {}
var XY, SW, SH;
function set_level(c) {
  _gs = 0;
  SW = document.body.clientWidth;
  SH = document.body.clientHeight;
  if (c == null) {
    c = SW < 560 ? 1 : 2;
  }
  _level = c;
  $("custom").style.display = c == 5 ? "" : "none";
  if (c == 1) {
    X = 9;
    Y = 9;
    M = 10;
    XY = 81;
  } else {
    if (c == 2) {
      X = 16;
      Y = 16;
      M = 40;
      XY = 256;
    } else {
      if (c == 3) {
        M = 99;
        if (SW > SH) {
          X = 30;
          Y = 16;
        } else {
          X = 16;
          Y = 30;
        }
        XY = 480;
      } else {
        if (c == 4) {
          X = parseInt((SW - 18) / 25);
          Y = parseInt((SH - 54) / 25);
          XY = X * Y;
          if (XY >= 480) {
            M = XY * 0.20625;
          } else {
            M = (XY * XY) / 5760 + XY / 8;
          }
          M = parseInt(M);
        } else {
          if (c == 5) {
            X = parseInt($("diywidth").value);
            Y = parseInt($("diyheight").value);
            XY = X * Y;
            M = parseInt($("diymines").value);
            if (M > XY) {
              M = XY;
            }
          } else {
            return;
          }
        }
      }
    }
  }
  restart();
  localStorage.setItem("level", c);
}
var score;
function custom() {
  set_level(5);
  localStorage.setItem(
    "custom",
    $("diywidth").value + ";" + $("diyheight").value + ";" + $("diymines").value
  );
}
function getStorage(v) {
  var a = localStorage.getItem(v);
  if (a == null) a = 0;
  var b = document.getElementsByName(v);
  for (i = 0; i < b.length; i++) {
    if (b[i].value == a) {
      b[i].checked = true;
    }
  }
  return a;
}
function setStorage(id, v) {
  if (v == 0) {
    localStorage.removeItem(id);
    v = null;
  } else {
    localStorage.setItem(id, v);
  }
  eval("_" + id + "=" + v);
}
function morehide(c) {
  if (c == 0) {
    $("topen").style.display = "block";
    $("thint").style.display = "none";
  } else {
    $("thint").style.display = "block";
    $("topen").style.display = "none";
  }
}
var setHtml = (function (open_id, this_id) {
  var b = 0;
  return function () {
    getStorage("mp1");
    getStorage("mp2");
    if (b == 0) {
      $("_mouse").style.display = "block";
      $("setm").innerText = "\u6536\u8d77";
      b = 1;
    } else {
      $("_mouse").style.display = "none";
      $("setm").innerText = "\u8bbe\u7f6e";
      b = 0;
    }
  };
})();
var set_mouse = (function () {
  var b = 0;
  return function () {
    getStorage("mp1");
    getStorage("mp2");
    if (b == 0) {
      $("_mouse").style.display = "block";
      $("setm").innerText = "\u6536\u8d77";
      b = 1;
    } else {
      $("_mouse").style.display = "none";
      $("setm").innerText = "\u8bbe\u7f6e";
      b = 0;
    }
  };
})();
var set_touch = (function () {
  var b = 0;
  return function () {
    var rv = getStorage("tpn");
    getStorage("opn");
    morehide(rv);
    if (b == 0) {
      $("_touch").style.display = "block";
      $("sett").innerText = "\u6536\u8d77";
      b = 1;
    } else {
      $("_touch").style.display = "none";
      $("sett").innerText = "\u8bbe\u7f6e";
      b = 0;
    }
  };
})();
var _input = 0;

function savename() {
  var name = $("name").value;
  name = name.split(/\s+/).join("");
  if (name.length == 0) {
    name = "匿名";
    $("tip").innerHTML = "(←单击可改)";
    shake($("tip"), "shake-red", 3);
  }
  if (name != "匿名") {
    $("tip").innerHTML = "";
  } else {
    $("tip").innerHTML = "(←单击可改)";
    shake($("tip"), "shake-red", 3);
  }

  localStorage.setItem("uid", name);
  _input = 0;
}
