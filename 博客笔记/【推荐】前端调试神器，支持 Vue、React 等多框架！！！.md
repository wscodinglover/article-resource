**èƒŒæ™¯åŠç›¸å…³ä¿¡æ¯**

ä¸çŸ¥é“ä½ æ˜¯å¦é‡åˆ°è¿‡äº§å“æˆ–è€…æµ‹è¯•ç»™ä½ ä¸€ä¸ªé¡µé¢è®©ä½ æ”¹ä¸€ç‚¹ä¸œè¥¿ï¼Œä½ å´æ‰¾ä¸åˆ°é¡µé¢æºä»£ç åœ¨å“ªé‡Œçš„åœºæ™¯ï¼Ÿå¯¹äºä¸€äº›å¤§å‹é¡¹ç›®ï¼Œæ–‡ä»¶æ•°é‡å¤šã€æ–‡ä»¶å±‚çº§æ·±ã€ä»£ç è¡Œæ•°å¤šï¼ŒæŸ¥æ‰¾ä¸€ä¸ªé¡µé¢ä¸Šç»„ä»¶å¯¹åº”çš„æºä»£ç ä½ç½®ï¼Œå¾€å¾€éœ€è¦èŠ±è´¹å¤§é‡æ—¶é—´ã€‚

ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘å¼€å‘äº†Â `code-inspector-plugin`Â æ’ä»¶ï¼Œåªéœ€è¦ç‚¹å‡»é¡µé¢ä¸Šçš„å…ƒç´ ï¼Œå°±èƒ½å¤Ÿè‡ªåŠ¨æ‰“å¼€ vscode å®šä½åˆ°æºä»£ç ã€‚å·²ç»åœ¨å¿«æ‰‹å†…éƒ¨30+é¡¹ç›®ä¸­æ¥å…¥äº†ä½¿ç”¨ï¼Œå–å¾—äº†ä¸é”™çš„åå“ã€‚æ•ˆæœå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š

![Image](https://mmbiz.qpic.cn/sz_mmbiz_gif/iagNW4Zy9CyZjuibqs47Oerb0MWibH1XpWOuMiaKjIziadA2nibP2gJpPnLUHFicjqwJHhthkYT0ZGFGia6vhRvST6kkqA/640?wx_fmt=gif&from=appmsg&wxfrom=5&wx_lazy=1&wx_co=1&tp=webp)

ç‚¹å‡»ä¸‹è¿°çš„ demoï¼Œä¹Ÿå¯ä»¥å¿«é€Ÿåœ¨çº¿ä½“éªŒæ•ˆæœï¼š

-   vue online demo<sup data-darkreader-inline-outline="" data-darkreader-inline-color="">[1]</sup>
    
-   react online demo<sup data-darkreader-inline-outline="" data-darkreader-inline-color="">[2]</sup>
    
-   preact online demo<sup data-darkreader-inline-outline="" data-darkreader-inline-color="">[3]</sup>
    
-   solid online demo<sup data-darkreader-inline-outline="" data-darkreader-inline-color="">[4]</sup>
    
-   æ¥å…¥ï¼šæƒ³è¦ä½¿ç”¨çš„å°ä¼™ä¼´ï¼Œå¯ä»¥å‚è€ƒcode-inspector-pluginæ¥å…¥æ–‡æ¡£<sup data-darkreader-inline-outline="" data-darkreader-inline-color="">[5]</sup>æ¥å…¥ä½¿ç”¨
    
-   github æºç ï¼šè§‰å¾—æ’ä»¶å¥½ç”¨çš„å¯ä»¥è¾›è‹¦åŠ¨ä¸‹å°æ‰‹å¸®ä½œè€… github ç‚¹ä¸ª starï¼šcode-inspector<sup data-darkreader-inline-outline="" data-darkreader-inline-color="">[6]</sup>
    

## **code-inspector-plugin çš„ä¼˜ç‚¹**

å…¶å®Â `code-inspector-plugin`Â æ˜¯ä¹‹å‰æˆ‘çœ‹åˆ°è¿‡ä¸€ç¯‡ react ç‚¹å‡»é¡µé¢å…ƒç´ å®šä½æºä»£ç çš„æ–‡ç« ï¼Œå—åˆ°å¯å‘åå®ç°çš„ã€‚ä½†æ˜¯ç›¸æ¯”è€Œè¨€ï¼ŒÂ `code-inspector-plugin`Â åœ¨æ”¯æŒåœºæ™¯çš„ä¸°å¯Œæ€§ä»¥åŠæ¥å…¥çš„ä¾¿æ·ç¨‹åº¦ä¸Šï¼Œéƒ½å¾—åˆ°äº†å·¨å¤§çš„æå‡ï¼Œå…·å¤‡ä»¥ä¸‹ä¼˜åŠ¿ï¼š

-   æ”¯æŒçš„æ‰“åŒ…å™¨æ›´åŠ å¹¿æ³›ï¼šæ”¯æŒÂ `webpack/vite/rspack`Â ä»¥åŠÂ `umi`Â ç­‰ä¸€åˆ‡åŸºäºä¸Šè¿°ä¸‰ä¸ªæ‰“åŒ…å™¨å®ç°çš„æ‰“åŒ…å·¥å…·
    
-   æ”¯æŒçš„æ¡†æ¶åŠåœºæ™¯æ›´åŠ å¹¿æ³›ï¼šæ”¯æŒÂ `vue2/vue3/react/preact/solid`Â æ¡†æ¶ä»¥åŠÂ `next/nuxt`Â ç­‰SSRåœºæ™¯(ä»¥åŠä¸€åˆ‡ä»¥Â `vue2/vue3/react/preact/solid`Â æ¡†æ¶ä¸ºåŸºç¡€å°è£…çš„ SSR åœºæ™¯)ï¼Œæ”¯æŒåœ¨å¾®å‰ç«¯ä¸­ä½¿ç”¨ã€‚
    
-   æ”¯æŒå¤šç§ç³»ç»ŸåŠ IDEï¼šæ”¯æŒ Macã€Windows å’Œ Linux ç³»ç»Ÿï¼Œæ”¯æŒ vscodeã€webstormã€atomã€hbuilderXã€IDEAã€phpsotrm ç­‰å¤šç§ IDEï¼Œä¹Ÿæ”¯æŒè‡ªå®šä¹‰ IDE çš„æ”¯æŒ
    
-   æ¥å…¥æ›´åŠ ç®€ä¾¿ï¼Œå¯¹ä»£ç æ— ä¾µå…¥ï¼šæ— è®ºæ˜¯åœ¨ä»€ä¹ˆé¡¹ç›®ä¸­ï¼Œåªéœ€è¦åœ¨Â `webpack/vite/rspack`Â çš„é…ç½®ä¸­æ·»åŠ Â `code-inspector-plugin`Â æ’ä»¶å³å¯ï¼Œä¸éœ€è¦ä¿®æ”¹ä»»ä½•æºä»£ç æˆ–è€…å…¶ä»–çš„é…ç½®
    
-   è‡ªåŠ¨è¯†åˆ«ç¯å¢ƒï¼šæ’ä»¶å†…éƒ¨ä¼šé’ˆå¯¹Â `webpack/vite/rspack`Â å¼€å‘ç¯å¢ƒä¸‹çš„ä¸€äº›å†…ç½®ä¿¡æ¯ï¼Œè‡ªåŠ¨è¯†åˆ«ç¯å¢ƒï¼Œä»…åœ¨å¼€å‘ç¯å¢ƒä¸‹ç”Ÿæ•ˆï¼Œä¸ä¼šå½±å“ç”Ÿäº§ç¯å¢ƒ
    

## code-inspector-plugin å®ç°åŸç†

ä¸‹é¢æˆ‘ä»¬é‡ç‚¹è§£æä¸€ä¸‹Â `code-inspector-plugin`Â çš„å®ç°åŸç†ï¼Œæ’ä»¶çš„æ•´ä½“åŠŸèƒ½å¯ä»¥ç®€å•æ‹†è§£ä¸ºä»¥ä¸‹å‡ éƒ¨åˆ†ï¼š

-   å‚ä¸æºç ç¼–è¯‘ï¼šæ‰“åŒ…å·¥å…·(webpack/vite/rspack)ç¼–è¯‘æ—¶ï¼Œ`code-inspector-plugin`Â æ’ä»¶ä¼šå‚ä¸ç¼–è¯‘è¿‡ç¨‹ï¼Œå¯¹äºÂ `vue/jsx`Â è¯­æ³•ä¼šè¿›è¡Œ ast è§£æï¼Œè·å–åˆ° dom éƒ¨åˆ†çš„æºä»£ç æ‰€åœ¨çš„Â `æ–‡ä»¶è·¯å¾„ã€è¡Œã€åˆ—`Â ä¿¡æ¯ï¼Œå¹¶å°†è¿™äº›ä¿¡æ¯ä½œä¸º dom ä¸Šçš„Â `attribute`Â é¢å¤–æ·»åŠ è¿›å»ã€‚
    
-   è¿è¡Œæ—¶äº¤äº’ä»£ç ï¼šç¼–è¯‘å®Œæˆåï¼Œæ’ä»¶ä¼šå‘ç½‘é¡µä¸­æ³¨å…¥ç›‘å¬æŒ‰é”®å®šä½æºä»£ç çš„äº¤äº’é€»è¾‘ï¼Œå½“ç”¨æˆ·ç‚¹å‡»å®šä½ dom æ—¶ï¼Œèƒ½å¤Ÿè·å– dom çš„Â `attribute`Â ä¸Šçš„Â `æ–‡ä»¶è·¯å¾„ã€è¡Œã€åˆ—`Â ä¿¡æ¯ï¼Œå°†ä¿¡æ¯å‘é€ä¸€ä¸ª http è¯·æ±‚ç»™åå°
    
-   å¯åŠ¨ä¸€ä¸ª node server æœåŠ¡ï¼šåœ¨åå°å¯åŠ¨ä¸€ä¸ª node server æœåŠ¡ï¼Œç”¨äºæ¥æ”¶ä¸Šä¸€æ­¥å‘é€è¿‡æ¥çš„ http è¯·æ±‚
    
-   è¯†åˆ«å¹¶æ‰“å¼€ IDEï¼šnode server æ”¶åˆ°è¯·æ±‚åï¼Œæ ¹æ®è¯·æ±‚å¸¦è¿‡æ¥çš„Â `æ–‡ä»¶è·¯å¾„ã€è¡Œã€åˆ—`Â ä¿¡æ¯ï¼Œä½¿ç”¨ node çš„Â `spawn`Â æˆ–è€…Â `exec`Â å­è¿›ç¨‹æ‰“å¼€ IDEï¼Œå¹¶å°†é¼ æ ‡å®šä½åˆ° IDE å¯¹åº”çš„ä½ç½®
    

### ç¼–è¯‘ vue/jsx æºä»£ç 

è¦å‚ä¸æºä»£ç çš„ç¼–è¯‘è¿‡ç¨‹ï¼Œå¯¹äºÂ `vite`Â é¡¹ç›®ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ vite æ’ä»¶çš„Â `transform`Â å‡½æ•°å…¥å£ä¸­å®ç°ï¼›å¯¹äºÂ `webpack/rspack`Â é¡¹ç›®ï¼Œå¯ä»¥å®ç°ä¸€ä¸ªÂ `loader`Â å®ç°ã€‚ä¸åŒçš„æ‰“åŒ…å·¥å…·åªæ˜¯å¯¹åº”çš„å…¥å£ä¸åŒï¼Œè€Œå¯¹äºÂ `vue/jsx`Â è¯­æ³•çš„ç¼–è¯‘å’Œè§£æè¿‡ç¨‹éƒ½æ˜¯å…¬ç”¨çš„ã€‚

#### ç¼–è¯‘ vue è¯­æ³•

å¯¹äº vue è¯­æ³•çš„ç¼–è¯‘ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ vue å†…ç½®çš„åŒ…Â `@vue/compiler-dom`Â å®ç°ï¼Œä»¥åŠé€šè¿‡Â `magic-string`Â åŒ…æ¥å‘ ast æ³¨å…¥é¢å¤–çš„ä¿¡æ¯ï¼Œç®€åŒ–çš„ä»£ç å¦‚ä¸‹ï¼š

```
<span data-lazy-bgimg="https://mmbiz.qpic.cn/mmbiz_svg/mOW261WJzibtvLd4SDvxsMK5mAmMjt6dnZbODicB0ibkZPeibmB9BzlK3Fcgqa3WQFqPvoicCTtqHsogtz5PgmGRMQDLGbSzAw2Pj/640?wx_fmt=svg&amp;from=appmsg" data-fail="0" data-darkreader-inline-outline="" data-darkreader-inline-bgcolor=""></span><code data-darkreader-inline-outline="" data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor=""><span data-darkreader-inline-outline="" data-darkreader-inline-color="">import</span>&nbsp;{&nbsp;parse,&nbsp;transform&nbsp;}&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">from</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">'@vue/compiler-dom'</span>;<br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">import</span>&nbsp;MagicString&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">from</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">'magic-string'</span>;<br><br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">//&nbsp;content&nbsp;æ˜¯ç”±&nbsp;vite&nbsp;transform&nbsp;å‡½æ•°æˆ–è€…&nbsp;webpack/rspack&nbsp;loader&nbsp;ä¼ è¿‡æ¥çš„æºä»£ç </span><br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">const</span>&nbsp;s&nbsp;=&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">new</span>&nbsp;MagicString(content);<br><br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">//&nbsp;vue/react&nbsp;éƒ¨åˆ†å†…ç½®å…ƒç´ æ·»åŠ &nbsp;attrs&nbsp;å¯èƒ½æŠ¥é”™ï¼Œä¸å¤„ç†</span><br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">const</span>&nbsp;escapeTags&nbsp;=&nbsp;[<br>&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">'style'</span>,<br>&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">'script'</span>,<br>&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">'template'</span>,<br>&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">'transition'</span>,<br>&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">'keepalive'</span>,<br>&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">'keep-alive'</span>,<br>&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">'component'</span>,<br>&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">'slot'</span>,<br>&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">'teleport'</span>,<br>&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">'transition-group'</span>,<br>&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">'transitiongroup'</span>,<br>&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">'suspense'</span>,<br>&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">"fragment"</span><br>];<br><br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">if</span>&nbsp;(fileType&nbsp;===&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">'vue'</span>)&nbsp;{<br>&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">//&nbsp;vue&nbsp;template&nbsp;å¤„ç†</span><br>&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">const</span>&nbsp;ast&nbsp;=&nbsp;parse(content,&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;comments:&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">true</span>,<br>&nbsp;&nbsp;});<br><br>&nbsp;&nbsp;transform(ast,&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;nodeTransforms:&nbsp;[<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-outline="">(<span data-darkreader-inline-outline="">(<span data-darkreader-inline-outline="">node:&nbsp;TemplateChildNode</span>)&nbsp;=&gt;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">//&nbsp;node.type&nbsp;===&nbsp;1&nbsp;è¯´æ˜æ˜¯å…ƒç´ (æ’é™¤æ‰&nbsp;textã€comment&nbsp;ç­‰)</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">if</span>&nbsp;(<span data-darkreader-inline-outline=""><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;!node.loc.source.includes(<span data-darkreader-inline-outline="">'data-insp-path'</span>)&nbsp;&amp;&amp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;node.<span data-darkreader-inline-outline="" data-darkreader-inline-color="">type</span>&nbsp;===&nbsp;1&nbsp;&amp;&amp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;escapeTags.indexOf(<span data-darkreader-inline-outline="">node.tag.toLowerCase(<span data-darkreader-inline-outline=""></span>)</span>)&nbsp;===&nbsp;-1<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>)&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">//&nbsp;å‘&nbsp;dom&nbsp;ä¸Šæ·»åŠ ä¸€ä¸ªå¸¦æœ‰&nbsp;filepath/row/column&nbsp;çš„å±æ€§</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">const</span>&nbsp;insertPosition&nbsp;=<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;node.loc.start.offset&nbsp;+&nbsp;node.tag.length&nbsp;+&nbsp;1;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">const</span>&nbsp;{&nbsp;line,&nbsp;column&nbsp;}&nbsp;=&nbsp;node.loc.start;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">//&nbsp;filePath&nbsp;ä¹Ÿæ˜¯&nbsp;vite&nbsp;transform&nbsp;å‡½æ•°æˆ–è€…&nbsp;webpack/rspack&nbsp;loader&nbsp;ä¼ è¿‡æ¥çš„</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">const</span>&nbsp;addition&nbsp;=&nbsp;`&nbsp;data-insp-path="${filePath}:${line}:${column}:${<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;node.tag<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}"${node.props.length&nbsp;?&nbsp;'&nbsp;'&nbsp;:&nbsp;''}`;<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s.prependLeft(<span data-darkreader-inline-outline="">insertPosition,&nbsp;addition</span>);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span>)&nbsp;<span data-darkreader-inline-outline="">as</span>&nbsp;<span data-darkreader-inline-outline="">NodeTransform</span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;],<br>&nbsp;&nbsp;});<br><br>&nbsp;&nbsp;<span data-darkreader-inline-outline="">return</span>&nbsp;<span data-darkreader-inline-outline="">s</span>.<span data-darkreader-inline-outline="">toString</span><span data-darkreader-inline-outline="">()</span>;<br>}<br></span></code>
```

#### ç¼–è¯‘ tsx ä»£ç 

å¯¹äº tsx è¯­æ³•çš„ç¼–è¯‘å’Œè§£æä½¿ç”¨Â `babel`Â å®ç°ï¼Œå¹¶ä¸”éœ€è¦å¼•å…¥ä¸€äº› babel ç›¸å…³çš„åŒ…ï¼Œå®Œæˆå¯¹äº tsã€vueJsx ç­‰åœºæ™¯çš„å…¼å®¹ï¼Œç®€åŒ–çš„ä»£ç å¦‚ä¸‹ï¼š

```
<span data-lazy-bgimg="https://mmbiz.qpic.cn/mmbiz_svg/mOW261WJzibtvLd4SDvxsMK5mAmMjt6dnZbODicB0ibkZPeibmB9BzlK3Fcgqa3WQFqPvoicCTtqHsogtz5PgmGRMQDLGbSzAw2Pj/640?wx_fmt=svg&amp;from=appmsg" data-fail="0" data-darkreader-inline-outline="" data-darkreader-inline-bgcolor=""></span><code data-darkreader-inline-outline="" data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor=""><span data-darkreader-inline-outline="" data-darkreader-inline-color="">import</span>&nbsp;MagicString&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">from</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">'magic-string'</span>;<br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">import</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">type</span>&nbsp;{&nbsp;TemplateChildNode,&nbsp;NodeTransform&nbsp;}&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">from</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">'@vue/compiler-dom'</span>;<br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">import</span>&nbsp;vueJsxPlugin&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">from</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">'@vue/babel-plugin-jsx'</span>;<br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">import</span>&nbsp;{&nbsp;parse&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">as</span>&nbsp;babelParse,&nbsp;traverse&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">as</span>&nbsp;babelTraverse&nbsp;}&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">from</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">'@babel/core'</span>;<br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">import</span>&nbsp;tsPlugin&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">from</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">'@babel/plugin-transform-typescript'</span>;<br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">import</span>&nbsp;importMetaPlugin&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">from</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">'@babel/plugin-syntax-import-meta'</span>;<br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">import</span>&nbsp;proposalDecorators&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">from</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">'@babel/plugin-proposal-decorators'</span>;<br><br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">//&nbsp;content&nbsp;æ˜¯ç”±&nbsp;vite&nbsp;transform&nbsp;å‡½æ•°æˆ–è€…&nbsp;webpack/rspack&nbsp;loader&nbsp;ä¼ è¿‡æ¥çš„æºä»£ç </span><br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">const</span>&nbsp;s&nbsp;=&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">new</span>&nbsp;MagicString(content);<br><br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">//&nbsp;vue/react&nbsp;éƒ¨åˆ†å†…ç½®å…ƒç´ æ·»åŠ &nbsp;attrs&nbsp;å¯èƒ½æŠ¥é”™ï¼Œä¸å¤„ç†</span><br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">const</span>&nbsp;escapeTags&nbsp;=&nbsp;[<br>&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">'style'</span>,<br>&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">'script'</span>,<br>&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">'template'</span>,<br>&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">'transition'</span>,<br>&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">'keepalive'</span>,<br>&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">'keep-alive'</span>,<br>&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">'component'</span>,<br>&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">'slot'</span>,<br>&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">'teleport'</span>,<br>&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">'transition-group'</span>,<br>&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">'transitiongroup'</span>,<br>&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">'suspense'</span>,<br>&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">"fragment"</span><br>];<br><br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">if</span>&nbsp;(fileType&nbsp;===&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">'jsx'</span>)&nbsp;{<br>&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">//&nbsp;jsx&nbsp;å¤„ç†</span><br>&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">const</span>&nbsp;ast&nbsp;=&nbsp;babelParse(content,&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;babelrc:&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">false</span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;comments:&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">true</span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;configFile:&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">false</span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;plugins:&nbsp;[<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;importMetaPlugin,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[vueJsxPlugin,&nbsp;{}],<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[tsPlugin,&nbsp;{&nbsp;isTSX:&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">true</span>,&nbsp;allowExtensions:&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">true</span>&nbsp;}],<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[proposalDecorators,&nbsp;{&nbsp;legacy:&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">true</span>&nbsp;}],<br>&nbsp;&nbsp;&nbsp;&nbsp;],<br>&nbsp;&nbsp;});<br><br>&nbsp;&nbsp;babelTraverse(ast,&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;enter({&nbsp;node&nbsp;}:&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">any</span>)&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">if</span>&nbsp;(<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;node.type&nbsp;===&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">'JSXElement'</span>&nbsp;&amp;&amp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;escapeTags.indexOf(<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(node?.openingElement?.name?.name&nbsp;||&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">''</span>).toLowerCase()<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)&nbsp;===&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">-1</span>&nbsp;&amp;&amp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;node?.openingElement?.name?.name<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">if</span>&nbsp;(<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;node.openingElement.attributes.some(<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-outline="">(<span data-darkreader-inline-outline="">attr:&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">any</span></span>)&nbsp;=&gt;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;attr.type&nbsp;!==&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">'JSXSpreadAttribute'</span>&nbsp;&amp;&amp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;attr.name.name&nbsp;===&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">'data-insp-path'</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">return</span>;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">//&nbsp;å‘&nbsp;dom&nbsp;ä¸Šæ·»åŠ ä¸€ä¸ªå¸¦æœ‰&nbsp;filepath/row/column&nbsp;çš„å±æ€§</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">const</span>&nbsp;insertPosition&nbsp;=<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;node.openingElement.end&nbsp;-<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(node.openingElement.selfClosing&nbsp;?&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">2</span>&nbsp;:&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">1</span>);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">const</span>&nbsp;{&nbsp;line,&nbsp;column&nbsp;}&nbsp;=&nbsp;node.loc.start;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">//&nbsp;filePath&nbsp;ä¹Ÿæ˜¯&nbsp;vite&nbsp;transform&nbsp;å‡½æ•°æˆ–è€…&nbsp;webpack/rspack&nbsp;loader&nbsp;ä¼ è¿‡æ¥çš„</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">const</span>&nbsp;addition&nbsp;=&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">`&nbsp;data-insp-path="<span data-darkreader-inline-outline="" data-darkreader-inline-color="">${filePath}</span>:<span data-darkreader-inline-outline="" data-darkreader-inline-color="">${line}</span>:<span data-darkreader-inline-outline="" data-darkreader-inline-color="">${column&nbsp;+&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">1</span>}</span>:<span data-darkreader-inline-outline="" data-darkreader-inline-color="">${<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;node.openingElement.name.name<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span>"<span data-darkreader-inline-outline="" data-darkreader-inline-color="">${node.openingElement.attributes.length&nbsp;?&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">'&nbsp;'</span>&nbsp;:&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">''</span>}</span>`</span>;<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s.prependLeft(insertPosition,&nbsp;addition);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;},<br>&nbsp;&nbsp;});<br>&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">return</span>&nbsp;s.toString();<br>}<br></code>
```

ä¸Šé¢Â `vue/jsx`Â ç¼–è¯‘å®Œæˆåï¼Œå…¶å®ç›¸å½“äºåœ¨æºä»£ç åŸºç¡€ä¸Šä¸ºæ¯ä¸ª dom æ³¨å…¥äº†ä¸€ä¸ªÂ `data-insp-path`Â å±æ€§ï¼Œæœ€ç»ˆå…ƒç´ åˆ°é¡µé¢ä¸Šï¼Œå¯¹åº”çš„ dom å°±ä¼šæ·»åŠ ä¸€ä¸ªè¿™æ ·çš„å±æ€§ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š

![Image](data:image/svg+xml,%3C%3Fxml version='1.0' encoding='UTF-8'%3F%3E%3Csvg width='1px' height='1px' viewBox='0 0 1 1' version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3E%3Ctitle%3E%3C/title%3E%3Cg stroke='none' stroke-width='1' fill='none' fill-rule='evenodd' fill-opacity='0'%3E%3Cg transform='translate(-249.000000, -126.000000)' fill='%23FFFFFF'%3E%3Crect x='249' y='126' width='1' height='1'%3E%3C/rect%3E%3C/g%3E%3C/g%3E%3C/svg%3E)

### è¿è¡Œæ—¶äº¤äº’æ³¨å…¥

`code-inspector-plugin`Â æ’ä»¶çš„äº¤äº’åŠŸèƒ½ä¸»è¦åŒ…å«ç›‘å¬ä¸¤éƒ¨åˆ†ï¼š

-   ç›‘å¬ç»„åˆé”®æŒ‰ä½æ—¶ï¼Œé¼ æ ‡åœ¨ dom ä¸Šç§»åŠ¨æ—¶ä¼šå‡ºç° DOM é®ç½©å±‚ä¿¡æ¯
    
-   ç‚¹å‡»é®ç½©å±‚ä¼šè·å– DOMÂ `attribute`Â ä¸Šçš„æºä»£ç ä¿¡æ¯ï¼Œå‘åå°å‘é€ä¸€ä¸ªè¯·æ±‚
    

è¿™éƒ¨åˆ†åŠŸèƒ½çš„å®ç°ä¸Šéš¾åº¦ä¸å¤§ï¼Œå°±æ˜¯åŸºç¡€çš„Â `html+js+css`ï¼Œä¸ºäº†ä¿è¯ js é€»è¾‘å’Œ css æ ·å¼ä¸ä¼šå½±å“åˆ°å®¿ä¸»é¡µé¢ï¼Œæˆ‘é‡‡ç”¨äº† web component ç»„ä»¶çš„æ–¹å¼æ¥å°è£…äº†è¿™éƒ¨åˆ†é€»è¾‘(åŸºäº lit å®ç°çš„ web component)ã€‚å…·ä½“çš„å®ç°ç»†èŠ‚å°†ä¸å¤šè®²äº†ï¼Œæºç ä½äºÂ packages/core/src/client/index.ts<sup data-darkreader-inline-outline="" data-darkreader-inline-color="">[7]</sup>Â æ–‡ä»¶ä¸­ã€‚

ä¸ºäº†ç®€åŒ–ç”¨æˆ·çš„ä½¿ç”¨ï¼Œä¸éœ€è¦ç”¨æˆ·æ‰‹åŠ¨å‘é¡µé¢ä¸­æ·»åŠ äº¤äº’é€»è¾‘çš„ç»„ä»¶ï¼Œæˆ‘é€šè¿‡Â `webpack/vite/rspack`Â æ’ä»¶ï¼Œåœ¨ development ç¯å¢ƒä¸‹å°† web component ç»„ä»¶æ³¨å…¥åˆ°é¡µé¢ä¸­ã€‚

### æœ¬åœ°çš„ Node Server æœåŠ¡

Node Server åŒæ ·æ˜¯æ’ä»¶åœ¨Â `webpack/vite/rspack`Â å¼€å§‹ç¼–è¯‘çš„æ—¶å€™å¯åŠ¨çš„ï¼Œç”¨äºç›‘å¬ç”¨æˆ·å‘é€ http è¯·æ±‚ã€‚

æˆ‘ä»¬è®¾ç½®äº†ä¸€ä¸ªé»˜è®¤çš„ç«¯å£Â `6666`ï¼Œä¸ºäº†é˜²æ­¢ç«¯å£å†²çªï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨Â `portFinder`Â ç»§ç»­å‘ä¸‹å¯»æ‰¾ä¸€ä¸ªå¯ç”¨çš„æ¥å£å»å¯åŠ¨æœåŠ¡ï¼š

```
<span data-lazy-bgimg="https://mmbiz.qpic.cn/mmbiz_svg/mOW261WJzibtvLd4SDvxsMK5mAmMjt6dnZbODicB0ibkZPeibmB9BzlK3Fcgqa3WQFqPvoicCTtqHsogtz5PgmGRMQDLGbSzAw2Pj/640?wx_fmt=svg&amp;from=appmsg" data-fail="0" data-darkreader-inline-outline="" data-darkreader-inline-bgcolor=""></span><code data-darkreader-inline-outline="" data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor=""><span data-darkreader-inline-outline="" data-darkreader-inline-color="">import</span>&nbsp;http&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">from</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">'http'</span>;<br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">import</span>&nbsp;portFinder&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">from</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">'portfinder'</span>;<br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">import</span>&nbsp;path&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">from</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">'path'</span>;<br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">import</span>&nbsp;launchEditor&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">from</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">'./launch-editor'</span>;<br><br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">const</span>&nbsp;DefaultPort&nbsp;=&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">6666</span>;<br><br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">export</span>&nbsp;<span data-darkreader-inline-outline=""><span data-darkreader-inline-outline="" data-darkreader-inline-color="">function</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">startServer</span>(<span data-darkreader-inline-outline="">callback:&nbsp;(port:&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">number</span>)&nbsp;=&gt;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">any</span>,&nbsp;editor?:&nbsp;Editor</span>)&nbsp;</span>{<br>&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">const</span>&nbsp;server&nbsp;=&nbsp;http.createServer(<span data-darkreader-inline-outline="">(<span data-darkreader-inline-outline="">req:&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">any</span>,&nbsp;res:&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">any</span></span>)&nbsp;=&gt;</span>&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">//&nbsp;æ”¶åˆ°è¯·æ±‚å”¤é†’vscode</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">const</span>&nbsp;params&nbsp;=&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">new</span>&nbsp;URLSearchParams(req.url.slice(<span data-darkreader-inline-outline="" data-darkreader-inline-color="">1</span>));<br>&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">const</span>&nbsp;file&nbsp;=&nbsp;params.get(<span data-darkreader-inline-outline="" data-darkreader-inline-color="">'file'</span>)&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">as</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">string</span>;<br>&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">const</span>&nbsp;line&nbsp;=&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">Number</span>(params.get(<span data-darkreader-inline-outline="" data-darkreader-inline-color="">'line'</span>));<br>&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">const</span>&nbsp;column&nbsp;=&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">Number</span>(params.get(<span data-darkreader-inline-outline="" data-darkreader-inline-color="">'column'</span>));<br>&nbsp;&nbsp;&nbsp;&nbsp;res.writeHead(<span data-darkreader-inline-outline="" data-darkreader-inline-color="">200</span>,&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">'Access-Control-Allow-Origin'</span>:&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">'*'</span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">'Access-Control-Allow-Methods'</span>:&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">'*'</span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">'Access-Control-Allow-Headers'</span>:&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">'*'</span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">'Access-Control-Allow-Private-Network'</span>:&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">'true'</span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;});<br>&nbsp;&nbsp;&nbsp;&nbsp;res.end(<span data-darkreader-inline-outline="" data-darkreader-inline-color="">'ok'</span>);<br>&nbsp;&nbsp;&nbsp;&nbsp;launchEditor(file,&nbsp;line,&nbsp;column,&nbsp;editor);<br>&nbsp;&nbsp;});<br><br>&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">//&nbsp;å¯»æ‰¾å¯ç”¨æ¥å£</span><br>&nbsp;&nbsp;portFinder.getPort({&nbsp;port:&nbsp;DefaultPort&nbsp;},&nbsp;<span data-darkreader-inline-outline="">(<span data-darkreader-inline-outline="">err:&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">Error</span>,&nbsp;port:&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">number</span></span>)&nbsp;=&gt;</span>&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">if</span>&nbsp;(err)&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">throw</span>&nbsp;err;<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;server.listen(port,&nbsp;<span data-darkreader-inline-outline=""><span data-darkreader-inline-outline="">()</span>&nbsp;=&gt;</span>&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;callback(port);<br>&nbsp;&nbsp;&nbsp;&nbsp;});<br>&nbsp;&nbsp;});<br>}<br></code>
```

### è¯†åˆ«å¹¶æ‰“å¼€ IDE

Node Server æ¥æ”¶åˆ°äº†è¯·æ±‚åï¼Œéœ€è¦æ‰“å¼€ç”¨æˆ·çš„ IDE å¹¶å®šä½åˆ°æºä»£ç ï¼Œè¿™ä¸€æ­¥æ˜¯å¦‚ä½•å®ç°çš„å‘¢ï¼Ÿ

å¸‚é¢ä¸Šå¤§å¤šæ•°çš„ IDEï¼Œå¤šæ”¯æŒé€šè¿‡Â `{IDEè·¯å¾„} -g {path}:{line}:{column}`Â çš„ç»ˆç«¯å‘½ä»¤ï¼Œæ‰“å¼€ IDE å¹¶å°†é¼ æ ‡å…‰æ ‡å®šä½åˆ°æŒ‡å®šçš„ä½ç½®ï¼Œéƒ¨åˆ† IDE è¿˜æ”¯æŒåœ¨å…¨å±€å®‰è£…å‘½ä»¤è¡Œå·¥å…·ç®€åŒ–ä½¿ç”¨ã€‚ä»¥ vscode ä¸ºä¾‹ï¼Œæœ‰ä¸¤ç§æ–¹å¼ï¼š

1.  åœ¨ç»ˆç«¯é€šè¿‡ vscode åº”ç”¨è·¯å¾„ç›´æ¥æ‰“å¼€åº”ç”¨
    
2.  é€šè¿‡å®‰è£… vscode æä¾›çš„å‘½ä»¤è¡Œå·¥å…·ï¼Œåœ¨ç»ˆç«¯é€šè¿‡Â `code`Â æŒ‡ä»¤å”¤é†’ï¼Œlaunching-from-the-command-line<sup data-darkreader-inline-outline="" data-darkreader-inline-color="">[8]</sup>
    

è¿™é‡Œæˆ‘ä»¬é‡‡ç”¨äº†ç¬¬äºŒç§æ–¹å¼ï¼Œé€šè¿‡ node çš„Â `spwan`Â æˆ–è€…Â `exec`Â å¯åŠ¨ä¸€ä¸ªå­è¿›ç¨‹ï¼Œæ‰§è¡ŒÂ `code -g æ–‡ä»¶è·¯å¾„:è¡Œ:åˆ—`Â å°±èƒ½æ‰“å¼€ vscode å¹¶å®šä½åˆ°å¯¹åº”çš„æ–‡ä»¶è·¯å¾„ã€è¡Œã€åˆ—ä½ç½®ï¼Œç®€åŒ–ä»£ç å¦‚ä¸‹ï¼š

```
<span data-lazy-bgimg="https://mmbiz.qpic.cn/mmbiz_svg/mOW261WJzibtvLd4SDvxsMK5mAmMjt6dnZbODicB0ibkZPeibmB9BzlK3Fcgqa3WQFqPvoicCTtqHsogtz5PgmGRMQDLGbSzAw2Pj/640?wx_fmt=svg&amp;from=appmsg" data-fail="0" data-darkreader-inline-outline="" data-darkreader-inline-bgcolor=""></span><code data-darkreader-inline-outline="" data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor=""><span data-darkreader-inline-outline=""><span data-darkreader-inline-outline="" data-darkreader-inline-color="">function</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">launchEditor</span>(<span data-darkreader-inline-outline=""><br>&nbsp;&nbsp;fileName:&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">string</span>,<br>&nbsp;&nbsp;lineNumber:&nbsp;unknown,<br>&nbsp;&nbsp;colNumber:&nbsp;unknown,<br>&nbsp;&nbsp;_editor?:&nbsp;Editor<br></span>)&nbsp;</span>{<br>&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">//&nbsp;others&nbsp;code....</span><br><br>&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">let</span>&nbsp;[editor,&nbsp;...args]&nbsp;=&nbsp;guessEditor(_editor);<br><br>&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">//&nbsp;others&nbsp;code....</span><br><br>&nbsp;&nbsp;_childProcess&nbsp;=&nbsp;child_process.spawn(editor,&nbsp;args,&nbsp;{&nbsp;stdio:&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">'inherit'</span>&nbsp;});<br>}<br></code>
```

é™¤äº†å¦‚ä½•æ‰“å¼€ IDE çš„é—®é¢˜ï¼Œå¦ä¸€ä¸ªè¦è§£å†³çš„é—®é¢˜æ˜¯ï¼Œå¦‚æœç”¨æˆ·è®¾å¤‡ä¸Šå®‰è£…äº†å¤šç§ IDEï¼Œæˆ‘ä»¬è¦æ‰“å¼€å“ªä¸ª IDEï¼Ÿ

è¿™ä¸ªåŠŸèƒ½æˆ‘ä»¬æ˜¯åŸºäºÂ react-devtools<sup data-darkreader-inline-outline="" data-darkreader-inline-color="">[9]</sup>Â çš„æºç å®ç°äº†ï¼Œå®ƒä¼šå»åŒ¹é…ç”¨æˆ·å½“å‰è®¾å¤‡ä¸Šæ­£åœ¨è¿è¡Œçš„è¿›ç¨‹ï¼Œåœ¨ IDE åˆ—è¡¨ä¸­åŒ¹é…æ‰“å¼€ã€‚åœ¨æ­¤åŸºç¡€ä¸Šæˆ‘ä»¬ä¼˜åŒ–å¹¶ä¸°å¯Œäº†è¿™éƒ¨åˆ†çš„åŠŸèƒ½ï¼Œæ”¯æŒäº†ä»¥ä¸‹ç‰¹æ€§ï¼š

-   ä¼˜åŒ–äº† IDE çš„åŒ¹é…é¡ºåºï¼šå› ä¸ºå¯¹äº web é¡¹ç›®ï¼Œå¤§å¤šæ•°å¼€å‘è€…ä½¿ç”¨çš„ IDE æ˜¯ vscode æˆ–è€… webstormï¼Œæ‰€ä»¥æˆ‘ä»¬ä¼šä¼˜å…ˆåŒ¹é…è¿™ä¸¤ä¸ª IDE
    
-   æ”¯æŒç”¨æˆ·æŒ‡å®š IDEï¼šæ”¯æŒç”¨æˆ·é€šè¿‡åœ¨Â `.env.local`Â æ–‡ä»¶ä¸­æŒ‡å®šå£°æ˜è¦æ‰“å¼€çš„ IDEï¼Œé™¤äº†å†…ç½®æ”¯æŒè¯†åˆ«çš„ IDE å¤–ï¼Œç”¨æˆ·ä¹Ÿå¯ä»¥ç”¨ IDE å¯æ‰§è¡Œè·¯å¾„æ–¹å¼æŒ‡å®šï¼ˆæ„å‘³ç€æ”¯æŒæ‰€æœ‰ IDEï¼‰
    

**ä»£ç æ¶æ„è®¾è®¡**  

ä¸Šé¢çš„å®ç°åŸç†ä¸­ï¼Œæˆ‘ä»¬è®²è¿°äº†Â `code-inspector-plugin`Â æ’ä»¶çš„æ ¸å¿ƒå†…å®¹ï¼Œé™¤äº†è¿™éƒ¨åˆ†ä¹‹å¤–ï¼Œè¿˜æƒ³åˆ†äº«ä¸‹æˆ‘ä»¬åœ¨ä»£ç å¯ç»´æŠ¤æ€§å’Œç”¨æˆ·ä½¿ç”¨ä½“éªŒæ–¹é¢æ‰€åšçš„åŠªåŠ›ã€‚

### **åˆ†åŒ…æå‡å¯ç»´æŠ¤æ€§**

ä¸Šè¿°æ ¸å¿ƒå†…å®¹çš„å®ç°ï¼Œç»å¤§éƒ¨åˆ†æ˜¯ä¸Â `vite/webpack/rspack`Â ç­‰æ‰“åŒ…å™¨æ— å…³çš„ï¼Œæ‰“åŒ…å™¨æ’ä»¶åªæ˜¯ä½œä¸ºä»£ç ç¼–è¯‘å’Œäº¤äº’ä»£ç æ³¨å…¥çš„å…¥å£æ‰¿è½½ã€‚æ‰€ä»¥æˆ‘ä»¬é‡‡ç”¨ monorepo æ¶æ„ï¼Œå°†æ ¸å¿ƒä»£ç éƒ½æå–åˆ°äº†Â `core`Â ä¸­ï¼Œmonorepo çš„åŒ…å¦‚ä¸‹ï¼š

```
ğŸ“¦packages<br> â”£ ğŸ“‚code-inspector-plugin --------------------------   å…¥å£åŒ…<br> â”£ ğŸ“‚core ----------------------------------------  æ ¸å¿ƒä»£ç å¤„ç†<br> â”£ ğŸ“‚vite-plugin ---------------------------------  vite æ’ä»¶<br> â”— ğŸ“‚webpack-plugin ---------------------------   webpack æ’ä»¶<br>
```

å…¶ä¸­ï¼Œ`vite-plugin`Â å’ŒÂ `webpack-plugin`Â åˆ†åˆ«ä½œä¸º vite å’Œ webpack çš„å…¥å£ã€‚ï¼ˆrspack ç”±äºåœ¨æ’ä»¶ç³»ç»Ÿçš„è®¾è®¡ä¸Šå®Œå…¨æ”¯æŒäº† webpackï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥ä½¿ç”¨ webpack-plugin ä½œä¸º rspack çš„å…¥å£ï¼Œå¦‚æœåé¢äºŒè€…å‡ºç°å·®å¼‚ï¼Œä¼šè€ƒè™‘å†åˆ†ä¸€ä¸ªÂ `rspack-plugin`Â çš„åŒ…ï¼‰ã€‚

åŒæ—¶ä¸ºäº†é™ä½ç”¨æˆ·åœ¨å¤šç§æ‰“åŒ…å™¨ä¸­çš„æ¥å…¥å¿ƒæ™ºï¼Œæˆ‘ä»¬ä½¿ç”¨Â `code-inspector-plugin`Â å°†Â `vite/webpack/rspack`Â ç­‰ä¸åŒé¡¹ç›®çš„æ’ä»¶è¿›è¡Œäº†æ•´åˆä½œä¸ºå”¯ä¸€å…¥å£ï¼Œç”¨æˆ·åªéœ€è¦é€šè¿‡Â `bundler`Â å‚æ•°æŒ‡å®šé¡¹ç›®çš„æ‰“åŒ…å™¨å³å¯ï¼Œå…¶ä»–é…ç½®å®Œå…¨ä¸€è‡´ã€‚

**é™ä½ç”¨æˆ·æ¥å…¥æœ¬**

åœ¨é™ä½ç”¨æˆ·æˆæœ¬æ–¹é¢ï¼Œæˆ‘ä»¬ä¸»è¦åšäº†ä¸¤ä»¶äº‹æƒ…ï¼š

1.  ä¸ºäº†è®©ç”¨æˆ·ä¸éœ€è¦ä¿®æ”¹ä»»ä½•çš„æºä»£ç ï¼Œæˆ‘ä»¬å¯¹äºé¡µé¢äº¤äº’çš„ä»£ç ï¼Œç›´æ¥é€šè¿‡æ’ä»¶æ³¨å…¥ï¼Œä¸éœ€è¦ç”¨æˆ·æ‰‹åŠ¨å¼•å…¥ä»»ä½•çš„ç»„ä»¶ï¼Œå¯¹ç”¨æˆ·ä»£ç æ— ä»»ä½•ä¾µå…¥ã€‚
    
2.  å¯¹äº webpack å’Œ rspack çš„é¡¹ç›®ï¼Œåƒå¯åŠ¨ node æœåŠ¡è¿™ç§é€»è¾‘æ˜¯åœ¨æ’ä»¶ä¸­å®ç°çš„ï¼Œè€Œå‚ä¸æºä»£ç çš„ç¼–è¯‘éœ€è¦åœ¨Â `loader`Â ä¸­å®ç°ã€‚è™½ç„¶è®©ç”¨æˆ·åŒæ—¶æ¥å…¥ä¸€ä¸ªÂ `plugin`Â å’Œä¸€ä¸ªÂ `loader`Â æˆæœ¬ä¹Ÿæ²¡æœ‰é‚£ä¹ˆé«˜ï¼Œä½†æ˜¯ä¸ºäº†æœ€å¤§ç¨‹åº¦é™ä½ç”¨æˆ·æ¥å…¥æˆæœ¬ï¼Œæˆ‘ä»¬æ’ä»¶ä¼šåœ¨ webpack/rspack ç¼–è¯‘å‰ï¼Œè‡ªåŠ¨å°†Â `loader`Â æ·»åŠ åˆ°Â `module.rules`Â ä¸­ï¼Œç”¨æˆ·åªéœ€è¦æ¥å…¥ä¸€ä¸ªÂ `plugin`Â å³å¯ï¼Œå…å»äº†Â `loader`Â çš„æ¥å…¥æˆæœ¬ã€‚
    

åŸæ–‡åœ°å€ï¼šhttps://juejin.cn/post/7326002010084311079

ä½œè€…ï¼šå¿«æ‰‹åŸºç¡€å¹³å°å‰ç«¯ oç¿”å“¥o

## â¤ï¸ çœ‹å®Œä¸¤ä»¶äº‹

å¦‚æœä½ è§‰å¾—è¿™ç¯‡å†…å®¹å¯¹ä½ æŒºæœ‰å¯å‘ï¼Œæˆ‘æƒ³é‚€è¯·ä½ å¸®æˆ‘ä¸¤ä¸ªå°å¿™ï¼š

1.  ç‚¹ä¸ªã€Œ**åœ¨çœ‹**ã€ï¼Œè®©æ›´å¤šçš„äººä¹Ÿèƒ½çœ‹åˆ°è¿™ç¯‡å†…å®¹ï¼ˆå–œæ¬¢ä¸ç‚¹åœ¨çœ‹ï¼Œéƒ½æ˜¯è€æµæ°“ -\_-ï¼‰
    
2.  å…³æ³¨å…¬ä¼—å·ã€Œ**Vueç¤¾åŒº**ã€ï¼Œæ¯å‘¨é‡ç‚¹æ”»å…‹ä¸€ä¸ªå‰ç«¯é¢è¯•é‡éš¾ç‚¹ï¼Œ
    
    å…¬ä¼—å·åå°å›å¤ã€Œ**ç”µå­ä¹¦**ã€å³å¯å…è´¹è·å– 27æœ¬ ç²¾é€‰çš„å‰ç«¯ç”µå­ä¹¦ï¼
    

![Image](data:image/svg+xml,%3C%3Fxml version='1.0' encoding='UTF-8'%3F%3E%3Csvg width='1px' height='1px' viewBox='0 0 1 1' version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3E%3Ctitle%3E%3C/title%3E%3Cg stroke='none' stroke-width='1' fill='none' fill-rule='evenodd' fill-opacity='0'%3E%3Cg transform='translate(-249.000000, -126.000000)' fill='%23FFFFFF'%3E%3Crect x='249' y='126' width='1' height='1'%3E%3C/rect%3E%3C/g%3E%3C/g%3E%3C/svg%3E)

ç‚¹ä¸ªåœ¨çœ‹æ”¯æŒæˆ‘å§ï¼Œè½¬å‘å°±æ›´å¥½äº†