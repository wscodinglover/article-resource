> å¯¼è¯»ï¼šç›®å‰ç½‘ç»œä¸Šå¯ä»¥éšæ„æŸ¥åˆ°å„ç§VSCodeæ’ä»¶çš„ç›¸å…³æ–‡ç« ï¼Œä½†å¾€å¾€æœ‰ä¸€äº›ç‰¹æ®Šçš„åŠŸèƒ½éœ€æ±‚æ‰¾ä¸åˆ°åˆé€‚çš„æ’ä»¶ã€‚é‚£ä¹ˆä¸å¦‚è‡ªå·±å¼€å‘ä¸€ä¸ªæ’ä»¶å§ï¼Œæ‰“é€ ä¸€æŠŠç§°æ‰‹çš„å…µå™¨ï¼

VSCode (å…¨ç§°ï¼šVistual Studio Code) ç”± Microsoft å‡ºå“ï¼Œå…¶å…·å¤‡å¯åŠ¨å¿«é€Ÿã€ç¨³å®šæ€§å¥½ã€å ç”¨å†…å­˜è¾ƒå°ã€æ’ä»¶è¶Šæ¥è¶Šä¸°å¯Œã€ç¤¾åŒºæ´»è·ƒç­‰ç‰¹ç‚¹ï¼Œç›®å‰æ˜¯ä¸ªäººå’Œå›¢é˜Ÿä¸­å¾ˆå¤šå°ä¼™ä¼´çš„ä¸»åŠ›ä»£ç ç¼–è¾‘å™¨ã€‚

ä¸‹é¢ç›´å¥”ä¸»é¢˜ï¼Œæœ¬æ–‡ä½ å°†äº†è§£ç®€å•çš„ VSCode çš„æ’ä»¶å¼€å‘å…¥é—¨ï¼Œæ„Ÿå…´è¶£çš„åŒå­¦å¯ä»¥ç»§ç»­é˜…è¯»ã€‚

> ä»¥ä¸‹æ–‡ä¸­æåˆ°çš„â€œæ’ä»¶â€å‡ä¸º Vistual Studio Code çš„æ’ä»¶ï¼ŒVistual Studio Code ä¹Ÿç®€ç§° VSCode

## ç¯å¢ƒå‡†å¤‡

-   nodejs \[1\] å»ºè®®ä½¿ç”¨ LTS ç‰ˆæœ¬ï¼Œæˆªæ­¢å‘æ–‡ v8.11.3
-   npm \[2\] å»ºè®®æœ€æ–°ç‰ˆæœ¬ï¼Œæˆªæ­¢å‘æ–‡ v6.1.0
-   yeoman \[3\] `npm install -g yo`
-   generator-code \[4\]`npm install -g generator-code`

åšå¥½ä¸Šé¢çš„ç¯å¢ƒå‡†å¤‡ï¼Œæ­£å¼è¿›å…¥å¼€å‘ï¼Œä¸‹é¢æˆ‘ä¼šä»¥è‡ªå·±åˆšåšå¥½çš„ä¸€ä¸ªæŸ¥è¯¢åŒ—äº¬åœ°åŒºç©ºæ°”è´¨é‡ä¸ºä¾‹å­ï¼Œç»§ç»­ä»‹ç»ï¼ˆå®‰å¿ƒã—ã¦ãã ã•ã„ï¼Œä»£ç å¾ˆå°‘ï¼Œå¾ˆå¥½å…¥é—¨ï¼‰ã€‚

## æ•°æ®å‡†å¤‡

ä¸‹é¢è¡¥å……ä¸€ä¸‹æˆ‘ä»¬çš„ä¾‹å­çš„åŠŸèƒ½ï¼Œé¦–å…ˆæ˜ç¡®æˆ‘ä»¬è¦è·å–åŸå¸‚çš„ AQIï¼ˆç©ºæ°”è´¨é‡ï¼‰ä¿¡æ¯ï¼Œç½‘ç»œä¸Šå¯ä»¥æœç´¢åˆ°ç›´æ¥è°ƒç”¨ API æˆ–è€… SDKï¼Œç¬”è€…ç›®å‰ä½¿ç”¨çš„äº¬ä¸œäº‘çš„ä¸€ä¸ªäº§å“äº¬ä¸œä¸‡è±¡ä¸­çš„ä¸€ä¸ªå¤©æ°”å…è´¹ API\[10\]ï¼Œ æ³¨å†Œå®åè®¤è¯åå¯ä»¥è·å¾—ä¸€ä¸ªè°ƒç”¨åº”ç”¨çš„ KEYï¼Œä¾¿å¯ä»¥è·å–å¤©æ°”æ•°æ®äº†ã€‚æ›´å¤šå…¶ä»–æ–¹é¢çš„ API è¯»è€…å¯ä»¥è‡ªè¡Œæ¢ç´¢ã€‚

ç¬”è€…ä½¿ç”¨çš„ API æ˜¯ [wx.jdcloud.com/market/dataâ€¦](https://link.juejin.cn/?target=https%3A%2F%2Fwx.jdcloud.com%2Fmarket%2Fdatas%2F26%2F10610 "https://wx.jdcloud.com/market/datas/26/10610") å‚æ•° city æ”¯æŒ ä¸­è‹±æ–‡åç§°ã€ID å’Œ IP é™åˆ¶ 5000æ¬¡/å¤©ã€‚

## é”¦å›Š

å·²æœ‰æ’ä»¶æ‰€åœ¨ç›®å½•å¦‚ä¸‹ï¼š

| os | path |
| --- | --- |
| windows | %USERPROFILE%\\.vscode\\extensions |
| macOS | ~/.vscode/extensions |
| Linux | ~/.vscode/extensions |

åœ¨è¿™ä¸ªç›®å½•ä¸‹æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å·²ç»å®‰è£…çš„æ‰€æœ‰æ’ä»¶çš„ä»£ç ï¼Œå³ä½¿æ’ä»¶æ˜¯ä½¿ç”¨ typescript ç¼–å†™ï¼Œ out æ–‡ä»¶å¤¹ä¹Ÿå¯ä»¥çœ‹åˆ°ç¼–è¯‘åçš„ javascript ä»£ç ï¼Œæ„Ÿå…´è¶£çš„åŒå­¦å¯ä»¥ç›´æ¥çœ‹ä¸€çœ‹è‡ªå·±å¹³æ—¶æœ€å¸¸ç”¨çš„æ’ä»¶æ˜¯å¦‚ä½•å®ç°çš„ã€‚

## å¼€å‘

æ‰§è¡Œä¸‹é¢ä»£ç ï¼š

```armasm
yo code Â 
```

æ‰§è¡Œåä¼šæç¤ºå‡ ä¸ªé—®é¢˜ï¼Œç¬¬ä¸€ä¸ªé—®é¢˜æˆ‘ä»¬é€‰æ‹© `New Extension (JavaScript)`ï¼Œå…¶ä»–æ­£å¸¸å¡«å†™å³å¯ã€‚ï¼ˆå¯ä»¥ä½¿ç”¨ yo code æ¥åˆ›å»ºæ’ä»¶ã€ä¸»é¢˜ã€ä»£ç ç‰‡æ®µã€è¯­è¨€æ”¯æŒã€é”®ç›˜æ˜ å°„ã€æ’ä»¶åŒ…ï¼Œæœ¬æ–‡æˆ‘ä»¬åªè®¨è®ºæ’ä»¶ï¼Œå…¶ä»–æš‚ä¸”æ”¾åœ¨ä¸€è¾¹ã€‚ï¼‰

![](https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2018/7/19/164b1bafea675a1e~tplv-t2oaga2asx-jj-mark:3024:0:0:0:q75.png)

å¡«å†™å®Œæˆåï¼Œä¼šè‡ªåŠ¨åˆ›å»ºæ–‡ä»¶å¤¹å¹¶å¸®åŠ©åˆå§‹åŒ–å®Œæˆæ–‡ä»¶ï¼Œæˆ‘ä»¬å…ˆæ¥çœ‹ä¸‹ç›®å½•ç»“æ„ã€‚

```clean
. â”œâ”€â”€ CHANGELOG.md ## ä¿®æ”¹è®°å½• â”œâ”€â”€ README.md ## æ’ä»¶è¯´æ˜ README â”œâ”€â”€ extension.js ## å…¥å£ â”œâ”€â”€ jsconfig.json ## JavaScript é…ç½® â”œâ”€â”€ node_modules ## ä¾èµ– â”œâ”€â”€ package-lock.json â”œâ”€â”€ package.json â”œâ”€â”€ test â””â”€â”€ vsc-extension-quickstart.md Â 
```

ç†Ÿæ‚‰äº†é¡¹ç›®æ–‡ä»¶ç»“æ„ä¹‹åï¼Œç›´æ¥æŸ¥çœ‹ `vsc-extension-quickstart.md` è¿™ä¸ªæ–‡æ¡£ï¼Œæ–‡ä¸­æåˆ° `package.json` å£°æ˜å½“å‰æ’ä»¶å’Œå‘½ä»¤çš„é…ç½®æ–‡ä»¶ï¼Œç”¨æ¥æ³¨å†Œå‘½ä»¤ç­‰é…ç½®ï¼›`extension.js` æ˜¯ä¸»å…¥å£æ–‡ä»¶ï¼Œæ’ä»¶çš„å…·ä½“å®ç°ä»£ç å¯ä»¥æ”¾åœ¨è¿™é‡Œï¼›

ç®€å•äº†è§£ä¸€ä¸‹ä¸¤ä¸ªé‡è¦æ–‡ä»¶ï¼š

```awk
{ "name": "city-aqi", // æ’ä»¶åç§° "displayName": "city-aqi", // æ’ä»¶æ˜¾ç¤ºåç§° "description": "Air Quaility Index of City", // æ’ä»¶æè¿° "version": "0.0.1", "publisher": "beanleecode", // æ’ä»¶å‘å¸ƒè€… ... "activationEvents": [ // æ´»åŠ¨äº‹ä»¶åˆ—è¡¨ "onCommand:extension.sayHello" ], "main": "./extension", // å…¥å£æ–‡ä»¶ "contributes": { "commands": [ // å¯¹åº”å‘½ä»¤åˆ—è¡¨ { "command": "extension.sayHello", "title": "Hello World" } ] }, ... } Â 
```

```javascript
<br />const vscode = require('vscode'); Â  function activate(context) { Â  // è¿™é‡Œçš„ä»£ç å°†åªä¼šåœ¨æ’ä»¶æ¿€æ´»æ—¶æ‰§è¡Œä¸€æ¬¡ console.log('Congratulations, your extension "city-aqi" is now active!'); Â  // å®šä¹‰åœ¨ package.json ä¸­çš„å‘½ä»¤åœ¨è¿™é‡Œå®šä¹‰ // æä¾› registerCommand æ¥æ³¨å†Œå®ç°ä»£ç  // commandId å‚æ•°å¿…é¡»ä¸ package.json åŒ¹é… let disposable = vscode.commands.registerCommand('extension.sayHello', function () { // è¿™é‡Œçš„ä»£ç æ¯æ¬¡æ‰§è¡Œ è¿™ä¸ªå‘½ä»¤ çš„æ—¶å€™éƒ½ä¼šè¢«æ‰§è¡Œ Â  // æ˜¾ç¤ºä¿¡æ¯æ¡† vscode.window.showInformationMessage('Hello World!'); }); Â  context.subscriptions.push(disposable); } exports.activate = activate; Â  // æ’ä»¶è¢«åœç”¨çš„æ—¶å€™è¢«è°ƒç”¨ function deactivate() { } exports.deactivate = deactivate; Â 
```

ä¸‹é¢æˆ‘ä»¬ç›´æ¥ç”¨ VSCode æ‰“å¼€è¿™ä¸ªé¡¹ç›®çš„æ ¹ç›®å½•ï¼Œæ‰“å¼€ `extension.js` æŒ‰ä¸‹é”®ç›˜ `F5` æˆ–å¯åŠ¨è°ƒè¯•ï¼Œæ¥ä¸‹æ¥å°±å¯ä»¥çœ‹åˆ°ï¼Œå·²ç»å¯åŠ¨ä¸€ä¸ªæ–°çš„çª—å£ï¼Œæˆ‘ä»¬æŒ‰ä¸‹ `command + shift + p` æˆ– `command + p å†è¾“å…¥ >` å³å¯è°ƒç”¨æ’ä»¶ï¼Œåœ¨ package.json ä¸­å·²ç»å®šä¹‰è¿‡ commands æˆ‘ä»¬ç›´æ¥è¾“å…¥ `Hello World` ç›´æ¥å¯åŠ¨æ’ä»¶ï¼Œæ­¤æ—¶å¯ä»¥çœ‹åˆ° Hello World çš„é€šçŸ¥æ¡†ï¼Œå°±å¯ä»¥è°ƒè¯•ä»£ç äº†ã€‚

OKï¼Œä¸‹é¢æˆ‘ä»¬æ¥è¿›ä¸€æ­¥å®ç°æˆ‘ä»¬çš„åŠŸèƒ½ï¼Œè°ƒå–å¤©æ°” API æ•°æ®å¹¶å±•ç¤ºã€‚

```reasonml
const vscode = require('vscode'); const axios = require('axios'); Â  function activate(context) { let cityAqi = vscode.commands.registerCommand('extension.sayCityAqi', function () { Â  const options = { ignoreFocusOut: true, password: false, prompt: "Please type your city (eg.beijing or åŒ—äº¬)" }; Â  vscode.window.showInputBox(options).then((value) =&gt; { if (value === undefined || value.trim() === '') { vscode.window.showInformationMessage('Please type your city.'); } else { const cityName = value.trim(); // appkey=xxxxxxxx æ›¿æ¢æˆäº‹å…ˆç”³è¯·å¥½çš„ key axios.get(`https://way.jd.com/he/freeweather?city=${cityName}&amp;appkey=xxxxxxxx`) .then((rep) =&gt; { if(rep.data.code !== '10000') { vscode.window.showInformationMessage('Sorry, Please try again.'); return; } const weatherData = rep.data.result.HeWeather5[0] if(weatherData.status !== 'ok') { vscode.window.showInformationMessage(`Sorry, ${weatherData.status}`); return; } vscode.window.showInformationMessage(`${weatherData.basic.city} 's AQI =&gt; PM25: ${weatherData.aqi.city.pm25}, PM10: ${weatherData.aqi.city.pm10} ${weatherData.aqi.city.qlty}`); }); } }); }); Â  context.subscriptions.push(cityAqi); } exports.activate = activate; Â  function deactivate() { } exports.deactivate = deactivate; Â 
```

Tadaaaï¼Œç®€å•çš„åŠŸèƒ½å°±å®Œæˆäº†ï¼

![](https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2018/7/19/164b1bafecd4f846~tplv-t2oaga2asx-jj-mark:3024:0:0:0:q75.png)

ä»£ç ä¸­ç”¨åˆ°äº†ä¸¤ä¸ª vscode windows çš„ apiï¼Œ_showInputBox_ å’Œ _showInformationMessage_ æ›´å¤š API è¯¦è§\[5\]

![](https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2018/7/19/164b1bafece82471~tplv-t2oaga2asx-jj-mark:3024:0:0:0:q75.png)

å¯ä»¥çœ‹åˆ° API åŒ…å«äº†å¾ˆå¤šä¿¡æ¯ï¼Œæ‰€ä»¥å¯ä»¥åšçš„äº‹è¿˜å¯ä»¥å¾ˆå¤šã€‚

## æ‰“åŒ…

```cmake
npm install -g vsce Â 
```

å‘å¸ƒå‰æˆ‘ä»¬å¯ä»¥æŠŠå¼€å‘å¥½çš„æ’ä»¶æ‰“åŒ…æˆ `.vsix` æ–‡ä»¶ï¼Œæä¾›ç»™èº«è¾¹çš„å°ä¼™ä¼´è¯•ç”¨ä¸€ä¸‹ã€‚

```ada
vsce package Â 
```

`city-aqi-0.0.1.vsix` å°±æ‰“åŒ…å®Œæˆäº†ï¼Œåœ¨æ’ä»¶é¢æ¿ä¸Šé€‰æ‹© ä» VSIX å®‰è£… æˆ–å‘½ä»¤è¡Œ \[6\] å®‰è£…å®Œæˆåé‡æ–°åŠ è½½ VSCode å°±å¯ä»¥ä½¿ç”¨äº†ã€‚

> è¿‡ç¨‹ä¸­å¯èƒ½ä¼šæç¤ºä½ å…ˆä¿®æ”¹ README.md æ–‡ä»¶æ‰èƒ½æ‰“åŒ…ï¼Œç®€å•æè¿°åŠŸèƒ½å³å¯ã€‚

## å‘å¸ƒ

è¯¦ç»†å®Œå–„è¿‡ README.md å’Œ CHANGELOG.md å¹¶ä¸”åˆ é™¤äº†ä¸€äº›å†—ä½™çš„æ–‡ä»¶ï¼Œä½ å°±å¯ä»¥å°†æ’ä»¶å‘å¸ƒåˆ°å¾®è½¯çš„æ’ä»¶å¸‚åœº Extension Marketplace ä¾›ä»–äººä¸‹è½½ä½¿ç”¨äº†ã€‚

åœ¨å‘å¸ƒæ’ä»¶ä¹‹å‰ï¼Œé¦–å…ˆï¼Œè·å– tokenï¼Œç™»å½• \[Visual Studio Team Services\]\[7\] æ³¨å†Œå¹¶ç™»å½•è´¦æˆ·ï¼Œåœ¨ Security ä¸­æ‰¾åˆ° Personal access tokens æ–°å»ºä¸€ä¸ª tokenã€‚å›åˆ°å‘½ä»¤è¡Œï¼š

```dsconfig
vsce create-publisher xxxx Â 
```

![](https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2018/7/19/164b1bafea50cd9e~tplv-t2oaga2asx-jj-mark:3024:0:0:0:q75.png)

> å®Œæˆåä¸éœ€è¦é‡æ–° login ï¼Œå› ä¸º vsce å·²ç»å¸®ä½ è®°å½•å½“å‰çš„ publisherã€‚

```crystal
$ vsce publish Publishing city-aqi@0.0.1... Successfully published city-aqi@0.0.1! Â 
```

ALL Done ![ğŸ‰](https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2018/7/19/164b1bb073bf8142~tplv-t2oaga2asx-jj-mark:3024:0:0:0:q75.png)

![](https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2018/7/19/164b1bb01088e17e~tplv-t2oaga2asx-jj-mark:3024:0:0:0:q75.png)

## å†™åœ¨æœ€å

ç¬”è€…å‡ å¹´å‰ä¸€ç›´æ˜¯ `Sublime Text` çš„ä½¿ç”¨è€…ï¼Œä¿®æ”¹ jspã€vmã€sqlç­‰ç­‰æ–‡æœ¬æ–‡ä»¶ï¼Œåæ¥å‡ºç°äº† `Atom` ç¤¾åŒºä¹Ÿç›¸å½“æ´»è·ƒï¼Œç”¨æˆ·åŒæ ·å¾ˆå¤šï¼Œç¬”è€…ä¹Ÿæ›¾è¯•ç”¨è¿‡ä¸€æ®µæ—¶é—´ã€‚è¿‘ä¸¤å¹´ VSCode ä¸€ç›´æ˜¯æˆ‘çš„ä¸»åŠ›å¼€å‘ç¼–è¾‘å™¨ï¼Œè™½ç„¶å®ƒä¹Ÿæœ‰ç¼ºç‚¹ï¼Œä½†å®ƒåœ¨ä¸æ–­ç²¾è¿›å’Œå®Œå–„ï¼Œå¾®è½¯å¤§å‚çš„ç»´æŠ¤å’Œæ›´æ–°é¢‘ç‡ä¹Ÿå¾ˆåŠæ—¶ã€‚

å¾ˆå¤šå¤§ç‰›ä»¬å–œçˆ±çš„ `Vim` å’Œ `Emcas` ç¬”è€…æ²¡æœ‰ç”¨è¿‡ï¼Œç”šè‡³è¿å°è¯•éƒ½æ²¡æœ‰ï¼Œå¯èƒ½æ˜¯è¢«è¿‡äºçµæ´»çš„é…ç½®**å“åˆ°äº†**â€¦

PSï¼Œæœ€è¿‘çŸ¥é“ä¸€ä¸ªè¯**å®œå®¶ç†è®º**ï¼Œå¥—åœ¨ä¸Šé¢å‡ ä¸ªå·¥å…·ä¸Šï¼Œåº”è¯¥éƒ½é€‚ç”¨ï¼Œ**åˆé€‚çš„æ‰æ˜¯æœ€å¥½çš„** ã€‚ç°åœ¨ VSCode çš„å‰ç«¯å¼€å‘ç¯å¢ƒï¼Œå¯ä»¥ä½¿ç”¨åŒæ­¥æ’ä»¶æ¥è¿›è¡Œå¤‡ä»½å’Œè¿˜åŸé…ç½®ã€‚

VSCode æœ‰å¾ˆå¤šæ–¹ä¾¿çš„æ’ä»¶ï¼Œå¯ä»¥å¸®åŠ©æˆ‘ä»¬æé«˜å¼€å‘æ•ˆç‡ï¼Œä»¥åæ‰¾æœºä¼šå†™ä¸€ä¸ªæ¨èåˆ—è¡¨åˆ†äº«å‡ºæ¥ã€‚

## æ‰©å±•é˜…è¯»

\[1\]https://nodejs.org/en/  
\[2\]https://www.npmjs.com/package/npm  
\[3\]http://yeoman.io/  
\[4\]https://github.com/Microsoft/vscode-generator-code  
\[5\]https://code.visualstudio.com/docs/extensionAPI/vscode-api  
\[6\]https://code.visualstudio.com/docs/editor/extension-gallery#\_install-from-a-vsix  
\[7\]https://docs.microsoft.com/vsts/accounts/create-account-msa-or-work-student  
\[8\]https://code.visualstudio.com/docs/extensions/overview  
\[9\]https://code.visualstudio.com/docs/extensionAPI/vscode-api  
\[10\]https://wx.jdcloud.com/

æœ‰å…´è¶£æ¬¢è¿å…³æ³¨æˆ‘ä»¬çš„å…¬ä¼—å·ï¼šå…¨æ ˆæ¢ç´¢ã€‚æ¬¢è¿äº¤æµã€‚

![](https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2018/7/19/164b1bb019aec86d~tplv-t2oaga2asx-jj-mark:3024:0:0:0:q75.png)