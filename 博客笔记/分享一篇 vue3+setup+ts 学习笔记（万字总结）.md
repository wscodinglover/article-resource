关注 Vue社区，回复“加群”

加入我们一起学习，天天进步

![Image](https://mmbiz.qpic.cn/mmbiz_jpg/yphVQAwjncuYHy06YBuibbMN5ibicic6mhDU4RK69jIheEjSTuqNvFYytaAicBW3oOUZNaBMkVoUQs0tt5AC2FQYp9w/640?wx_fmt=jpeg&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1)

```
<blockquote data-tool="mdnice编辑器" data-darkreader-inline-outline="" data-darkreader-inline-color="" data-darkreader-inline-bgcolor=""><p data-darkreader-inline-outline="" data-darkreader-inline-color=""><span data-darkreader-inline-outline="">vue3 于 2020 年 09 月 18 日正式发布，2022 年 2 月 7 日 vue3 成为新的默认版本</span></p></blockquote><h2 data-tool="mdnice编辑器" data-darkreader-inline-outline="" data-darkreader-inline-color="" data-darkreader-inline-bgcolor="" data-darkreader-inline-border-bottom=""><span data-darkreader-inline-outline="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor="" data-darkreader-inline-color="">前言</span></h2><p data-darkreader-inline-outline="" data-darkreader-inline-color="" data-darkreader-inline-bgcolor=""><span data-darkreader-inline-outline="">在 vue3.2 中，我们只需在script标签中添加setup。就可以做到，组件只需引入不用注册，属性和方法也不用 return 才能于 template 中使用，也不用写setup函数，也不用写export default ，甚至是自定义指令也可以在我们的template中自动获得。</span></p><p data-darkreader-inline-outline="" data-darkreader-inline-color="" data-darkreader-inline-bgcolor=""><span data-darkreader-inline-outline="">本次我们的学习也将在 setup 语法糖下进行。</span></p><h2 data-tool="mdnice编辑器" data-darkreader-inline-outline="" data-darkreader-inline-color="" data-darkreader-inline-bgcolor="" data-darkreader-inline-border-bottom=""><span data-darkreader-inline-outline="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor="" data-darkreader-inline-color=""><span data-darkreader-inline-outline="">环境搭建</span></span></h2><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" data-darkreader-inline-outline="" data-darkreader-inline-bgcolor="" data-darkreader-inline-color=""><span data-tool="mdnice编辑器" data-darkreader-inline-outline="" data-darkreader-inline-boxshadow=""><span data-width="100%" data-darkreader-inline-outline="" data-darkreader-inline-bgcolor=""></span><code data-darkreader-inline-outline="" data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor="">npm&nbsp;init&nbsp;vue@latest<br></code></span></section><h2 data-tool="mdnice编辑器" data-darkreader-inline-outline="" data-darkreader-inline-color="" data-darkreader-inline-bgcolor="" data-darkreader-inline-border-bottom=""><span data-darkreader-inline-outline="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor="" data-darkreader-inline-color=""><span data-darkreader-inline-outline="">使用工具</span></span></h2><article data-content="[{&quot;type&quot;:&quot;block&quot;,&quot;id&quot;:&quot;qSZk-1648104665755&quot;,&quot;name&quot;:&quot;paragraph&quot;,&quot;data&quot;:{&quot;version&quot;:1},&quot;nodes&quot;:[{&quot;type&quot;:&quot;text&quot;,&quot;id&quot;:&quot;CuLK-1648104665754&quot;,&quot;leaves&quot;:[{&quot;text&quot;:&quot;核心函数也就两个：&quot;,&quot;marks&quot;:[]}]}],&quot;state&quot;:{}},{&quot;type&quot;:&quot;block&quot;,&quot;id&quot;:&quot;DUGz-1648110756652&quot;,&quot;name&quot;:&quot;list-item&quot;,&quot;data&quot;:{&quot;version&quot;:1,&quot;listId&quot;:&quot;2b1b-1648110756626&quot;,&quot;listLevel&quot;:1,&quot;listType&quot;:&quot;unordered&quot;},&quot;nodes&quot;:[{&quot;type&quot;:&quot;text&quot;,&quot;id&quot;:&quot;wEM2-1648110756651&quot;,&quot;leaves&quot;:[{&quot;text&quot;:&quot;调用器：就是把真正的执行函数和参数传入，创建返回一个新的Promise，而这个新Promise的什么时候返回，取决于这个异步任务何时被调度。Promise内部主要就是创建一个任务，判断任务是执行还是入队。&quot;,&quot;marks&quot;:[]}]}],&quot;state&quot;:{&quot;index&quot;:1}},{&quot;type&quot;:&quot;block&quot;,&quot;id&quot;:&quot;PFth-1648110756654&quot;,&quot;name&quot;:&quot;list-item&quot;,&quot;data&quot;:{&quot;version&quot;:1,&quot;listId&quot;:&quot;2b1b-1648110756626&quot;,&quot;listLevel&quot;:1,&quot;listType&quot;:&quot;unordered&quot;},&quot;nodes&quot;:[{&quot;type&quot;:&quot;text&quot;,&quot;id&quot;:&quot;qets-1648110756653&quot;,&quot;leaves&quot;:[{&quot;text&quot;:&quot;创建任务：实际上就是返回了一个函数，将真正的执行函数放在里面执行。这里利用了Promise的finally方法，在finally中判断是否执行下一个任务，实现任务队列连续消费的地方就是这里。&quot;,&quot;marks&quot;:[]}]}],&quot;state&quot;:{}}]" data-darkreader-inline-outline="" data-darkreader-inline-color="" data-darkreader-inline-bgcolor=""><article data-content="[{&quot;type&quot;:&quot;block&quot;,&quot;id&quot;:&quot;C01K-1648105034695&quot;,&quot;name&quot;:&quot;paragraph&quot;,&quot;data&quot;:{&quot;version&quot;:1},&quot;nodes&quot;:[{&quot;type&quot;:&quot;text&quot;,&quot;id&quot;:&quot;uphS-1648105034693&quot;,&quot;leaves&quot;:[{&quot;text&quot;:&quot;性能优化工作&quot;,&quot;marks&quot;:[]}]}],&quot;state&quot;:{}},{&quot;type&quot;:&quot;block&quot;,&quot;id&quot;:&quot;0jzG-1648104665777&quot;,&quot;name&quot;:&quot;paragraph&quot;,&quot;data&quot;:{&quot;version&quot;:1},&quot;nodes&quot;:[{&quot;type&quot;:&quot;text&quot;,&quot;id&quot;:&quot;zanJ-1648104665776&quot;,&quot;leaves&quot;:[{&quot;text&quot;:&quot;最近在学的新技术&quot;,&quot;marks&quot;:[]}]}],&quot;state&quot;:{}}]" data-darkreader-inline-outline=""><p data-darkreader-inline-outline=""><code data-darkreader-inline-outline="">cript setup &gt; + VSCode + Volar</code></p><blockquote data-darkreader-inline-outline="" data-darkreader-inline-border-left="" data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor=""><p data-darkreader-inline-outline="">安装 Volar 后，注意禁用 vetur</p></blockquote><p data-darkreader-inline-outline="">好的，<span data-darkreader-inline-outline="">准备工作已经完成，下面我们开始进入到 vue3 setup 的正式学习</span></p><h2 data-tool="mdnice编辑器" data-darkreader-inline-outline="" data-darkreader-inline-border-bottom=""><span data-darkreader-inline-outline="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor="" data-darkreader-inline-color=""><span data-darkreader-inline-outline="">ref 和 reactive</span></span></h2><ul data-darkreader-inline-outline=""><li data-darkreader-inline-outline=""><p data-darkreader-inline-outline="">ref: 用来给基本数据类型绑定响应式数据，访问时需要通过 .value 的形式， tamplate 会自动解析,不需要 .value</p></li><li data-darkreader-inline-outline=""><p data-darkreader-inline-outline="">reactive: 用来给 复杂数据类型 绑定响应式数据，直接访问即可</p></li></ul><blockquote data-darkreader-inline-outline="" data-darkreader-inline-border-left="" data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor=""><p data-darkreader-inline-outline="">ref其实也是内部调用 reactive 来实现的</p></blockquote><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" data-darkreader-inline-outline="" data-darkreader-inline-color=""><span data-tool="mdnice编辑器" data-darkreader-inline-outline="" data-darkreader-inline-boxshadow=""><span data-width="100%" data-darkreader-inline-outline="" data-darkreader-inline-bgcolor=""></span><code data-darkreader-inline-outline="" data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor=""><span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">template</span>&gt;</span><br>&nbsp;&nbsp;<span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">div</span>&gt;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">p</span>&gt;</span>{{title}}<span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">p</span>&gt;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">h4</span>&gt;</span>{{userInfo}}<span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">h4</span>&gt;</span><br>&nbsp;&nbsp;<span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">div</span>&gt;</span><br><span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">template</span>&gt;</span><br><br><span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">script</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">setup</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">lang</span>=<span data-darkreader-inline-outline="" data-darkreader-inline-color="">"ts"</span>&gt;</span><span data-darkreader-inline-outline=""><br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">import</span>&nbsp;{&nbsp;ref,&nbsp;reactive&nbsp;}&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">from</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">"vue"</span>;<br>type&nbsp;Person&nbsp;=&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">name</span>:&nbsp;string;<br>&nbsp;&nbsp;&nbsp;&nbsp;age:&nbsp;number;<br>&nbsp;&nbsp;&nbsp;&nbsp;gender?:&nbsp;string;<br>};<br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">const</span>&nbsp;title&nbsp;=&nbsp;ref&lt;string&gt;(<span data-darkreader-inline-outline="" data-darkreader-inline-color="">"彼时彼刻，恰如此时此刻"</span>);<br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">const</span>&nbsp;userInfo&nbsp;=&nbsp;reactive&lt;Person&gt;({<br>&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">name</span>:&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">'树哥'</span>,<br>&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">age</span>:&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">18</span><br>})<br></span><span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">script</span>&gt;</span></code></span></section><h2 data-tool="mdnice编辑器" data-darkreader-inline-outline="" data-darkreader-inline-border-bottom=""><span data-darkreader-inline-outline="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor="" data-darkreader-inline-color=""><span data-darkreader-inline-outline="">toRef、toRefs、toRaw</span></span></h2><h3 data-id="heading-5" data-darkreader-inline-outline="">toRef</h3><p data-darkreader-inline-outline="">toRef 如果原始对象是非响应式的,数据会变,但不会更新视图</p><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" data-darkreader-inline-outline="" data-darkreader-inline-color=""><span data-tool="mdnice编辑器" data-darkreader-inline-outline="" data-darkreader-inline-boxshadow=""><span data-width="100%" data-darkreader-inline-outline="" data-darkreader-inline-bgcolor=""></span><code data-darkreader-inline-outline="" data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor=""><span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">template</span>&gt;</span><br>&nbsp;&nbsp;<span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">div</span>&gt;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">button</span>&nbsp;@<span data-darkreader-inline-outline="" data-darkreader-inline-color="">click</span>=<span data-darkreader-inline-outline="" data-darkreader-inline-color="">"change"</span>&gt;</span>按钮<span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">button</span>&gt;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{{state}}<br>&nbsp;&nbsp;<span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">div</span>&gt;</span><br><span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">template</span>&gt;</span><br><br><span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">script</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">setup</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">lang</span>=<span data-darkreader-inline-outline="" data-darkreader-inline-color="">"ts"</span>&gt;</span><span data-darkreader-inline-outline=""><br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">import</span>&nbsp;{&nbsp;reactive,&nbsp;toRef&nbsp;}&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">from</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">'vue'</span><br><br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">const</span>&nbsp;obj&nbsp;=&nbsp;{<br>&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">name</span>:&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">'树哥'</span>,<br>&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">age</span>:&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">18</span><br>}<br><br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">const</span>&nbsp;state&nbsp;=&nbsp;toRef(obj,&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">'age'</span>)<br><br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">const</span>&nbsp;change&nbsp;=&nbsp;<span data-darkreader-inline-outline=""><span data-darkreader-inline-outline="">()</span>&nbsp;=&gt;</span>&nbsp;{<br>&nbsp;&nbsp;state.value++<br>&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">console</span>.log(<span data-darkreader-inline-outline="" data-darkreader-inline-color="">'obj:'</span>,obj,<span data-darkreader-inline-outline="" data-darkreader-inline-color="">'state:'</span>,&nbsp;state);<br>}<br></span><span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">script</span>&gt;</span><br></code></span></section><p data-darkreader-inline-outline=""><img data-galleryid="" data-ratio="0.275" data-src="https://mmbiz.qpic.cn/mmbiz_png/ic5A4V8PX4PniaElFR8nqkPVh6iajiaF7ytv3dxLqlB3Yp5ricwUEny8GUFWgpMyXtHP5PkgDmzzRF2icwQphxZyFBrQ/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" data-type="png" data-w="1080" data-darkreader-inline-outline="" data-original-style="outline: 0px; box-sizing: border-box !important; overflow-wrap: break-word !important; width: 677px !important; visibility: visible !important; --darkreader-inline-outline: initial;" data-index="3" src="data:image/svg+xml,%3C%3Fxml version='1.0' encoding='UTF-8'%3F%3E%3Csvg width='1px' height='1px' viewBox='0 0 1 1' version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3E%3Ctitle%3E%3C/title%3E%3Cg stroke='none' stroke-width='1' fill='none' fill-rule='evenodd' fill-opacity='0'%3E%3Cg transform='translate(-249.000000, -126.000000)' fill='%23FFFFFF'%3E%3Crect x='249' y='126' width='1' height='1'%3E%3C/rect%3E%3C/g%3E%3C/g%3E%3C/svg%3E" _width="677px" crossorigin="anonymous" alt="Image"></p><p data-darkreader-inline-outline="">可以看到，点击按钮，当原始对象是非响应式时，使用toRef 的数据改变，但是试图并没有更新</p><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" data-darkreader-inline-outline="" data-darkreader-inline-color=""><span data-tool="mdnice编辑器" data-darkreader-inline-outline="" data-darkreader-inline-boxshadow=""><span data-width="100%" data-darkreader-inline-outline="" data-darkreader-inline-bgcolor=""></span><code data-darkreader-inline-outline="" data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor=""><span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">template</span>&gt;</span><br>&nbsp;&nbsp;<span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">div</span>&gt;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">button</span>&nbsp;@<span data-darkreader-inline-outline="" data-darkreader-inline-color="">click</span>=<span data-darkreader-inline-outline="" data-darkreader-inline-color="">"change"</span>&gt;</span>按钮<span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">button</span>&gt;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;{{state}}<br>&nbsp;&nbsp;<span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">div</span>&gt;</span><br><span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">template</span>&gt;</span><br><br><span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">script</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">setup</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">lang</span>=<span data-darkreader-inline-outline="" data-darkreader-inline-color="">"ts"</span>&gt;</span><span data-darkreader-inline-outline=""><br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">import</span>&nbsp;{&nbsp;reactive,&nbsp;toRef&nbsp;}&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">from</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">'vue'</span><br><br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">const</span>&nbsp;obj&nbsp;=&nbsp;reactive({<br>&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">name</span>:&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">'树哥'</span>,<br>&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">age</span>:&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">18</span><br>})<br><br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">const</span>&nbsp;state&nbsp;=&nbsp;toRef(obj,&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">'age'</span>)<br><br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">const</span>&nbsp;change&nbsp;=&nbsp;<span data-darkreader-inline-outline=""><span data-darkreader-inline-outline="">()</span>&nbsp;=&gt;</span>&nbsp;{<br>&nbsp;&nbsp;state.value++<br>&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">console</span>.log(<span data-darkreader-inline-outline="" data-darkreader-inline-color="">'obj:'</span>,&nbsp;obj,&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">'state:'</span>,&nbsp;state);<br>}<br></span><span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">script</span>&gt;</span><br></code></span></section><p data-darkreader-inline-outline=""><img data-galleryid="" data-type="png" data-ratio="0.3037037037037037" data-w="1080" data-src="https://mmbiz.qpic.cn/mmbiz_png/ic5A4V8PX4PniaElFR8nqkPVh6iajiaF7ytvdkzRaBSRNV59pWgbh1OncKyCwcgkA3omYcFM7hibtbK70jeeD41PkIA/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" data-darkreader-inline-outline="" data-original-style="outline: 0px; box-sizing: border-box !important; overflow-wrap: break-word !important; width: 677px !important; visibility: visible !important; --darkreader-inline-outline: initial;" data-index="4" src="data:image/svg+xml,%3C%3Fxml version='1.0' encoding='UTF-8'%3F%3E%3Csvg width='1px' height='1px' viewBox='0 0 1 1' version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3E%3Ctitle%3E%3C/title%3E%3Cg stroke='none' stroke-width='1' fill='none' fill-rule='evenodd' fill-opacity='0'%3E%3Cg transform='translate(-249.000000, -126.000000)' fill='%23FFFFFF'%3E%3Crect x='249' y='126' width='1' height='1'%3E%3C/rect%3E%3C/g%3E%3C/g%3E%3C/svg%3E" _width="677px" crossorigin="anonymous" alt="Image"></p><section data-darkreader-inline-outline=""><br><span data-darkreader-inline-outline="">当我们把 obj 用 reactive 包裹，再使用 toRef，点击按钮时，可以看到视图和数据都变了</span></section><blockquote data-darkreader-inline-outline="" data-darkreader-inline-border-left="" data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor=""><p data-darkreader-inline-outline="">toRef返回的值是否具有响应性取决于被解构的对象本身是否具有响应性。响应式数据经过toRef返回的值仍具有响应性，非响应式数据经过toRef返回的值仍没有响应性。</p></blockquote><h3 data-id="heading-6" data-darkreader-inline-outline="">toRefs</h3><p data-darkreader-inline-outline="">toRefs相当于对对象内每个属性调用toRef，toRefs返回的对象内的属性使用时需要加.value,主要是方便我们解构使用</p><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" data-darkreader-inline-outline="" data-darkreader-inline-color=""><span data-tool="mdnice编辑器" data-darkreader-inline-outline="" data-darkreader-inline-boxshadow=""><span data-width="100%" data-darkreader-inline-outline="" data-darkreader-inline-bgcolor=""></span><code data-darkreader-inline-outline="" data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor=""><span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">template</span>&gt;</span><br>&nbsp;&nbsp;<span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">div</span>&gt;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">button</span>&nbsp;@<span data-darkreader-inline-outline="" data-darkreader-inline-color="">click</span>=<span data-darkreader-inline-outline="" data-darkreader-inline-color="">"change"</span>&gt;</span>按钮<span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">button</span>&gt;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;name--{{name}}---age{{age}}<br>&nbsp;&nbsp;<span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">div</span>&gt;</span><br><span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">template</span>&gt;</span><br><br><span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">script</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">setup</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">lang</span>=<span data-darkreader-inline-outline="" data-darkreader-inline-color="">"ts"</span>&gt;</span><span data-darkreader-inline-outline=""><br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">import</span>&nbsp;{&nbsp;reactive,&nbsp;toRefs&nbsp;}&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">from</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">'vue'</span><br><br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">const</span>&nbsp;obj&nbsp;=&nbsp;reactive({<br>&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">name</span>:&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">'树哥'</span>,<br>&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">age</span>:&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">18</span><br>})<br><br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">let</span>&nbsp;{&nbsp;name,&nbsp;age&nbsp;}&nbsp;=&nbsp;toRefs(obj)<br><br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">const</span>&nbsp;change&nbsp;=&nbsp;<span data-darkreader-inline-outline=""><span data-darkreader-inline-outline="">()</span>&nbsp;=&gt;</span>&nbsp;{<br>&nbsp;&nbsp;age.value++<br>&nbsp;&nbsp;name.value&nbsp;=&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">'张麻子'</span><br>&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">console</span>.log(<span data-darkreader-inline-outline="" data-darkreader-inline-color="">'obj:'</span>,&nbsp;obj);<br>&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">console</span>.log(<span data-darkreader-inline-outline="" data-darkreader-inline-color="">'name:'</span>,&nbsp;name);<br>&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">console</span>.log(<span data-darkreader-inline-outline="" data-darkreader-inline-color="">'age:'</span>,&nbsp;age);<br>}<br></span><span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">script</span>&gt;</span><br></code></span></section><p data-darkreader-inline-outline="">简单理解就是批量版的toRef,(<span data-darkreader-inline-outline="">其源码实现也正是通过对象循环调用了toRef</span>)</p><h3 data-id="heading-7" data-darkreader-inline-outline="">toRaw</h3><p data-darkreader-inline-outline="">将响应式对象修改为普通对象</p><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" data-darkreader-inline-outline="" data-darkreader-inline-color=""><span data-tool="mdnice编辑器" data-darkreader-inline-outline="" data-darkreader-inline-boxshadow=""><span data-width="100%" data-darkreader-inline-outline="" data-darkreader-inline-bgcolor=""></span><code data-darkreader-inline-outline="" data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor=""><span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">template</span>&gt;</span><br>&nbsp;&nbsp;<span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">div</span>&gt;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">button</span>&nbsp;@<span data-darkreader-inline-outline="" data-darkreader-inline-color="">click</span>=<span data-darkreader-inline-outline="" data-darkreader-inline-color="">"change"</span>&gt;</span>按钮<span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">button</span>&gt;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;{{data}}<br>&nbsp;&nbsp;<span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">div</span>&gt;</span><br><span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">template</span>&gt;</span><br><br><span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">script</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">setup</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">lang</span>=<span data-darkreader-inline-outline="" data-darkreader-inline-color="">"ts"</span>&gt;</span><span data-darkreader-inline-outline=""><br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">import</span>&nbsp;{&nbsp;reactive,&nbsp;toRaw&nbsp;}&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">from</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">'vue'</span><br><br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">const</span>&nbsp;obj&nbsp;=&nbsp;reactive({<br>&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">name</span>:&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">'树哥'</span>,<br>&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">age</span>:&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">18</span><br>})<br><br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">const</span>&nbsp;data&nbsp;=&nbsp;toRaw(obj)<br><br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">const</span>&nbsp;change&nbsp;=&nbsp;<span data-darkreader-inline-outline=""><span data-darkreader-inline-outline="">()</span>&nbsp;=&gt;</span>&nbsp;{<br>&nbsp;&nbsp;data.age&nbsp;=&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">19</span><br>&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">console</span>.log(<span data-darkreader-inline-outline="" data-darkreader-inline-color="">'obj:'</span>,&nbsp;obj,&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">'data:'</span>,&nbsp;data);<br>}<br></span><span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">script</span>&gt;</span><br></code></span></section><p data-darkreader-inline-outline=""><img data-galleryid="" data-ratio="0.25925925925925924" data-src="https://mmbiz.qpic.cn/mmbiz_png/ic5A4V8PX4PniaElFR8nqkPVh6iajiaF7ytvL5N5w4e8fZLRiaYIibSYiaH2jCMKVrWZJImIv1VRPAQlbtn84HJyvwTYw/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" data-type="png" data-w="1080" data-darkreader-inline-outline="" data-original-style="outline: 0px; box-sizing: border-box !important; overflow-wrap: break-word !important; width: 677px !important; visibility: visible !important; --darkreader-inline-outline: initial;" data-index="5" src="data:image/svg+xml,%3C%3Fxml version='1.0' encoding='UTF-8'%3F%3E%3Csvg width='1px' height='1px' viewBox='0 0 1 1' version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3E%3Ctitle%3E%3C/title%3E%3Cg stroke='none' stroke-width='1' fill='none' fill-rule='evenodd' fill-opacity='0'%3E%3Cg transform='translate(-249.000000, -126.000000)' fill='%23FFFFFF'%3E%3Crect x='249' y='126' width='1' height='1'%3E%3C/rect%3E%3C/g%3E%3C/g%3E%3C/svg%3E" _width="677px" crossorigin="anonymous" alt="Image"></p><section data-darkreader-inline-outline=""><span data-darkreader-inline-outline="">数据能变化，视图不变化(失去响应式)</span></section></article><h2 data-tool="mdnice编辑器" data-darkreader-inline-outline="" data-darkreader-inline-border-bottom=""><span data-darkreader-inline-outline="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor="" data-darkreader-inline-color=""><span data-darkreader-inline-outline="">computed</span></span></h2><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" data-darkreader-inline-outline="" data-darkreader-inline-color=""><span data-tool="mdnice编辑器" data-darkreader-inline-outline="" data-darkreader-inline-boxshadow=""><span data-width="100%" data-darkreader-inline-outline="" data-darkreader-inline-bgcolor=""></span><code data-darkreader-inline-outline="" data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor=""><span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">template</span>&gt;</span><br>&nbsp;&nbsp;<span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">div</span>&gt;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">p</span>&gt;</span>{{title}}<span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">p</span>&gt;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">h4</span>&gt;</span>{{userInfo}}<span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">h4</span>&gt;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">h1</span>&gt;</span>{{add}}<span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">h1</span>&gt;</span><br>&nbsp;&nbsp;<span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">div</span>&gt;</span><br><span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">template</span>&gt;</span><br><br><span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">script</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">setup</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">lang</span>=<span data-darkreader-inline-outline="" data-darkreader-inline-color="">"ts"</span>&gt;</span><span data-darkreader-inline-outline=""><br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">import</span>&nbsp;{&nbsp;ref,&nbsp;reactive,computed&nbsp;}&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">from</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">"vue"</span>;<br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">const</span>&nbsp;count&nbsp;=&nbsp;ref(<span data-darkreader-inline-outline="" data-darkreader-inline-color="">0</span>)<br><br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">//&nbsp;推导得到的类型：ComputedRef&lt;number&gt;</span><br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">const</span>&nbsp;add&nbsp;=&nbsp;computed(<span data-darkreader-inline-outline=""><span data-darkreader-inline-outline="">()</span>&nbsp;=&gt;</span>&nbsp;count.value&nbsp;+<span data-darkreader-inline-outline="" data-darkreader-inline-color="">1</span>)<br><br></span><span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">script</span>&gt;</span></code></span></section><h2 data-tool="mdnice编辑器" data-darkreader-inline-outline="" data-darkreader-inline-border-bottom=""><span data-darkreader-inline-outline="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor="" data-darkreader-inline-color=""><span data-darkreader-inline-outline="">watch</span></span></h2><p data-darkreader-inline-outline="">vue3 watch 的作用和 Vue2 中的 watch 作用是一样的，他们都是用来监听响应式状态发生变化的，当响应式状态发生变化时，就会触发一个回调函数。</p><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" data-darkreader-inline-outline="" data-darkreader-inline-color=""><span data-tool="mdnice编辑器" data-darkreader-inline-outline="" data-darkreader-inline-boxshadow=""><span data-width="100%" data-darkreader-inline-outline="" data-darkreader-inline-bgcolor=""></span><code data-darkreader-inline-outline="" data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor="">watch(data,()=&gt;{},{})<br></code></span></section><ul data-darkreader-inline-outline=""><li data-darkreader-inline-outline=""><p data-darkreader-inline-outline="">参数一，监听的数据</p></li><li data-darkreader-inline-outline=""><p data-darkreader-inline-outline="">参数二，数据改变时触发的回调函数（newVal,oldVal）</p></li><li data-darkreader-inline-outline=""><p data-darkreader-inline-outline="">参数三，options配置项，为一个对象</p></li><li data-darkreader-inline-outline=""><p data-darkreader-inline-outline=""><span data-darkreader-inline-outline="">1、监听ref定义的一个响应式数据</span></p></li></ul><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" data-darkreader-inline-outline="" data-darkreader-inline-color=""><span data-tool="mdnice编辑器" data-darkreader-inline-outline="" data-darkreader-inline-boxshadow=""><span data-width="100%" data-darkreader-inline-outline="" data-darkreader-inline-bgcolor=""></span><code data-darkreader-inline-outline="" data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor=""><span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">script</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">setup</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">lang</span>=<span data-darkreader-inline-outline="" data-darkreader-inline-color="">"ts"</span>&gt;</span><span data-darkreader-inline-outline=""><br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">import</span>&nbsp;{&nbsp;ref,&nbsp;watch&nbsp;}&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">from</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">"vue"</span>;<br><br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">const</span>&nbsp;str&nbsp;=&nbsp;ref(<span data-darkreader-inline-outline="" data-darkreader-inline-color="">'彼时彼刻'</span>)<br><br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">//3s后改变str的值</span><br>setTimeout(<span data-darkreader-inline-outline=""><span data-darkreader-inline-outline="">()</span>&nbsp;=&gt;</span>&nbsp;{&nbsp;str.value&nbsp;=&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">'恰如此时此刻'</span>&nbsp;},&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">3000</span>)<br><br>watch(str,&nbsp;(newV,&nbsp;oldV)&nbsp;=&gt;&nbsp;{<br>&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">console</span>.log(newV,&nbsp;oldV)&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">//恰如此时此刻&nbsp;彼时彼刻</span><br>})<br><br></span><span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">script</span>&gt;</span><br></code></span></section><ul data-darkreader-inline-outline=""><li data-darkreader-inline-outline=""><p data-darkreader-inline-outline=""><span data-darkreader-inline-outline="">2、监听多个ref</span></p></li></ul><p data-darkreader-inline-outline=""><span data-darkreader-inline-outline="">这时候写法变为数组的形式</span></p><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" data-darkreader-inline-outline="" data-darkreader-inline-color=""><span data-tool="mdnice编辑器" data-darkreader-inline-outline="" data-darkreader-inline-boxshadow=""><span data-width="100%" data-darkreader-inline-outline="" data-darkreader-inline-bgcolor=""></span><code data-darkreader-inline-outline="" data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor=""><span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">script</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">setup</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">lang</span>=<span data-darkreader-inline-outline="" data-darkreader-inline-color="">"ts"</span>&gt;</span><span data-darkreader-inline-outline=""><br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">import</span>&nbsp;{&nbsp;ref,&nbsp;watch&nbsp;}&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">from</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">"vue"</span>;<br><br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">let</span>&nbsp;name&nbsp;=&nbsp;ref(<span data-darkreader-inline-outline="" data-darkreader-inline-color="">'树哥'</span>)<br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">let</span>&nbsp;age&nbsp;=&nbsp;ref(<span data-darkreader-inline-outline="" data-darkreader-inline-color="">18</span>)<br><br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">//3s后改变值</span><br>setTimeout(<span data-darkreader-inline-outline=""><span data-darkreader-inline-outline="">()</span>&nbsp;=&gt;</span>&nbsp;{<br>&nbsp;&nbsp;name.value&nbsp;=&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">'我叫树哥'</span><br>&nbsp;&nbsp;age.value&nbsp;=&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">19</span><br>},&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">3000</span>)<br><br>watch([name,&nbsp;age],&nbsp;(newV,&nbsp;oldV)&nbsp;=&gt;&nbsp;{<br>&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">console</span>.log(newV,&nbsp;oldV)&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">//&nbsp;['我叫树哥',&nbsp;19]&nbsp;&nbsp;['树哥',&nbsp;18]</span><br>})<br><br></span><span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">script</span>&gt;</span><br></code></span></section><ul data-darkreader-inline-outline=""><li data-darkreader-inline-outline=""><p data-darkreader-inline-outline=""><span data-darkreader-inline-outline="">3、监听Reactive定义的响应式对象</span></p></li></ul><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" data-darkreader-inline-outline="" data-darkreader-inline-color=""><span data-tool="mdnice编辑器" data-darkreader-inline-outline="" data-darkreader-inline-boxshadow=""><span data-width="100%" data-darkreader-inline-outline="" data-darkreader-inline-bgcolor=""></span><code data-darkreader-inline-outline="" data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor=""><span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">script</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">setup</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">lang</span>=<span data-darkreader-inline-outline="" data-darkreader-inline-color="">"ts"</span>&gt;</span><span data-darkreader-inline-outline=""><br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">import</span>&nbsp;{&nbsp;reactive,&nbsp;watch&nbsp;}&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">from</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">"vue"</span>;<br><br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">let</span>&nbsp;info&nbsp;=&nbsp;reactive({<br>&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">name</span>:&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">'树哥'</span>,<br>&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">age</span>:&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">18</span><br>})<br><br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">//3s后改变值</span><br>setTimeout(<span data-darkreader-inline-outline=""><span data-darkreader-inline-outline="">()</span>&nbsp;=&gt;</span>&nbsp;{<br>&nbsp;&nbsp;info.age&nbsp;=&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">19</span><br>},&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">3000</span>)<br><br>watch(info,&nbsp;(newV,&nbsp;oldV)&nbsp;=&gt;&nbsp;{<br>&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">console</span>.log(newV,&nbsp;oldV)&nbsp;<br>})<br><br></span><span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">script</span>&gt;</span><br></code></span></section><section data-darkreader-inline-outline=""><span data-darkreader-inline-outline="">当 watch 监听的是一个响应式对象时，会隐式地创建一个深层侦听器，即该响应式对象里面的任何属性发生变化，都会触发监听函数中的回调函数。</span><span data-darkreader-inline-outline="">即当 watch 监听的是一个响应式对象时，默认开启 deep：true</span></section><section data-darkreader-inline-outline=""><span data-darkreader-inline-outline=""><br></span></section><ul data-darkreader-inline-outline=""><li data-darkreader-inline-outline=""><p data-darkreader-inline-outline=""><span data-darkreader-inline-outline="">4、监听reactive 定义响应式对象的单一属性</span></p></li></ul><p data-darkreader-inline-outline="">错误写法</p><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" data-darkreader-inline-outline="" data-darkreader-inline-color=""><span data-tool="mdnice编辑器" data-darkreader-inline-outline="" data-darkreader-inline-boxshadow=""><span data-width="100%" data-darkreader-inline-outline="" data-darkreader-inline-bgcolor=""></span><code data-darkreader-inline-outline="" data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor=""><span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">script</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">setup</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">lang</span>=<span data-darkreader-inline-outline="" data-darkreader-inline-color="">"ts"</span>&gt;</span><span data-darkreader-inline-outline=""><br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">import</span>&nbsp;{&nbsp;reactive,&nbsp;watch&nbsp;}&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">from</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">"vue"</span>;<br><br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">let</span>&nbsp;info&nbsp;=&nbsp;reactive({<br>&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">name</span>:&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">'树哥'</span>,<br>&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">age</span>:&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">18</span><br>})<br><br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">//3s后改变值</span><br>setTimeout(<span data-darkreader-inline-outline=""><span data-darkreader-inline-outline="">()</span>&nbsp;=&gt;</span>&nbsp;{<br>&nbsp;&nbsp;info.age&nbsp;=&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">19</span><br>},&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">3000</span>)<br><br><br>watch(info.age,&nbsp;(newV,&nbsp;oldV)&nbsp;=&gt;&nbsp;{<br>&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">console</span>.log(newV,&nbsp;oldV)&nbsp;<br>})<br><br></span><span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">script</span>&gt;</span><br></code></span></section><p data-darkreader-inline-outline=""><span data-darkreader-inline-outline="">可以看到控制台出现警告</span></p><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" data-darkreader-inline-outline="" data-darkreader-inline-color=""><span data-tool="mdnice编辑器" data-darkreader-inline-outline="" data-darkreader-inline-boxshadow=""><span data-width="100%" data-darkreader-inline-outline="" data-darkreader-inline-bgcolor=""></span><code data-darkreader-inline-outline="" data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor="">[Vue&nbsp;warn]:&nbsp;Invalid&nbsp;watch&nbsp;source:&nbsp;&nbsp;18&nbsp;A&nbsp;watch&nbsp;source&nbsp;can&nbsp;only&nbsp;be&nbsp;a&nbsp;getter/effect&nbsp;function,&nbsp;a&nbsp;ref,&nbsp;a&nbsp;reactive&nbsp;object,&nbsp;or&nbsp;an&nbsp;array&nbsp;of&nbsp;these&nbsp;types.&nbsp;<br>&nbsp;&nbsp;at&nbsp;<span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">Index</span>&gt;</span>&nbsp;<br>&nbsp;&nbsp;at&nbsp;<span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">App</span>&gt;</span><br></code></span></section><p data-darkreader-inline-outline="">如果我们非要监听响应式对象中的某个属性，我们可以使用 getter 函数的形式,<span data-darkreader-inline-outline="">即将watch第一个参数修改成一个回调函数的形式</span></p><p data-darkreader-inline-outline="">正确写法：</p><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" data-darkreader-inline-outline="" data-darkreader-inline-color=""><span data-tool="mdnice编辑器" data-darkreader-inline-outline="" data-darkreader-inline-boxshadow=""><span data-width="100%" data-darkreader-inline-outline="" data-darkreader-inline-bgcolor=""></span><code data-darkreader-inline-outline="" data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor="">//&nbsp;其他不变<br>watch(()=&gt;info.age,&nbsp;(newV,&nbsp;oldV)&nbsp;=&gt;&nbsp;{<br>&nbsp;&nbsp;console.log(newV,&nbsp;oldV)&nbsp;//&nbsp;19&nbsp;18<br>}<br></code></span></section><section data-darkreader-inline-outline=""><br></section><ul data-darkreader-inline-outline=""><li data-darkreader-inline-outline=""><p data-darkreader-inline-outline=""><span data-darkreader-inline-outline="">5、监听reactive定义的 引用数据</span></p></li></ul><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" data-darkreader-inline-outline="" data-darkreader-inline-color=""><span data-tool="mdnice编辑器" data-darkreader-inline-outline="" data-darkreader-inline-boxshadow=""><span data-width="100%" data-darkreader-inline-outline="" data-darkreader-inline-bgcolor=""></span><code data-darkreader-inline-outline="" data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor=""><span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">script</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">setup</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">lang</span>=<span data-darkreader-inline-outline="" data-darkreader-inline-color="">"ts"</span>&gt;</span><span data-darkreader-inline-outline=""><br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">import</span>&nbsp;{&nbsp;reactive,&nbsp;watch&nbsp;}&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">from</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">"vue"</span>;<br><br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">let</span>&nbsp;info&nbsp;=&nbsp;reactive({<br>&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">name</span>:&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">'张麻子'</span>,<br>&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">age</span>:&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">18</span>,<br>&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">obj</span>:&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">str</span>:&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">'彼时彼刻，恰如此时此刻'</span><br>&nbsp;&nbsp;}<br>})<br><br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">//3s后改变s值</span><br>setTimeout(<span data-darkreader-inline-outline=""><span data-darkreader-inline-outline="">()</span>&nbsp;=&gt;</span>&nbsp;{<br>&nbsp;&nbsp;info.obj.str&nbsp;=&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">'to&nbsp;be&nbsp;or&nbsp;not&nbsp;to&nbsp;be'</span><br>},&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">3000</span>)<br><br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">//&nbsp;需要自己开启&nbsp;deep:true深度监听,不然不发触发&nbsp;watch&nbsp;的回调函数</span><br>watch(<span data-darkreader-inline-outline=""><span data-darkreader-inline-outline="">()</span>&nbsp;=&gt;</span>&nbsp;info.obj,&nbsp;(newV,&nbsp;oldV)&nbsp;=&gt;&nbsp;{<br>&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">console</span>.log(newV,&nbsp;oldV)<br>},&nbsp;{<br>&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">deep</span>:&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">true</span><br>})<br><br></span><span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">script</span>&gt;</span><br></code></span></section><h2 data-tool="mdnice编辑器" data-darkreader-inline-outline="" data-darkreader-inline-border-bottom=""><span data-darkreader-inline-outline="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor="" data-darkreader-inline-color=""><span data-darkreader-inline-outline="">WatchEffect</span></span></h2><p data-darkreader-inline-outline="">会立即执行传入的一个函数，同时响应式追踪其依赖，并在其依赖变更时重新运行该函数。（有点像计算属性）</p><p data-darkreader-inline-outline="">如果用到 a 就只会监听 a, 就是用到几个监听几个 而且是非惰性,会默认调用一次</p><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" data-darkreader-inline-outline="" data-darkreader-inline-color=""><span data-tool="mdnice编辑器" data-darkreader-inline-outline="" data-darkreader-inline-boxshadow=""><span data-width="100%" data-darkreader-inline-outline="" data-darkreader-inline-bgcolor=""></span><code data-darkreader-inline-outline="" data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor=""><span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">script</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">setup</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">lang</span>=<span data-darkreader-inline-outline="" data-darkreader-inline-color="">"ts"</span>&gt;</span><span data-darkreader-inline-outline=""><br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">import</span>&nbsp;{&nbsp;ref,&nbsp;watchEffect&nbsp;}&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">from</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">"vue"</span>;<br><br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">let</span>&nbsp;num&nbsp;=&nbsp;ref(<span data-darkreader-inline-outline="" data-darkreader-inline-color="">0</span>)<br><br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">//3s后改变值</span><br>setTimeout(<span data-darkreader-inline-outline=""><span data-darkreader-inline-outline="">()</span>&nbsp;=&gt;</span>&nbsp;{<br>&nbsp;&nbsp;num.value++<br>},&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">3000</span>)<br><br>watchEffect(<span data-darkreader-inline-outline=""><span data-darkreader-inline-outline="">()</span>&nbsp;=&gt;</span>&nbsp;{<br>&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">console</span>.log(<span data-darkreader-inline-outline="" data-darkreader-inline-color="">'num 值改变：'</span>,&nbsp;num.value)<br>})<br><br></span><span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">script</span>&gt;</span></code></span></section><p data-darkreader-inline-outline="">可以在控制台上看到，第一次进入页面时，打印出<code data-darkreader-inline-outline="">num 值改变：0</code>,三秒后，再次打印<code data-darkreader-inline-outline="">num 值改变：1</code></p><ul data-darkreader-inline-outline=""><li data-darkreader-inline-outline=""><p data-darkreader-inline-outline=""><span data-darkreader-inline-outline="">停止监听</span></p></li></ul><p data-darkreader-inline-outline="">当 watchEffect 在组件的 setup() 函数或生命周期钩子被调用时，侦听器会被链接到该组件的生命周期，并在组件卸载时自动停止。</p><p data-darkreader-inline-outline="">但是我们采用异步的方式创建了一个监听器，这个时候监听器没有与当前组件绑定，所以即使组件销毁了，监听器依然存在。</p><section data-darkreader-inline-outline=""><span data-darkreader-inline-outline="">这个时候我们可以显式调用停止监听</span></section><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" data-darkreader-inline-outline="" data-darkreader-inline-color=""><span data-tool="mdnice编辑器" data-darkreader-inline-outline="" data-darkreader-inline-boxshadow=""><span data-width="100%" data-darkreader-inline-outline="" data-darkreader-inline-bgcolor=""></span><code data-darkreader-inline-outline="" data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor=""><span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">script</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">setup</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">lang</span>=<span data-darkreader-inline-outline="" data-darkreader-inline-color="">"ts"</span>&gt;</span><span data-darkreader-inline-outline=""><br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">import</span>&nbsp;{&nbsp;watchEffect&nbsp;}&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">from</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">'vue'</span><br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">//&nbsp;它会自动停止</span><br>watchEffect(<span data-darkreader-inline-outline=""><span data-darkreader-inline-outline="">()</span>&nbsp;=&gt;</span>&nbsp;{})<br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">// ...这个则不会！</span><br>setTimeout(<span data-darkreader-inline-outline=""><span data-darkreader-inline-outline="">()</span>&nbsp;=&gt;</span>&nbsp;{<br>&nbsp;&nbsp;watchEffect(<span data-darkreader-inline-outline=""><span data-darkreader-inline-outline="">()</span>&nbsp;=&gt;</span>&nbsp;{})<br>},&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">100</span>)<br><br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">const</span>&nbsp;stop&nbsp;=&nbsp;watchEffect(<span data-darkreader-inline-outline=""><span data-darkreader-inline-outline="">()</span>&nbsp;=&gt;</span>&nbsp;{<br>&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">/*&nbsp;...&nbsp;*/</span><br>})<br><br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">//&nbsp;显式调用</span><br>stop()<br></span><span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">script</span>&gt;</span><br></code></span></section><ul data-darkreader-inline-outline=""><li data-darkreader-inline-outline=""><p data-darkreader-inline-outline=""><span data-darkreader-inline-outline="">清除副作用（onInvalidate）</span></p></li></ul><p data-darkreader-inline-outline="">watchEffect 的第一个参数——effect函数——可以接收一个参数：叫onInvalidate，也是一个函数，用于清除 effect 产生的副作用</p><section data-darkreader-inline-outline=""><span data-darkreader-inline-outline="">就是在触发监听之前会调用一个函数可以处理你的逻辑，例如防抖</span></section><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" data-darkreader-inline-outline="" data-darkreader-inline-color=""><span data-tool="mdnice编辑器" data-darkreader-inline-outline="" data-darkreader-inline-boxshadow=""><span data-width="100%" data-darkreader-inline-outline="" data-darkreader-inline-bgcolor=""></span><code data-darkreader-inline-outline="" data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor=""><span data-darkreader-inline-outline="" data-darkreader-inline-color="">import</span>&nbsp;{&nbsp;ref,&nbsp;watchEffect&nbsp;}&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">from</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">"vue"</span>;<br><br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">let</span>&nbsp;num&nbsp;=&nbsp;ref(<span data-darkreader-inline-outline="" data-darkreader-inline-color="">0</span>)<br><br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">//3s后改变值</span><br>setTimeout(<span data-darkreader-inline-outline=""><span data-darkreader-inline-outline="">()</span>&nbsp;=&gt;</span>&nbsp;{<br>&nbsp;&nbsp;num.value++<br>},&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">3000</span>)<br><br>watchEffect(<span data-darkreader-inline-outline="">(<span data-darkreader-inline-outline="">onInvalidate</span>)&nbsp;=&gt;</span>&nbsp;{<br>&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">console</span>.log(num.value)<br>&nbsp;&nbsp;onInvalidate(<span data-darkreader-inline-outline=""><span data-darkreader-inline-outline="">()</span>&nbsp;=&gt;</span>&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">console</span>.log(<span data-darkreader-inline-outline="" data-darkreader-inline-color="">'执行'</span>);<br>&nbsp;&nbsp;});<br>})<br></code></span></section><p data-darkreader-inline-outline="">控制台依次输出：0 =&gt; 执行 =&gt; 1</p><ul data-darkreader-inline-outline=""><li data-darkreader-inline-outline=""><p data-darkreader-inline-outline=""><span data-darkreader-inline-outline="">配置选项</span></p></li></ul><p data-darkreader-inline-outline="">watchEffect的第二个参数，用来定义副作用刷新时机，可以作为一个调试器来使用</p><p data-darkreader-inline-outline="">flush （更新时机）：</p><ul data-darkreader-inline-outline=""><li data-darkreader-inline-outline=""><p data-darkreader-inline-outline="">1、pre：组件更新前执行</p></li><li data-darkreader-inline-outline=""><p data-darkreader-inline-outline="">2、sync：强制效果始终同步触发</p></li><li data-darkreader-inline-outline=""><p data-darkreader-inline-outline="">3、post：组件更新后执行</p></li></ul><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" data-darkreader-inline-outline="" data-darkreader-inline-color=""><span data-tool="mdnice编辑器" data-darkreader-inline-outline="" data-darkreader-inline-boxshadow=""><span data-width="100%" data-darkreader-inline-outline="" data-darkreader-inline-bgcolor=""></span><code data-darkreader-inline-outline="" data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor=""><span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">script</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">setup</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">lang</span>=<span data-darkreader-inline-outline="" data-darkreader-inline-color="">"ts"</span>&gt;</span><span data-darkreader-inline-outline=""><br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">import</span>&nbsp;{&nbsp;ref,&nbsp;watchEffect&nbsp;}&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">from</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">"vue"</span>;<br><br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">let</span>&nbsp;num&nbsp;=&nbsp;ref(<span data-darkreader-inline-outline="" data-darkreader-inline-color="">0</span>)<br><br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">//3s后改变值</span><br>setTimeout(<span data-darkreader-inline-outline=""><span data-darkreader-inline-outline="">()</span>&nbsp;=&gt;</span>&nbsp;{<br>&nbsp;&nbsp;num.value++<br>},&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">3000</span>)<br><br>watchEffect(<span data-darkreader-inline-outline="">(<span data-darkreader-inline-outline="">onInvalidate</span>)&nbsp;=&gt;</span>&nbsp;{<br>&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">console</span>.log(num.value)<br>&nbsp;&nbsp;onInvalidate(<span data-darkreader-inline-outline=""><span data-darkreader-inline-outline="">()</span>&nbsp;=&gt;</span>&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">console</span>.log(<span data-darkreader-inline-outline="" data-darkreader-inline-color="">'执行'</span>);<br>&nbsp;&nbsp;});<br>},&nbsp;{<br>&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">flush</span>:&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">"post"</span>,&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">//此时这个函数会在组件更新之后去执行</span><br>&nbsp;&nbsp;onTrigger(e)&nbsp;{&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">//作为一个调试工具，可在开发中方便调试</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">console</span>.log(<span data-darkreader-inline-outline="" data-darkreader-inline-color="">'触发'</span>,&nbsp;e);<br>&nbsp;&nbsp;},<br>})<br></span><span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">script</span>&gt;</span><br></code></span></section><h2 data-tool="mdnice编辑器" data-darkreader-inline-outline="" data-darkreader-inline-border-bottom=""><span data-darkreader-inline-outline="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor="" data-darkreader-inline-color=""><span data-darkreader-inline-outline="">生命周期</span></span></h2><section data-darkreader-inline-outline=""><span data-darkreader-inline-outline="">和 vue2 相比的话，基本上就是将 Vue2 中的beforeDestroy名称变更成beforeUnmount; destroyed 表更为 unmounted；然后用setup代替了两个钩子函数 beforeCreate 和 created；<span data-darkreader-inline-outline="">新增了两个开发环境用于调试的钩子</span></span></section><p data-darkreader-inline-outline=""><img data-galleryid="" data-ratio="0.8120300751879699" data-type="png" data-w="1064" data-src="https://mmbiz.qpic.cn/mmbiz_png/ic5A4V8PX4PniaElFR8nqkPVh6iajiaF7ytvX2Y3FwT5lLFV1ZYzKn73CABJk7ib7QQicHiamOMdT8jog7mu4yj30xh6A/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" data-darkreader-inline-outline="" data-original-style="outline: 0px; box-sizing: border-box !important; overflow-wrap: break-word !important; width: 677px !important; visibility: visible !important; --darkreader-inline-outline: initial;" data-index="6" src="data:image/svg+xml,%3C%3Fxml version='1.0' encoding='UTF-8'%3F%3E%3Csvg width='1px' height='1px' viewBox='0 0 1 1' version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3E%3Ctitle%3E%3C/title%3E%3Cg stroke='none' stroke-width='1' fill='none' fill-rule='evenodd' fill-opacity='0'%3E%3Cg transform='translate(-249.000000, -126.000000)' fill='%23FFFFFF'%3E%3Crect x='249' y='126' width='1' height='1'%3E%3C/rect%3E%3C/g%3E%3C/g%3E%3C/svg%3E" _width="677px" crossorigin="anonymous" alt="Image"></p><h2 data-tool="mdnice编辑器" data-darkreader-inline-outline="" data-darkreader-inline-border-bottom=""><span data-darkreader-inline-outline="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor="" data-darkreader-inline-color=""><span data-darkreader-inline-outline="">父子组件传参</span></span></h2><h3 data-id="heading-13" data-darkreader-inline-outline="">defineProps</h3><p data-darkreader-inline-outline="">父组件传参</p><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" data-darkreader-inline-outline="" data-darkreader-inline-color=""><span data-tool="mdnice编辑器" data-darkreader-inline-outline="" data-darkreader-inline-boxshadow=""><span data-width="100%" data-darkreader-inline-outline="" data-darkreader-inline-bgcolor=""></span><code data-darkreader-inline-outline="" data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor=""><span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">template</span>&gt;</span><br>&nbsp;&nbsp;<span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">Children</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">:msg</span>=<span data-darkreader-inline-outline="" data-darkreader-inline-color="">"msg"</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">:list</span>=<span data-darkreader-inline-outline="" data-darkreader-inline-color="">"list"</span>&gt;</span><span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">Children</span>&gt;</span><br><span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">template</span>&gt;</span><br><br><span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">script</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">setup</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">lang</span>=<span data-darkreader-inline-outline="" data-darkreader-inline-color="">"ts"</span>&gt;</span><span data-darkreader-inline-outline=""><br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">import</span>&nbsp;{&nbsp;ref,&nbsp;reactive&nbsp;}&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">from</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">'vue'</span><br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">import</span>&nbsp;Children&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">from</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">'./Children.vue'</span><br><br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">const</span>&nbsp;msg&nbsp;=&nbsp;ref(<span data-darkreader-inline-outline="" data-darkreader-inline-color="">'hello&nbsp;啊，树哥'</span>)<br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">const</span>&nbsp;list&nbsp;=&nbsp;reactive&lt;number[]&gt;([<span data-darkreader-inline-outline="" data-darkreader-inline-color="">1</span>,&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">2</span>,&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">3</span>])<br></span><span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">script</span>&gt;</span><br></code></span></section><blockquote data-darkreader-inline-outline="" data-darkreader-inline-border-left="" data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor=""><p data-darkreader-inline-outline="">t setup 中，引入的组件会自动注册，所以可以直接使用，无需再通过components进行注册</p></blockquote><p data-darkreader-inline-outline="">子<span data-darkreader-inline-outline="">组件接受值</span></p><section data-darkreader-inline-outline=""><span data-darkreader-inline-outline="">defineProps 来接收父组件传递的值，&nbsp;</span><span data-darkreader-inline-outline="">defineProps是无须引入的直接使用即可</span></section><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" data-darkreader-inline-outline="" data-darkreader-inline-color=""><span data-tool="mdnice编辑器" data-darkreader-inline-outline="" data-darkreader-inline-boxshadow=""><span data-width="100%" data-darkreader-inline-outline="" data-darkreader-inline-bgcolor=""></span><code data-darkreader-inline-outline="" data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor=""><span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">template</span>&gt;</span><br>&nbsp;&nbsp;<span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">div</span>&gt;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">p</span>&gt;</span>msg：{{msg}}<span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">p</span>&gt;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">p</span>&gt;</span>list：{{list}}<span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">p</span>&gt;</span><br>&nbsp;&nbsp;<span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">div</span>&gt;</span><br><span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">template</span>&gt;</span><br><br><span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">script</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">setup</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">lang</span>=<span data-darkreader-inline-outline="" data-darkreader-inline-color="">"ts"</span>&gt;</span><span data-darkreader-inline-outline=""><br>defineProps<span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">{</span><br>&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">msg:</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">string</span>,<br>&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">list:</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">number</span>[]<br>}&gt;</span>()<br></span><span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">script</span>&gt;</span><br></code></span></section><section data-darkreader-inline-outline=""><span data-darkreader-inline-outline="">使用 withDefaults 定义默认值</span></section><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" data-darkreader-inline-outline="" data-darkreader-inline-color=""><span data-tool="mdnice编辑器" data-darkreader-inline-outline="" data-darkreader-inline-boxshadow=""><span data-width="100%" data-darkreader-inline-outline="" data-darkreader-inline-bgcolor=""></span><code data-darkreader-inline-outline="" data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor=""><span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">template</span>&gt;</span><br>&nbsp;&nbsp;<span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">div</span>&gt;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">p</span>&gt;</span>msg：{{msg}}<span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">p</span>&gt;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">p</span>&gt;</span>list：{{list}}<span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">p</span>&gt;</span><br>&nbsp;&nbsp;<span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">div</span>&gt;</span><br><span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">template</span>&gt;</span><br><br><span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">script</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">setup</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">lang</span>=<span data-darkreader-inline-outline="" data-darkreader-inline-color="">"ts"</span>&gt;</span><span data-darkreader-inline-outline=""><br>type&nbsp;Props&nbsp;=&nbsp;{<br>&nbsp;&nbsp;msg?:&nbsp;string,<br>&nbsp;&nbsp;list?:&nbsp;number[]<br>}<br><br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">//&nbsp;withDefaults&nbsp;的第二个参数便是默认参数设置，会被编译为运行时&nbsp;props&nbsp;的&nbsp;default&nbsp;选项</span><br>withDefaults(defineProps&lt;Props&gt;(),&nbsp;{<br>&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">msg</span>:&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">'张麻子'</span>,<br>&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">list</span>:&nbsp;<span data-darkreader-inline-outline=""><span data-darkreader-inline-outline="">()</span>&nbsp;=&gt;</span>&nbsp;[<span data-darkreader-inline-outline="" data-darkreader-inline-color="">4</span>,&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">5</span>,&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">6</span>]<br>})<br></span><span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">script</span>&gt;</span><br></code></span></section><p data-darkreader-inline-outline="">子组件向父组件抛出事件</p><h3 data-id="heading-14" data-darkreader-inline-outline="">defineEmits</h3><p data-darkreader-inline-outline="">子组件派发事件</p><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" data-darkreader-inline-outline="" data-darkreader-inline-color=""><span data-tool="mdnice编辑器" data-darkreader-inline-outline="" data-darkreader-inline-boxshadow=""><span data-width="100%" data-darkreader-inline-outline="" data-darkreader-inline-bgcolor=""></span><code data-darkreader-inline-outline="" data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor=""><span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">template</span>&gt;</span><br>&nbsp;&nbsp;<span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">div</span>&gt;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">p</span>&gt;</span>msg：{{msg}}<span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">p</span>&gt;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">p</span>&gt;</span>list：{{list}}<span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">p</span>&gt;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">button</span>&nbsp;@<span data-darkreader-inline-outline="" data-darkreader-inline-color="">click</span>=<span data-darkreader-inline-outline="" data-darkreader-inline-color="">"onChangeMsg"</span>&gt;</span>改变msg<span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">button</span>&gt;</span><br>&nbsp;&nbsp;<span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">div</span>&gt;</span><br><span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">template</span>&gt;</span><br><br><span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">script</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">setup</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">lang</span>=<span data-darkreader-inline-outline="" data-darkreader-inline-color="">"ts"</span>&gt;</span><span data-darkreader-inline-outline=""><br>type&nbsp;Props&nbsp;=&nbsp;{<br>&nbsp;&nbsp;msg?:&nbsp;string,<br>&nbsp;&nbsp;list?:&nbsp;number[]<br>}<br><br>withDefaults(defineProps&lt;Props&gt;(),&nbsp;{<br>&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">msg</span>:&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">'张麻子'</span>,<br>&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">list</span>:&nbsp;<span data-darkreader-inline-outline=""><span data-darkreader-inline-outline="">()</span>&nbsp;=&gt;</span>&nbsp;[<span data-darkreader-inline-outline="" data-darkreader-inline-color="">4</span>,&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">5</span>,&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">6</span>]<br>})<br><br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">const</span>&nbsp;emits&nbsp;=&nbsp;defineEmits([<span data-darkreader-inline-outline="" data-darkreader-inline-color="">'changeMsg'</span>])<br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">const</span>&nbsp;onChangeMsg&nbsp;=&nbsp;<span data-darkreader-inline-outline=""><span data-darkreader-inline-outline="">()</span>&nbsp;=&gt;</span>&nbsp;{<br>emits(<span data-darkreader-inline-outline="" data-darkreader-inline-color="">'changeMsg'</span>,<span data-darkreader-inline-outline="" data-darkreader-inline-color="">'黄四郎'</span>)<br>}<br></span><span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">script</span>&gt;</span><br></code></span></section><p data-darkreader-inline-outline="">子组件绑定了一个click 事件 然后通过defineEmits 注册了一个自定义事件,点击按钮的时候，触发 emit 调用我们注册的事件，传递参数</p><p data-darkreader-inline-outline="">父组件接收</p><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" data-darkreader-inline-outline="" data-darkreader-inline-color=""><span data-tool="mdnice编辑器" data-darkreader-inline-outline="" data-darkreader-inline-boxshadow=""><span data-width="100%" data-darkreader-inline-outline="" data-darkreader-inline-bgcolor=""></span><code data-darkreader-inline-outline="" data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor=""><span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">template</span>&gt;</span><br>&nbsp;&nbsp;<span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">Children</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">:msg</span>=<span data-darkreader-inline-outline="" data-darkreader-inline-color="">"msg"</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">:list</span>=<span data-darkreader-inline-outline="" data-darkreader-inline-color="">"list"</span>&nbsp;@<span data-darkreader-inline-outline="" data-darkreader-inline-color="">changeMsg</span>=<span data-darkreader-inline-outline="" data-darkreader-inline-color="">"changeMsg"</span>&gt;</span><span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">Children</span>&gt;</span><br><span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">template</span>&gt;</span><br><br><span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">script</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">setup</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">lang</span>=<span data-darkreader-inline-outline="" data-darkreader-inline-color="">"ts"</span>&gt;</span><span data-darkreader-inline-outline=""><br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">import</span>&nbsp;{&nbsp;ref,&nbsp;reactive&nbsp;}&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">from</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">'vue'</span><br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">import</span>&nbsp;Children&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">from</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">'./Children.vue'</span><br><br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">const</span>&nbsp;msg&nbsp;=&nbsp;ref(<span data-darkreader-inline-outline="" data-darkreader-inline-color="">'hello&nbsp;啊，树哥'</span>)<br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">const</span>&nbsp;list&nbsp;=&nbsp;reactive&lt;number[]&gt;([<span data-darkreader-inline-outline="" data-darkreader-inline-color="">1</span>,&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">2</span>,&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">3</span>])<br><br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">const</span>&nbsp;changeMsg&nbsp;=&nbsp;<span data-darkreader-inline-outline="">(<span data-darkreader-inline-outline="">v:&nbsp;string</span>)&nbsp;=&gt;</span>&nbsp;{<br>&nbsp;&nbsp;msg.value&nbsp;=&nbsp;v<br>}<br></span><span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">script</span>&gt;</span><br></code></span></section><h3 data-id="heading-15" data-darkreader-inline-outline="">defineExpose 获取子组件的实例和内部属性</h3><p data-darkreader-inline-outline="">在 script-setup 模式下，所有数据只是默认 return 给 template 使用，不会暴露到组件外，所以父组件是无法直接通过挂载 ref 变量获取子组件的数据。</p><p data-darkreader-inline-outline="">如果要调用子组件的数据，需要先在子组件显示的暴露出来，才能够正确的拿到，这个操作，就是由 defineExpose 来完成。</p><p data-darkreader-inline-outline="">子组件</p><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" data-darkreader-inline-outline="" data-darkreader-inline-color=""><span data-tool="mdnice编辑器" data-darkreader-inline-outline="" data-darkreader-inline-boxshadow=""><span data-width="100%" data-darkreader-inline-outline="" data-darkreader-inline-bgcolor=""></span><code data-darkreader-inline-outline="" data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor=""><span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">template</span>&gt;</span><br>&nbsp;&nbsp;<span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">p</span>&gt;</span>{{name}}<span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">p</span>&gt;</span><br><span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">template</span>&gt;</span><br><br><span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">script</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">lang</span>=<span data-darkreader-inline-outline="" data-darkreader-inline-color="">"ts"</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">setup</span>&gt;</span><span data-darkreader-inline-outline=""><br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">import</span>&nbsp;{&nbsp;ref&nbsp;}&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">from</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">'vue'</span><br><br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">const</span>&nbsp;name&nbsp;=&nbsp;ref(<span data-darkreader-inline-outline="" data-darkreader-inline-color="">'张麻子'</span>)<br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">const</span>&nbsp;changeName&nbsp;=&nbsp;<span data-darkreader-inline-outline=""><span data-darkreader-inline-outline="">()</span>&nbsp;=&gt;</span>&nbsp;{<br>&nbsp;&nbsp;name.value&nbsp;=&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">'县长'</span><br>}<br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">//&nbsp;将方法、变量暴露给父组件使用，父组件才可通过&nbsp;ref&nbsp;API拿到子组件暴露的数据</span><br>defineExpose({<br>&nbsp;&nbsp;name,<br>&nbsp;&nbsp;changeName<br>})<br></span><span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">script</span>&gt;</span><br></code></span></section><section data-darkreader-inline-outline=""><span data-darkreader-inline-outline="">父组件</span></section><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" data-darkreader-inline-outline="" data-darkreader-inline-color=""><span data-tool="mdnice编辑器" data-darkreader-inline-outline="" data-darkreader-inline-boxshadow=""><span data-width="100%" data-darkreader-inline-outline="" data-darkreader-inline-bgcolor=""></span><code data-darkreader-inline-outline="" data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor=""><span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">template</span>&gt;</span><br>&nbsp;&nbsp;<span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">div</span>&gt;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">child</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">ref</span>=<span data-darkreader-inline-outline="" data-darkreader-inline-color="">'childRef'</span>&nbsp;/&gt;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">button</span>&nbsp;@<span data-darkreader-inline-outline="" data-darkreader-inline-color="">click</span>=<span data-darkreader-inline-outline="" data-darkreader-inline-color="">"getName"</span>&gt;</span>获取子组件中的数据<span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">button</span>&gt;</span><br>&nbsp;&nbsp;<span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">div</span>&gt;</span><br><span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">template</span>&gt;</span><br><br><span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">script</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">lang</span>=<span data-darkreader-inline-outline="" data-darkreader-inline-color="">"ts"</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">setup</span>&gt;</span><span data-darkreader-inline-outline=""><br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">import</span>&nbsp;{&nbsp;ref&nbsp;}&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">from</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">'vue'</span><br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">import</span>&nbsp;child&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">from</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">'./Child.vue'</span><br><br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">//&nbsp;子组件ref（TypeScript语法）</span><br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">const</span>&nbsp;childRef&nbsp;=&nbsp;ref&lt;InstanceType&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">typeof</span>&nbsp;child&gt;&gt;()<br><br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">const</span>&nbsp;getName&nbsp;=&nbsp;<span data-darkreader-inline-outline=""><span data-darkreader-inline-outline="">()</span>&nbsp;=&gt;</span>&nbsp;{<br>&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">//&nbsp;获取子组件name</span><br>&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">console</span>.log(childRef.value!.name)<br>&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">//&nbsp;执行子组件方法</span><br>&nbsp;&nbsp;childRef.value?.changeName()<br>&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">//&nbsp;获取修改后的name</span><br>&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">console</span>.log(childRef.value!.name)<br>}<br></span><span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">script</span>&gt;</span><br></code></span></section><section data-darkreader-inline-outline=""><span data-darkreader-inline-outline="">注意：defineProps 、defineEmits 、 defineExpose 和 withDefaults 这四个宏函数只能在&nbsp;</span><code data-darkreader-inline-outline="" data-darkreader-inline-bgcolor="" data-darkreader-inline-color="">&lt;script setup&gt;</code><span data-darkreader-inline-outline="">&nbsp;中使用。他们不需要导入，会随着</span><code data-darkreader-inline-outline="" data-darkreader-inline-bgcolor="" data-darkreader-inline-color="">&lt;script setup&gt;</code><span data-darkreader-inline-outline="">的处理过程中一起被编译。</span></section><h2 data-tool="mdnice编辑器" data-darkreader-inline-outline="" data-darkreader-inline-border-bottom=""><span data-darkreader-inline-outline="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor="" data-darkreader-inline-color=""><span data-darkreader-inline-outline="">插槽</span></span></h2><p data-darkreader-inline-outline="">在 Vue2 的中一般中具名插槽和作用域插槽分别使用slot和slot-scope来实现，如：</p><p data-darkreader-inline-outline="">父组件</p><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" data-darkreader-inline-outline="" data-darkreader-inline-color=""><span data-tool="mdnice编辑器" data-darkreader-inline-outline="" data-darkreader-inline-boxshadow=""><span data-width="100%" data-darkreader-inline-outline="" data-darkreader-inline-bgcolor=""></span><code data-darkreader-inline-outline="" data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor=""><span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">template</span>&gt;</span><br>&nbsp;&nbsp;<span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">div</span>&gt;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">p</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">style</span>=<span data-darkreader-inline-outline="" data-darkreader-inline-color="">"color:red"</span>&gt;</span>父组件<span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">p</span>&gt;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">Child</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">ref</span>=<span data-darkreader-inline-outline="" data-darkreader-inline-color="">'childRef'</span>&gt;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">template</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">slot</span>=<span data-darkreader-inline-outline="" data-darkreader-inline-color="">"content"</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">slot-scope</span>=<span data-darkreader-inline-outline="" data-darkreader-inline-color="">"{&nbsp;msg&nbsp;}"</span>&gt;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">div</span>&gt;</span>{{&nbsp;msg&nbsp;}}<span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">div</span>&gt;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">template</span>&gt;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">Child</span>&gt;</span><br>&nbsp;&nbsp;<span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">div</span>&gt;</span><br><span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">template</span>&gt;</span><br><br><span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">script</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">lang</span>=<span data-darkreader-inline-outline="" data-darkreader-inline-color="">"ts"</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">setup</span>&gt;</span><span data-darkreader-inline-outline=""><br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">import</span>&nbsp;Child&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">from</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">'./Child.vue'</span><br></span><span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">script</span>&gt;</span><br></code></span></section><section data-darkreader-inline-outline=""><br></section><section data-darkreader-inline-outline=""><span data-darkreader-inline-outline="">子组件</span></section><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" data-darkreader-inline-outline="" data-darkreader-inline-color=""><span data-tool="mdnice编辑器" data-darkreader-inline-outline="" data-darkreader-inline-boxshadow=""><span data-width="100%" data-darkreader-inline-outline="" data-darkreader-inline-bgcolor=""></span><code data-darkreader-inline-outline="" data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor=""><span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">template</span>&gt;</span><br>&nbsp;&nbsp;<span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">div</span>&gt;</span>child<span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">div</span>&gt;</span><br>&nbsp;&nbsp;<span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">slot</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">name</span>=<span data-darkreader-inline-outline="" data-darkreader-inline-color="">"content"</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">msg</span>=<span data-darkreader-inline-outline="" data-darkreader-inline-color="">"hello&nbsp;啊，树哥!"</span>&gt;</span><span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">slot</span>&gt;</span><br><span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">template</span>&gt;</span><br></code></span></section><p data-darkreader-inline-outline="">在 Vue3 中将slot和slot-scope进行了合并统一使用，使用 v-slot，&nbsp;<code data-darkreader-inline-outline="">v-slot:slotName</code>&nbsp;简写&nbsp;<code data-darkreader-inline-outline="">#slotName</code></p><p data-darkreader-inline-outline="">父组件</p><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" data-darkreader-inline-outline="" data-darkreader-inline-color=""><span data-tool="mdnice编辑器" data-darkreader-inline-outline="" data-darkreader-inline-boxshadow=""><span data-width="100%" data-darkreader-inline-outline="" data-darkreader-inline-bgcolor=""></span><code data-darkreader-inline-outline="" data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor=""><span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">template</span>&gt;</span><br>&nbsp;&nbsp;<span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">div</span>&gt;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">p</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">style</span>=<span data-darkreader-inline-outline="" data-darkreader-inline-color="">"color:red"</span>&gt;</span>父组件<span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">p</span>&gt;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">Child</span>&gt;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">template</span>&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">v-slot:content</span>=<span data-darkreader-inline-outline="" data-darkreader-inline-color="">"{&nbsp;msg&nbsp;}"</span>&gt;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">div</span>&gt;</span>{{&nbsp;msg&nbsp;}}<span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">div</span>&gt;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">template</span>&gt;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">Child</span>&gt;</span><br>&nbsp;&nbsp;<span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">div</span>&gt;</span><br><span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">template</span>&gt;</span><br><br><span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">script</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">lang</span>=<span data-darkreader-inline-outline="" data-darkreader-inline-color="">"ts"</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">setup</span>&gt;</span><span data-darkreader-inline-outline=""><br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">import</span>&nbsp;Child&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">from</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">'./Child.vue'</span><br></span><span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">script</span>&gt;</span><br><br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">&lt;!--&nbsp;简写&nbsp;--&gt;</span><br><span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">Child</span>&gt;</span><br>&nbsp;&nbsp;<span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">template</span>&nbsp;#<span data-darkreader-inline-outline="" data-darkreader-inline-color="">content</span>=<span data-darkreader-inline-outline="" data-darkreader-inline-color="">"{&nbsp;msg&nbsp;}"</span>&gt;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">div</span>&gt;</span>{{&nbsp;msg&nbsp;}}<span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">div</span>&gt;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">template</span>&gt;</span><br><span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">Child</span>&gt;</span><br></code></span></section><section data-darkreader-inline-outline=""><span data-darkreader-inline-outline="">实际上,v-slot 在 Vue2.6+ 的版本就可以使用。</span></section><h2 data-tool="mdnice编辑器" data-darkreader-inline-outline="" data-darkreader-inline-border-bottom=""><span data-darkreader-inline-outline="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor="" data-darkreader-inline-color=""><span data-darkreader-inline-outline="">异步组件</span></span></h2><section data-darkreader-inline-outline=""><span data-darkreader-inline-outline="">通过 defineAsyncComponent 异步加载</span></section><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" data-darkreader-inline-outline="" data-darkreader-inline-color=""><span data-tool="mdnice编辑器" data-darkreader-inline-outline="" data-darkreader-inline-boxshadow=""><span data-width="100%" data-darkreader-inline-outline="" data-darkreader-inline-bgcolor=""></span><code data-darkreader-inline-outline="" data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor=""><span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">template</span>&gt;</span><br>&nbsp;&nbsp;<span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">Children</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">:msg</span>=<span data-darkreader-inline-outline="" data-darkreader-inline-color="">"msg"</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">:list</span>=<span data-darkreader-inline-outline="" data-darkreader-inline-color="">"list"</span>&nbsp;@<span data-darkreader-inline-outline="" data-darkreader-inline-color="">changeMsg</span>=<span data-darkreader-inline-outline="" data-darkreader-inline-color="">"changeMsg"</span>&gt;</span><span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">Children</span>&gt;</span><br><span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">template</span>&gt;</span><br><br><span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">script</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">setup</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">lang</span>=<span data-darkreader-inline-outline="" data-darkreader-inline-color="">"ts"</span>&gt;</span><span data-darkreader-inline-outline=""><br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">import</span>&nbsp;{&nbsp;ref,&nbsp;reactive,defineAsyncComponent&nbsp;}&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">from</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">'vue'</span><br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">//&nbsp;import&nbsp;Children&nbsp;from&nbsp;'./Children.vue'</span><br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">const</span>&nbsp;Children&nbsp;=&nbsp;defineAsyncComponent(<span data-darkreader-inline-outline=""><span data-darkreader-inline-outline="">()</span>&nbsp;=&gt;</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">import</span>(<span data-darkreader-inline-outline="" data-darkreader-inline-color="">'./Children.vue'</span>))<br></span><span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">script</span>&gt;</span><br></code></span></section><h2 data-tool="mdnice编辑器" data-darkreader-inline-outline="" data-darkreader-inline-border-bottom=""><span data-darkreader-inline-outline="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor="" data-darkreader-inline-color=""><span data-darkreader-inline-outline="">Suspense</span></span></h2><section data-darkreader-inline-outline=""><span data-darkreader-inline-outline="">Suspense 允许应用程序在等待异步组件时渲染一些其它内容,在 Vue2 中，必须使用条件判断(例如 v-if、 v-else等)来检查数据是否已加载并显示一些其它内容；<span data-darkreader-inline-outline="">但是，在 Vue3 新增了 Suspense 了，就不必跟踪何时加载数据并呈现相应的内容。</span></span></section><p data-darkreader-inline-outline="">他是一个带插槽的组件，只是它的插槽指定了default 和 fallback 两种状态。</p><p data-darkreader-inline-outline="">Suspense 使用：</p><ul data-darkreader-inline-outline=""><li data-darkreader-inline-outline=""><p data-darkreader-inline-outline="">1、使用&nbsp;<code data-darkreader-inline-outline="">&lt;Suspense&gt;&lt;/Suspense&gt;</code>&nbsp;包裹所有异步组件相关代码</p></li><li data-darkreader-inline-outline=""><p data-darkreader-inline-outline="">2、<code data-darkreader-inline-outline="">&lt;template v-slot:default&gt;&lt;/template&gt;</code>&nbsp;插槽包裹异步组件</p></li><li data-darkreader-inline-outline=""><p data-darkreader-inline-outline="">3、<code data-darkreader-inline-outline="">&lt;template v-slot:fallback&gt;&lt;/template&gt;</code>&nbsp;插槽包裹渲染异步组件渲染之前的内容</p></li></ul><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" data-darkreader-inline-outline="" data-darkreader-inline-color=""><span data-tool="mdnice编辑器" data-darkreader-inline-outline="" data-darkreader-inline-boxshadow=""><span data-width="100%" data-darkreader-inline-outline="" data-darkreader-inline-bgcolor=""></span><code data-darkreader-inline-outline="" data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor=""><span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">template</span>&gt;</span><br>&nbsp;&nbsp;<span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">Suspense</span>&gt;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">template</span>&nbsp;#<span data-darkreader-inline-outline="" data-darkreader-inline-color="">default</span>&gt;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">&lt;!--&nbsp;异步组件-默认渲染的页面&nbsp;--&gt;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">Children</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">:msg</span>=<span data-darkreader-inline-outline="" data-darkreader-inline-color="">"msg"</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">:list</span>=<span data-darkreader-inline-outline="" data-darkreader-inline-color="">"list"</span>&nbsp;@<span data-darkreader-inline-outline="" data-darkreader-inline-color="">changeMsg</span>=<span data-darkreader-inline-outline="" data-darkreader-inline-color="">"changeMsg"</span>&gt;</span><span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">Children</span>&gt;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">template</span>&gt;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">template</span>&nbsp;#<span data-darkreader-inline-outline="" data-darkreader-inline-color="">fallback</span>&gt;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">&lt;!--&nbsp;页面还没加载出来展示的页面&nbsp;--&gt;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">div</span>&gt;</span>loading...<span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">div</span>&gt;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">template</span>&gt;</span><br>&nbsp;&nbsp;<span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">Suspense</span>&gt;</span><br><span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">template</span>&gt;</span><br><br><span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">script</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">setup</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">lang</span>=<span data-darkreader-inline-outline="" data-darkreader-inline-color="">"ts"</span>&gt;</span><span data-darkreader-inline-outline=""><br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">import</span>&nbsp;{&nbsp;ref,&nbsp;reactive,&nbsp;defineAsyncComponent&nbsp;}&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">from</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">'vue'</span><br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">const</span>&nbsp;Children&nbsp;=&nbsp;defineAsyncComponent(<span data-darkreader-inline-outline=""><span data-darkreader-inline-outline="">()</span>&nbsp;=&gt;</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">import</span>(<span data-darkreader-inline-outline="" data-darkreader-inline-color="">'./Children.vue'</span>))<br></span><span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">script</span>&gt;</span><br></code></span></section><h2 data-tool="mdnice编辑器" data-darkreader-inline-outline="" data-darkreader-inline-border-bottom=""><span data-darkreader-inline-outline="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor="" data-darkreader-inline-color=""><span data-darkreader-inline-outline="">Teleport传送组件</span></span></h2><section data-darkreader-inline-outline=""><span data-darkreader-inline-outline="">Teleport 是一种能够将我们的模板渲染至指定DOM节点，不受父级style、v-show等属性影响，但data、prop数据依旧能够共用的技术</span></section><p data-darkreader-inline-outline="">主要解决的问题：因为Teleport节点挂载在其他指定的DOM节点下，完全不受父级style样式影响</p><p data-darkreader-inline-outline="">使用： 通过to 属性插入到指定元素位置，如 body，html，自定义className等等。</p><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" data-darkreader-inline-outline="" data-darkreader-inline-color=""><span data-tool="mdnice编辑器" data-darkreader-inline-outline="" data-darkreader-inline-boxshadow=""><span data-width="100%" data-darkreader-inline-outline="" data-darkreader-inline-bgcolor=""></span><code data-darkreader-inline-outline="" data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor=""><span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">template</span>&gt;</span><br>&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">&lt;!--&nbsp;插入至&nbsp;body&nbsp;--&gt;</span><br>&nbsp;&nbsp;<span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">Teleport</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">to</span>=<span data-darkreader-inline-outline="" data-darkreader-inline-color="">"body"</span>&gt;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">Children</span>&gt;</span><span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">Children</span>&gt;</span><br>&nbsp;&nbsp;<span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">Teleport</span>&gt;</span><br>&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">&lt;!--&nbsp;默认&nbsp;#app&nbsp;下&nbsp;--&gt;</span><br>&nbsp;&nbsp;<span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">Children</span>&gt;</span><span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">Children</span>&gt;</span><br><span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">template</span>&gt;</span><br><span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">script</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">lang</span>=<span data-darkreader-inline-outline="" data-darkreader-inline-color="">"ts"</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">setup</span>&gt;</span><span data-darkreader-inline-outline=""><br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">import</span>&nbsp;Children&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">from</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">'./Children.vue'</span><br></span><span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">script</span>&gt;</span><br></code></span></section><p data-darkreader-inline-outline=""><img data-galleryid="" data-ratio="0.32407407407407407" data-type="png" data-w="1080" data-src="https://mmbiz.qpic.cn/mmbiz_png/ic5A4V8PX4PniaElFR8nqkPVh6iajiaF7ytvqs1uvgiaTjYQDsSxzV6vVvK0fC5ibFP2xiaTEM7baQ7VRicRbG2BDQerHw/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" data-original-style="outline: 0px;box-sizing: border-box !important;overflow-wrap: break-word !important;width: 677px !important;visibility: visible !important;" data-index="7" src="data:image/svg+xml,%3C%3Fxml version='1.0' encoding='UTF-8'%3F%3E%3Csvg width='1px' height='1px' viewBox='0 0 1 1' version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3E%3Ctitle%3E%3C/title%3E%3Cg stroke='none' stroke-width='1' fill='none' fill-rule='evenodd' fill-opacity='0'%3E%3Cg transform='translate(-249.000000, -126.000000)' fill='%23FFFFFF'%3E%3Crect x='249' y='126' width='1' height='1'%3E%3C/rect%3E%3C/g%3E%3C/g%3E%3C/svg%3E" _width="677px" data-darkreader-inline-outline="" crossorigin="anonymous" alt="Image"></p><h2 data-tool="mdnice编辑器" data-darkreader-inline-outline="" data-darkreader-inline-border-bottom=""><span data-darkreader-inline-outline="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor="" data-darkreader-inline-color="">keep-alive 缓存组件</span></h2><ul data-darkreader-inline-outline=""><li data-darkreader-inline-outline=""><p data-darkreader-inline-outline="">作用和vue2一致，只是生命周期名称有所更改</p></li><li data-darkreader-inline-outline=""><p data-darkreader-inline-outline="">初次进入时： onMounted&gt; onActivated</p></li><li data-darkreader-inline-outline=""><p data-darkreader-inline-outline="">退出后触发 deactivated</p></li><li data-darkreader-inline-outline=""><p data-darkreader-inline-outline="">再次进入：只会触发 onActivated</p></li></ul><section data-darkreader-inline-outline=""><br><span data-darkreader-inline-outline="">事件挂载的方法等，只执行一次的放在 onMounted中；组件每次进去执行的方法放在 onActivated中</span></section><h2 data-tool="mdnice编辑器" data-darkreader-inline-outline="" data-darkreader-inline-border-bottom=""><span data-darkreader-inline-outline="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor="" data-darkreader-inline-color=""><span data-darkreader-inline-outline="">provide/inject</span></span></h2><section data-darkreader-inline-outline=""><span data-darkreader-inline-outline="">provide 可以在祖先组件中指定我们想要提供给后代组件的数据或方法，而在任何后代组件中，我们都可以使用 inject 来接收 provide 提供的数据或方法。</span></section><section data-darkreader-inline-outline=""><br></section><section data-darkreader-inline-outline=""><span data-darkreader-inline-outline="">父组件</span></section><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" data-darkreader-inline-outline="" data-darkreader-inline-color=""><span data-tool="mdnice编辑器" data-darkreader-inline-outline="" data-darkreader-inline-boxshadow=""><span data-width="100%" data-darkreader-inline-outline="" data-darkreader-inline-bgcolor=""></span><code data-darkreader-inline-outline="" data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor=""><span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">template</span>&gt;</span><br>&nbsp;&nbsp;<span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">Children</span>&gt;</span><span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">Children</span>&gt;</span><br><span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">template</span>&gt;</span><br><br><span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">script</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">setup</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">lang</span>=<span data-darkreader-inline-outline="" data-darkreader-inline-color="">"ts"</span>&gt;</span><span data-darkreader-inline-outline=""><br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">import</span>&nbsp;{&nbsp;ref,&nbsp;provide&nbsp;}&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">from</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">'vue'</span><br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">import</span>&nbsp;Children&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">from</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">"./Children.vue"</span><br><br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">const</span>&nbsp;msg&nbsp;=&nbsp;ref(<span data-darkreader-inline-outline="" data-darkreader-inline-color="">'hello&nbsp;啊，树哥'</span>)<br><br>provide(<span data-darkreader-inline-outline="" data-darkreader-inline-color="">'msg'</span>,&nbsp;msg)<br></span><span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">script</span>&gt;</span><br></code></span></section><section data-darkreader-inline-outline=""><br></section><section data-darkreader-inline-outline=""><span data-darkreader-inline-outline="">子组件</span></section><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" data-darkreader-inline-outline="" data-darkreader-inline-color=""><span data-tool="mdnice编辑器" data-darkreader-inline-outline="" data-darkreader-inline-boxshadow=""><span data-width="100%" data-darkreader-inline-outline="" data-darkreader-inline-bgcolor=""></span><code data-darkreader-inline-outline="" data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor=""><span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">template</span>&gt;</span><br>&nbsp;&nbsp;<span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">div</span>&gt;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">p</span>&gt;</span>msg：{{msg}}<span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">p</span>&gt;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">button</span>&nbsp;@<span data-darkreader-inline-outline="" data-darkreader-inline-color="">click</span>=<span data-darkreader-inline-outline="" data-darkreader-inline-color="">"onChangeMsg"</span>&gt;</span>改变msg<span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">button</span>&gt;</span><br>&nbsp;&nbsp;<span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">div</span>&gt;</span><br><span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">template</span>&gt;</span><br><br><span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">script</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">setup</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">lang</span>=<span data-darkreader-inline-outline="" data-darkreader-inline-color="">"ts"</span>&gt;</span><span data-darkreader-inline-outline=""><br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">import</span>&nbsp;{&nbsp;inject,&nbsp;Ref,&nbsp;ref&nbsp;}&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">from</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">'vue'</span><br><br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">const</span>&nbsp;msg&nbsp;=&nbsp;inject&lt;Ref&lt;string&gt;&gt;(<span data-darkreader-inline-outline="" data-darkreader-inline-color="">'msg'</span>,ref(<span data-darkreader-inline-outline="" data-darkreader-inline-color="">'hello啊！'</span>))<br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">const</span>&nbsp;onChangeMsg&nbsp;=&nbsp;<span data-darkreader-inline-outline=""><span data-darkreader-inline-outline="">()</span>&nbsp;=&gt;</span>&nbsp;{<br>&nbsp;&nbsp;msg.value&nbsp;=&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">'shuge'</span><br>}<br></span><span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">script</span>&gt;</span><br></code></span></section><section data-darkreader-inline-outline=""><span data-darkreader-inline-outline="">如果你想要传入的值能响应式的改变，需要通过ref 或 reactive 添加响应式</span></section><h2 data-tool="mdnice编辑器" data-darkreader-inline-outline="" data-darkreader-inline-border-bottom=""><span data-darkreader-inline-outline="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor="" data-darkreader-inline-color=""><span data-darkreader-inline-outline="">v-model 升级</span></span></h2><p data-darkreader-inline-outline="">v-model 在vue3可以说是破坏式更新，改动还是不少的</p><p data-darkreader-inline-outline="">我们都知道，v-model 是props 和 emit 组合而成的语法糖,vue3中 v-model 有以下改动</p><ul data-darkreader-inline-outline=""><li data-darkreader-inline-outline=""><p data-darkreader-inline-outline=""><span data-darkreader-inline-outline="">变更：value =&gt; modelValue</span></p></li><li data-darkreader-inline-outline=""><p data-darkreader-inline-outline=""><span data-darkreader-inline-outline="">变更：update:input =&gt; update:modelValue</span></p></li><li data-darkreader-inline-outline=""><p data-darkreader-inline-outline=""><span data-darkreader-inline-outline="">新增：一个组件可以设置多个 v-model</span></p></li><li data-darkreader-inline-outline=""><p data-darkreader-inline-outline=""><span data-darkreader-inline-outline="">新增：开发者可以自定义 v-model修饰符</span></p></li><li data-darkreader-inline-outline=""><p data-darkreader-inline-outline=""><span data-darkreader-inline-outline="">v-bind 的 .sync 修饰符和组件的 model 选项已移除</span></p></li></ul><p data-darkreader-inline-outline=""><span data-darkreader-inline-outline="">子组件</span></p><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" data-darkreader-inline-outline="" data-darkreader-inline-color=""><span data-tool="mdnice编辑器" data-darkreader-inline-outline="" data-darkreader-inline-boxshadow=""><span data-width="100%" data-darkreader-inline-outline="" data-darkreader-inline-bgcolor=""></span><code data-darkreader-inline-outline="" data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor=""><span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">template</span>&gt;</span><br>&nbsp;&nbsp;<span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">div</span>&gt;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">p</span>&gt;</span>{{msg}}，{{modelValue}}<span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">p</span>&gt;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">button</span>&nbsp;@<span data-darkreader-inline-outline="" data-darkreader-inline-color="">click</span>=<span data-darkreader-inline-outline="" data-darkreader-inline-color="">"onChangeMsg"</span>&gt;</span>改变msg<span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">button</span>&gt;</span><br>&nbsp;&nbsp;<span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">div</span>&gt;</span><br><span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">template</span>&gt;</span><br><br><span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">script</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">setup</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">lang</span>=<span data-darkreader-inline-outline="" data-darkreader-inline-color="">"ts"</span>&gt;</span><span data-darkreader-inline-outline=""><br><br>type&nbsp;Props&nbsp;=&nbsp;{<br>&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">modelValue</span>:&nbsp;string,<br>&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">msg</span>:&nbsp;string<br>}<br>defineProps&lt;Props&gt;()<br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">const</span>&nbsp;emit&nbsp;=&nbsp;defineEmits([<span data-darkreader-inline-outline="" data-darkreader-inline-color="">'update:modelValue'</span>,&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">'update:msg'</span>])<br><br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">const</span>&nbsp;onChangeMsg&nbsp;=&nbsp;<span data-darkreader-inline-outline=""><span data-darkreader-inline-outline="">()</span>&nbsp;=&gt;</span>&nbsp;{<br>&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">//&nbsp;触发父组件的值更新</span><br>&nbsp;&nbsp;emit(<span data-darkreader-inline-outline="" data-darkreader-inline-color="">'update:modelValue'</span>,&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">'恰如此时此刻'</span>)<br>&nbsp;&nbsp;emit(<span data-darkreader-inline-outline="" data-darkreader-inline-color="">'update:msg'</span>,&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">'彼时彼刻'</span>)<br>}<br></span><span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">script</span>&gt;</span><br></code></span></section><section data-darkreader-inline-outline=""><span data-darkreader-inline-outline="">父组件</span></section><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" data-darkreader-inline-outline="" data-darkreader-inline-color=""><span data-tool="mdnice编辑器" data-darkreader-inline-outline="" data-darkreader-inline-boxshadow=""><span data-width="100%" data-darkreader-inline-outline="" data-darkreader-inline-bgcolor=""></span><code data-darkreader-inline-outline="" data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor=""><span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">template</span>&gt;</span><br>&nbsp;&nbsp;//&nbsp;v-model:modelValue简写为v-model<br>&nbsp;&nbsp;//&nbsp;绑定多个v-model<br>&nbsp;&nbsp;<span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">Children</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">v-model</span>=<span data-darkreader-inline-outline="" data-darkreader-inline-color="">"name"</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">v-model:msg</span>=<span data-darkreader-inline-outline="" data-darkreader-inline-color="">"msg"</span>&gt;</span><span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">Children</span>&gt;</span><br><span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">template</span>&gt;</span><br><br><span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">script</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">setup</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">lang</span>=<span data-darkreader-inline-outline="" data-darkreader-inline-color="">"ts"</span>&gt;</span><span data-darkreader-inline-outline=""><br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">import</span>&nbsp;{&nbsp;ref&nbsp;}&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">from</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">'vue'</span><br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">import</span>&nbsp;Children&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">from</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">"./Children.vue"</span><br><br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">const</span>&nbsp;msg&nbsp;=&nbsp;ref(<span data-darkreader-inline-outline="" data-darkreader-inline-color="">'hello啊'</span>)<br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">const</span>&nbsp;name&nbsp;=&nbsp;ref(<span data-darkreader-inline-outline="" data-darkreader-inline-color="">'树哥'</span>)<br></span><span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">script</span>&gt;</span><br></code></span></section><h2 data-tool="mdnice编辑器" data-darkreader-inline-outline="" data-darkreader-inline-border-bottom=""><span data-darkreader-inline-outline="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor="" data-darkreader-inline-color=""><span data-darkreader-inline-outline="">自定义指令</span></span></h2><p data-darkreader-inline-outline="">自定义指令的生命周期</p><ul data-darkreader-inline-outline=""><li data-darkreader-inline-outline=""><p data-darkreader-inline-outline="">created 元素初始化的时候</p></li><li data-darkreader-inline-outline=""><p data-darkreader-inline-outline="">beforeMount 指令绑定到元素后调用 只调用一次</p></li><li data-darkreader-inline-outline=""><p data-darkreader-inline-outline="">mounted 元素插入父级dom调用</p></li><li data-darkreader-inline-outline=""><p data-darkreader-inline-outline="">beforeUpdate 元素被更新之前调用</p></li><li data-darkreader-inline-outline=""><p data-darkreader-inline-outline="">update 这个周期方法被移除 改用updated</p></li><li data-darkreader-inline-outline=""><p data-darkreader-inline-outline="">beforeUnmount 在元素被移除前调用</p></li><li data-darkreader-inline-outline=""><p data-darkreader-inline-outline="">unmounted 指令被移除后调用 只调用一次</p></li></ul><section data-darkreader-inline-outline=""><br></section><section data-darkreader-inline-outline=""><span data-darkreader-inline-outline="">实现一个自定义拖拽指令</span></section><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" data-darkreader-inline-outline="" data-darkreader-inline-color=""><span data-tool="mdnice编辑器" data-darkreader-inline-outline="" data-darkreader-inline-boxshadow=""><span data-width="100%" data-darkreader-inline-outline="" data-darkreader-inline-bgcolor=""></span><code data-darkreader-inline-outline="" data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor=""><span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">template</span>&gt;</span><br>&nbsp;&nbsp;<span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">div</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">v-move</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">class</span>=<span data-darkreader-inline-outline="" data-darkreader-inline-color="">"box"</span>&gt;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">div</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">class</span>=<span data-darkreader-inline-outline="" data-darkreader-inline-color="">"header"</span>&gt;</span><span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">div</span>&gt;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">div</span>&gt;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;内容<br>&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">div</span>&gt;</span><br>&nbsp;&nbsp;<span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">div</span>&gt;</span><br><span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">template</span>&gt;</span><br>&nbsp;<br><span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">script</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">setup</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">lang</span>=<span data-darkreader-inline-outline="" data-darkreader-inline-color="">'ts'</span>&gt;</span><span data-darkreader-inline-outline=""><br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">import</span>&nbsp;{&nbsp;Directive&nbsp;}&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">from</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">"vue"</span>;<br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">const</span>&nbsp;vMove:&nbsp;Directive&nbsp;=&nbsp;{<br>&nbsp;&nbsp;mounted(el:&nbsp;HTMLElement)&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">let</span>&nbsp;moveEl&nbsp;=&nbsp;el.firstElementChild&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">as</span>&nbsp;HTMLElement;<br>&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">const</span>&nbsp;mouseDown&nbsp;=&nbsp;<span data-darkreader-inline-outline="">(<span data-darkreader-inline-outline="">e:&nbsp;MouseEvent</span>)&nbsp;=&gt;</span>&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">//鼠标点击物体那一刻相对于物体左侧边框的距离=点击时的位置相对于浏览器最左边的距离-物体左边框相对于浏览器最左边的距离</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">console</span>.log(e.clientX,&nbsp;e.clientY,&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">"起始位置"</span>,&nbsp;el.offsetLeft);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">let</span>&nbsp;X&nbsp;=&nbsp;e.clientX&nbsp;-&nbsp;el.offsetLeft;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">let</span>&nbsp;Y&nbsp;=&nbsp;e.clientY&nbsp;-&nbsp;el.offsetTop;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">const</span>&nbsp;move&nbsp;=&nbsp;<span data-darkreader-inline-outline="">(<span data-darkreader-inline-outline="">e:&nbsp;MouseEvent</span>)&nbsp;=&gt;</span>&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;el.style.left&nbsp;=&nbsp;e.clientX&nbsp;-&nbsp;X&nbsp;+&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">"px"</span>;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;el.style.top&nbsp;=&nbsp;e.clientY&nbsp;-&nbsp;Y&nbsp;+&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">"px"</span>;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">console</span>.log(e.clientX,&nbsp;e.clientY,&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">"位置改变"</span>);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">document</span>.addEventListener(<span data-darkreader-inline-outline="" data-darkreader-inline-color="">"mousemove"</span>,&nbsp;move);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">document</span>.addEventListener(<span data-darkreader-inline-outline="" data-darkreader-inline-color="">"mouseup"</span>,&nbsp;()&nbsp;=&gt;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">document</span>.removeEventListener(<span data-darkreader-inline-outline="" data-darkreader-inline-color="">"mousemove"</span>,&nbsp;move);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;});<br>&nbsp;&nbsp;&nbsp;&nbsp;};<br>&nbsp;&nbsp;&nbsp;&nbsp;moveEl.addEventListener(<span data-darkreader-inline-outline="" data-darkreader-inline-color="">"mousedown"</span>,&nbsp;mouseDown);<br>&nbsp;&nbsp;},<br>};<br></span><span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">script</span>&gt;</span><br>&nbsp;<br><span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">style</span>&nbsp;&gt;</span><span data-darkreader-inline-outline=""><br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">.box</span>&nbsp;{<br>&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">position</span>:&nbsp;fixed;<br>&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">left</span>:&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">50%</span>;<br>&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">top</span>:&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">50%</span>;<br>&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">transform</span>:&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">translate</span>(-<span data-darkreader-inline-outline="" data-darkreader-inline-color="">50%</span>,&nbsp;-<span data-darkreader-inline-outline="" data-darkreader-inline-color="">50%</span>);<br>&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">width</span>:&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">200px</span>;<br>&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">height</span>:&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">200px</span>;<br>&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">border</span>:&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">1px</span>&nbsp;solid&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">#ccc</span>;<br>}<br><br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">.header</span>&nbsp;{<br>&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">height</span>:&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">20px</span>;<br>&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">background</span>:&nbsp;black;<br>&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">cursor</span>:&nbsp;move;<br>}<br></span><span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">style</span>&gt;</span><br></code></span></section><h2 data-tool="mdnice编辑器" data-darkreader-inline-outline="" data-darkreader-inline-border-bottom=""><span data-darkreader-inline-outline="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor="" data-darkreader-inline-color=""><span data-darkreader-inline-outline="">自定义 hooks</span></span></h2><section data-darkreader-inline-outline=""><span data-darkreader-inline-outline="">我们都知道在 vue 中有个东西叫 mixins，他可以将多个组件中相同的逻辑抽离出来，实现一次写代码，多组件受益的效果。</span></section><section data-darkreader-inline-outline=""><span data-darkreader-inline-outline="">但是 mixins 的副作用就是引用的多了变量的来源就不清晰了，而且还会有变量来源不明确,不利于阅读，容易使代码变得难以维护。</span></section><ul data-darkreader-inline-outline=""><li data-darkreader-inline-outline=""><p data-darkreader-inline-outline="">Vue3 的 hook函数 相当于 vue2 的 mixin, 不同在与 hooks 是函数</p></li><li data-darkreader-inline-outline=""><p data-darkreader-inline-outline="">Vue3 的 hook函数 可以帮助我们提高代码的复用性, 让我们能在不同的组件中都利用 hooks 函数</p></li></ul><p data-darkreader-inline-outline=""><span data-darkreader-inline-outline="">useWindowResize</span></p><p data-darkreader-inline-outline="">我们来实现一个窗口改变时获取宽高的 hook</p><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" data-darkreader-inline-outline="" data-darkreader-inline-color=""><span data-tool="mdnice编辑器" data-darkreader-inline-outline="" data-darkreader-inline-boxshadow=""><span data-width="100%" data-darkreader-inline-outline="" data-darkreader-inline-bgcolor=""></span><code data-darkreader-inline-outline="" data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor=""><span data-darkreader-inline-outline="" data-darkreader-inline-color="">import</span>&nbsp;{&nbsp;onMounted,&nbsp;onUnmounted,&nbsp;ref&nbsp;}&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">from</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">"vue"</span>;<br><br><span data-darkreader-inline-outline=""><span data-darkreader-inline-outline="" data-darkreader-inline-color="">function</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">useWindowResize</span>(<span data-darkreader-inline-outline=""></span>)&nbsp;</span>{<br>&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">const</span>&nbsp;width&nbsp;=&nbsp;ref(<span data-darkreader-inline-outline="" data-darkreader-inline-color="">0</span>);<br>&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">const</span>&nbsp;height&nbsp;=&nbsp;ref(<span data-darkreader-inline-outline="" data-darkreader-inline-color="">0</span>);<br>&nbsp;&nbsp;<span data-darkreader-inline-outline=""><span data-darkreader-inline-outline="" data-darkreader-inline-color="">function</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">onResize</span>(<span data-darkreader-inline-outline=""></span>)&nbsp;</span>{<br>&nbsp;&nbsp;&nbsp;&nbsp;width.value&nbsp;=&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">window</span>.innerWidth;<br>&nbsp;&nbsp;&nbsp;&nbsp;height.value&nbsp;=&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">window</span>.innerHeight;<br>&nbsp;&nbsp;}<br>&nbsp;&nbsp;onMounted(<span data-darkreader-inline-outline=""><span data-darkreader-inline-outline="">()</span>&nbsp;=&gt;</span>&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">window</span>.addEventListener(<span data-darkreader-inline-outline="" data-darkreader-inline-color="">"resize"</span>,&nbsp;onResize);<br>&nbsp;&nbsp;&nbsp;&nbsp;onResize();<br>&nbsp;&nbsp;});<br>&nbsp;&nbsp;onUnmounted(<span data-darkreader-inline-outline=""><span data-darkreader-inline-outline="">()</span>&nbsp;=&gt;</span>&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">window</span>.removeEventListener(<span data-darkreader-inline-outline="" data-darkreader-inline-color="">"resize"</span>,&nbsp;onResize);<br>&nbsp;&nbsp;});<br>&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">return</span>&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;width,<br>&nbsp;&nbsp;&nbsp;&nbsp;height<br>&nbsp;&nbsp;};<br>}<br><br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">export</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">default</span>&nbsp;useWindowResize;<br></code></span></section><section data-darkreader-inline-outline=""><span data-darkreader-inline-outline="">使用：</span></section><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" data-darkreader-inline-outline="" data-darkreader-inline-color=""><span data-tool="mdnice编辑器" data-darkreader-inline-outline="" data-darkreader-inline-boxshadow=""><span data-width="100%" data-darkreader-inline-outline="" data-darkreader-inline-bgcolor=""></span><code data-darkreader-inline-outline="" data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor=""><span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">template</span>&gt;</span><br>&nbsp;&nbsp;<span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">h3</span>&gt;</span>屏幕尺寸<span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">h3</span>&gt;</span><br>&nbsp;&nbsp;<span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">div</span>&gt;</span>宽度：{{&nbsp;width&nbsp;}}<span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">div</span>&gt;</span><br>&nbsp;&nbsp;<span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">div</span>&gt;</span>高度：{{&nbsp;height&nbsp;}}<span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">div</span>&gt;</span><br><span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">template</span>&gt;</span><br><br><span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">script</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">setup</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">lang</span>=<span data-darkreader-inline-outline="" data-darkreader-inline-color="">"ts"</span>&gt;</span><span data-darkreader-inline-outline=""><br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">import</span>&nbsp;useWindowResize&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">from</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">"../hooks/useWindowResize.ts"</span>;<br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">const</span>&nbsp;{&nbsp;width,&nbsp;height&nbsp;}&nbsp;=&nbsp;useWindowResize();<br></span><span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">script</span>&gt;</span><br></code></span></section><h2 data-tool="mdnice编辑器" data-darkreader-inline-outline="" data-darkreader-inline-border-bottom=""><span data-darkreader-inline-outline="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor="" data-darkreader-inline-color=""><span data-darkreader-inline-outline="">style v-bind CSS变量注入</span></span></h2><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" data-darkreader-inline-outline="" data-darkreader-inline-color=""><span data-tool="mdnice编辑器" data-darkreader-inline-outline="" data-darkreader-inline-boxshadow=""><span data-width="100%" data-darkreader-inline-outline="" data-darkreader-inline-bgcolor=""></span><code data-darkreader-inline-outline="" data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor=""><span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">template</span>&gt;</span><br>&nbsp;&nbsp;<span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">span</span>&gt;</span>&nbsp;style&nbsp;v-bind&nbsp;CSS变量注入<span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">span</span>&gt;</span>&nbsp;&nbsp;<br><span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">template</span>&gt;</span><br><span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">script</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">lang</span>=<span data-darkreader-inline-outline="" data-darkreader-inline-color="">"ts"</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">setup</span>&gt;</span><span data-darkreader-inline-outline=""><br>&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">import</span>&nbsp;{&nbsp;ref&nbsp;}&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">from</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">'vue'</span><br>&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">const</span>&nbsp;color&nbsp;=&nbsp;ref(<span data-darkreader-inline-outline="" data-darkreader-inline-color="">'red'</span>)<br></span><span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">script</span>&gt;</span><br><span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">style</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">scoped</span>&gt;</span><span data-darkreader-inline-outline=""><br>&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">span</span>&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">/*&nbsp;使用v-bind绑定组件中定义的变量&nbsp;*/</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">color</span>:&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">v-bind</span>(<span data-darkreader-inline-outline="" data-darkreader-inline-color="">'color'</span>);<br>&nbsp;&nbsp;}&nbsp;&nbsp;<br></span><span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">style</span>&gt;</span></code></span></section><section data-darkreader-inline-outline=""><span data-darkreader-inline-outline="" data-darkreader-inline-color="">本文转载自：https://juejin.cn/post/7158331832512020511</span></section><h2 data-tool="mdnice编辑器" data-darkreader-inline-outline="" data-darkreader-inline-border-bottom=""><span data-darkreader-inline-outline="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor="" data-darkreader-inline-color=""><span data-darkreader-inline-outline="">参考</span></span></h2><section data-darkreader-inline-outline=""><span data-darkreader-inline-outline="" data-darkreader-inline-color="">Vue3使用TypeScript的正确姿势：</span><span data-darkreader-inline-outline="">https://blog.csdn.net/lgno2/article/details/109446711<br></span><span data-darkreader-inline-outline="" data-darkreader-inline-color="">超极速的Vue3上手指北🔥：</span><span data-darkreader-inline-outline="">https://juejin.cn/post/7122760155707473956<br></span><span data-darkreader-inline-outline="" data-darkreader-inline-color="">Vue3.0 新特性以及使用经验总结：</span><span data-darkreader-inline-outline="">https://juejin.cn/post/6940454764421316644#heading-26<br></span><span data-darkreader-inline-outline="" data-darkreader-inline-color="">自定义指令directive：</span><span data-darkreader-inline-outline="">https://xiaoman.blog.csdn.net/article/details/123228132?spm=1001.2014.3001.5502</span></section></article><h2 data-tool="mdnice编辑器" data-darkreader-inline-outline="" data-darkreader-inline-color="" data-darkreader-inline-bgcolor="" data-darkreader-inline-border-bottom=""><span data-darkreader-inline-outline="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor="" data-darkreader-inline-color="">最后</span></h2><section data-darkreader-inline-outline="" data-darkreader-inline-color="" data-darkreader-inline-bgcolor="">距离 vue3 正式发布已经过去两年有余, 成为默认版本也过去大半年了，以前还能说是对新技术、新特性的观望，而现在面试都直问 vue3 源码了。</section><section data-darkreader-inline-outline="" data-darkreader-inline-color="" data-darkreader-inline-bgcolor="">还没掌握vue3的小伙伴抓紧用起来</section>
```

## ❤️ 看完两件事

如果你觉得这篇内容对你挺有启发，我想邀请你帮我两个小忙：

1.  点个「**在看**」，让更多的人也能看到这篇内容（喜欢不点在看，都是耍流氓 -\_-）
    
2.  关注公众号「**Vue社区**」，每周重点攻克一个前端面试重难点，
    
    公众号后台回复「**电子书**」即可免费获取 27本 精选的前端电子书！
    

![Image](data:image/svg+xml,%3C%3Fxml version='1.0' encoding='UTF-8'%3F%3E%3Csvg width='1px' height='1px' viewBox='0 0 1 1' version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3E%3Ctitle%3E%3C/title%3E%3Cg stroke='none' stroke-width='1' fill='none' fill-rule='evenodd' fill-opacity='0'%3E%3Cg transform='translate(-249.000000, -126.000000)' fill='%23FFFFFF'%3E%3Crect x='249' y='126' width='1' height='1'%3E%3C/rect%3E%3C/g%3E%3C/g%3E%3C/svg%3E)

点个在看支持我吧，转发就更好了