Original Web技术学苑 _2023-07-31 08:01_

![Image](https://mmbiz.qpic.cn/mmbiz_png/2MvanVZk2wf1MHJ7iawa0KNC333h1fMIgaVEjMpwvgVSyJFgHiasUjR4fRIicFKkHr4ZkZ11IC4VRLBD73ribATEXQ/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1)

点击上方蓝字关注我们，标星不迷路，不错过每一篇用心分享的技术文章哦

![Image](https://mmbiz.qpic.cn/mmbiz_png/Bt0AiaiblzGHzqnvnyzGW4zjLrpWVHoictMf5sqV5dCiblfEBkkFZTbfd6GX3wHIiaiazAmmSSbJWDaDiba8YB3yPV4Gw/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1)

![Image](https://mmbiz.qpic.cn/mmbiz_png/0jXCeiaibicNx5wOBP35wzuQmibdGaKNkou75uC6SChvfaqoDXvxNrFuVt5FnxWfRaH3ibmMYjoMiaQic6xtGG7wN0T7g/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1)

由于业务需要，最近在做`chrome`插件，于是寻找构建插件社区，找到了`plasmo`,应该是社区中比较优秀的构建`chrome`插件的脚手架，但最终还是没有选择用，原生插件非常简单，具体可以参考【写个自己的chrome插件】,为满足当下业务需要，于是基于`webpack5`搭建一个构建插件的基础脚手架，本文是一篇搭建`chrome`插件的实践总结，希望看完在项目中有所帮助。

插件基本能力

-   使用`webpack5`搭建，支持`react18.x`
    
-   支持`tsx`、`jsx`构建函数组件
    
-   支持`tailwindcss`
    
-   支持预览`tabs`页面预览
    

### 前置

在使用`webpack5`搭建插件，可以参考笔者在之前写的【webpack5】系列笔记中有部分搭建案例，`chrome插件`本质上是运行在chrome浏览器的网页，因此本质上也是用网页来展现的，只是一个插件的必须满足根目录必须有`mainifest.json`，我们具体以下面一张图来重新回顾下插件的基本要素

#### 插件核心

-   base chrome plugin
    
    ![Image](data:image/svg+xml,%3C%3Fxml version='1.0' encoding='UTF-8'%3F%3E%3Csvg width='1px' height='1px' viewBox='0 0 1 1' version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3E%3Ctitle%3E%3C/title%3E%3Cg stroke='none' stroke-width='1' fill='none' fill-rule='evenodd' fill-opacity='0'%3E%3Cg transform='translate(-249.000000, -126.000000)' fill='%23FFFFFF'%3E%3Crect x='249' y='126' width='1' height='1'%3E%3C/rect%3E%3C/g%3E%3C/g%3E%3C/svg%3E)
    
-   关键文件
    
    ![Image](data:image/svg+xml,%3C%3Fxml version='1.0' encoding='UTF-8'%3F%3E%3Csvg width='1px' height='1px' viewBox='0 0 1 1' version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3E%3Ctitle%3E%3C/title%3E%3Cg stroke='none' stroke-width='1' fill='none' fill-rule='evenodd' fill-opacity='0'%3E%3Cg transform='translate(-249.000000, -126.000000)' fill='%23FFFFFF'%3E%3Crect x='249' y='126' width='1' height='1'%3E%3C/rect%3E%3C/g%3E%3C/g%3E%3C/svg%3E)
    

#### manifest.json

在这个文件中，构建一个插件`manifest.json`是必不可少的，其中注意一点`manifest_version`是`3`版本，因为好多新特性`2`版本并不支持，同时当我们需要操作`chrome`的`api`时，在`permissions`开放操作权限

```
<section><span data-darkreader-inline-bgcolor=""></span><span data-darkreader-inline-bgcolor=""></span><span data-darkreader-inline-bgcolor=""></span></section><code data-line="83" data-darkreader-inline-bgimage=""><span data-darkreader-inline-border-left=""><span data-darkreader-inline-color="">{</span><br></span><span data-darkreader-inline-border-left="">    "name"<span data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor="">:</span> <span data-darkreader-inline-color="">"base chrome plugin chrome"</span><span data-darkreader-inline-color="">,</span> <span data-darkreader-inline-color="">//插件的名称</span><br></span><span data-darkreader-inline-border-left="">    "description"<span data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor="">:</span> <span data-darkreader-inline-color="">"a simple chrome plugin"</span><span data-darkreader-inline-color="">,</span> <span data-darkreader-inline-color="">// 插件描述</span><br></span><span data-darkreader-inline-border-left="">    "version"<span data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor="">:</span> <span data-darkreader-inline-color="">"1.0.0"</span><span data-darkreader-inline-color="">,</span> <span data-darkreader-inline-color="">// 当前插件版本</span><br></span><span data-darkreader-inline-border-left="">    "manifest_version"<span data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor="">:</span> 3<span data-darkreader-inline-color="">,</span> <span data-darkreader-inline-color="">// chrome插件必填版本3</span><br></span><span data-darkreader-inline-border-left="">    "action"<span data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor="">:</span> <span data-darkreader-inline-color="">{</span><br></span><span data-darkreader-inline-border-left="">        "default_icon"<span data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor="">:</span> <span data-darkreader-inline-color="">"assets/imgs/icon.png"</span><span data-darkreader-inline-color="">,</span> <span data-darkreader-inline-color="">// 插件icon</span><br></span><span data-darkreader-inline-border-left="">        "default_title"<span data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor="">:</span> <span data-darkreader-inline-color="">"demo chrome plugin"</span><span data-darkreader-inline-color="">,</span><br></span><span data-darkreader-inline-border-left="">        "default_popup"<span data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor="">:</span> <span data-darkreader-inline-color="">"popup.html"</span> <span data-darkreader-inline-color="">// popup页面</span><br></span><span data-darkreader-inline-border-left="">    <span data-darkreader-inline-color="">}</span><span data-darkreader-inline-color="">,</span><br></span><span data-darkreader-inline-border-left="">    "background"<span data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor="">:</span> <span data-darkreader-inline-color="">{</span><br></span><span data-darkreader-inline-border-left="">        "service_worker"<span data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor="">:</span> <span data-darkreader-inline-color="">"./src/background/index.js"</span><span data-darkreader-inline-color="">,</span><br></span><span data-darkreader-inline-border-left="">        "type"<span data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor="">:</span> <span data-darkreader-inline-color="">"module"</span><br></span><span data-darkreader-inline-border-left="">    <span data-darkreader-inline-color="">}</span><span data-darkreader-inline-color="">,</span><br></span><span data-darkreader-inline-border-left="">    "icons"<span data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor="">:</span><br></span><span data-darkreader-inline-border-left=""><span data-darkreader-inline-color="">{</span><br></span><span data-darkreader-inline-border-left="">"16"<span data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor="">:</span> <span data-darkreader-inline-color="">"assets/imgs/icon.png"</span><br></span><span data-darkreader-inline-border-left=""><span data-darkreader-inline-color="">}</span><span data-darkreader-inline-color="">,</span><br></span><span data-darkreader-inline-border-left="">    "content_scripts"<span data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor="">:</span> <span data-darkreader-inline-color="">[</span><br></span><span data-darkreader-inline-border-left="">        <span data-darkreader-inline-color="">{</span><br></span><span data-darkreader-inline-border-left="">            "matches"<span data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor="">:</span> <span data-darkreader-inline-color="">[</span><br></span><span data-darkreader-inline-border-left="">                <span data-darkreader-inline-color="">"&lt;all_urls&gt;"</span> <span data-darkreader-inline-color="">// 插件在任何页面可用</span><br></span><span data-darkreader-inline-border-left="">            <span data-darkreader-inline-color="">]</span><span data-darkreader-inline-color="">,</span><br></span><span data-darkreader-inline-border-left="">            "exclude_matches"<span data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor="">:</span> <span data-darkreader-inline-color="">[</span> <span data-darkreader-inline-color="">// 排除插件在部分页面中不可用</span><br></span><span data-darkreader-inline-border-left="">               <br></span><span data-darkreader-inline-border-left="">            <span data-darkreader-inline-color="">]</span><span data-darkreader-inline-color="">,</span><br></span><span data-darkreader-inline-border-left="">            "js"<span data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor="">:</span> <span data-darkreader-inline-color="">[</span><br></span><span data-darkreader-inline-border-left="">                <span data-darkreader-inline-color="">"src/content/index.js"</span> <span data-darkreader-inline-color="">// 匹配的页面中加载content.js</span><br></span><span data-darkreader-inline-border-left="">            <span data-darkreader-inline-color="">]</span><span data-darkreader-inline-color="">,</span><br></span><span data-darkreader-inline-border-left="">            "css"<span data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor="">:</span> <span data-darkreader-inline-color="">[</span><br></span><span data-darkreader-inline-border-left="">                <span data-darkreader-inline-color="">"assets/css/index.css"</span> <span data-darkreader-inline-color="">//匹配的页面加载css</span><br></span><span data-darkreader-inline-border-left="">            <span data-darkreader-inline-color="">]</span><span data-darkreader-inline-color="">,</span><br></span><span data-darkreader-inline-border-left="">            <br></span><span data-darkreader-inline-border-left="">            "run_at"<span data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor="">:</span> <span data-darkreader-inline-color="">"document_end"</span><span data-darkreader-inline-color="">,</span><br></span><span data-darkreader-inline-border-left="">            "all_frames"<span data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor="">:</span> false<br></span><span data-darkreader-inline-border-left="">        <span data-darkreader-inline-color="">}</span><br></span><span data-darkreader-inline-border-left="">    <span data-darkreader-inline-color="">]</span><span data-darkreader-inline-color="">,</span><br></span><span data-darkreader-inline-border-left=""><br></span><span data-darkreader-inline-border-left="">    "host_permissions"<span data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor="">:</span> <span data-darkreader-inline-color="">[</span><br></span><span data-darkreader-inline-border-left="">    <br></span><span data-darkreader-inline-border-left="">    <span data-darkreader-inline-color="">]</span><span data-darkreader-inline-color="">,</span><br></span><span data-darkreader-inline-border-left="">    "permissions"<span data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor="">:</span> <span data-darkreader-inline-color="">[</span><br></span><span data-darkreader-inline-border-left="">        <span data-darkreader-inline-color="">"tabs"</span><span data-darkreader-inline-color="">,</span> <span data-darkreader-inline-color="">// chrome api操作的权限</span><br></span><span data-darkreader-inline-border-left="">        <span data-darkreader-inline-color="">"contextMenus"</span><span data-darkreader-inline-color="">,</span><br></span><span data-darkreader-inline-border-left="">        <span data-darkreader-inline-color="">"notifications"</span><span data-darkreader-inline-color="">,</span><br></span><span data-darkreader-inline-border-left="">        <span data-darkreader-inline-color="">"webRequest"</span><span data-darkreader-inline-color="">,</span><br></span><span data-darkreader-inline-border-left="">        <span data-darkreader-inline-color="">"activeTab"</span><br></span><span data-darkreader-inline-border-left="">    <span data-darkreader-inline-color="">]</span><span data-darkreader-inline-color="">,</span><br></span><span data-darkreader-inline-border-left="">    "omnibox"<span data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor="">:</span> <span data-darkreader-inline-color="">{</span> "keyword" <span data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor="">:</span> <span data-darkreader-inline-color="">"demo"</span> <span data-darkreader-inline-color="">}</span><span data-darkreader-inline-color="">,</span><br></span><span data-darkreader-inline-border-left="">    "commands"<span data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor="">:</span> <span data-darkreader-inline-color="">{</span><br></span><span data-darkreader-inline-border-left="">        "_execute_action"<span data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor="">:</span> <span data-darkreader-inline-color="">{</span><br></span><span data-darkreader-inline-border-left="">            "suggested_key"<span data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor="">:</span> <span data-darkreader-inline-color="">{</span><br></span><span data-darkreader-inline-border-left="">                "default"<span data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor="">:</span> <span data-darkreader-inline-color="">"Ctrl+Shift+Y"</span><span data-darkreader-inline-color="">,</span><br></span><span data-darkreader-inline-border-left="">                "mac"<span data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor="">:</span> <span data-darkreader-inline-color="">"Command+Shift+Y"</span><br></span><span data-darkreader-inline-border-left="">            <span data-darkreader-inline-color="">}</span><span data-darkreader-inline-color="">,</span><br></span><span data-darkreader-inline-border-left="">            "description"<span data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor="">:</span> <span data-darkreader-inline-color="">"Opens tabs.html"</span><br></span><span data-darkreader-inline-border-left="">        <span data-darkreader-inline-color="">}</span><br></span><span data-darkreader-inline-border-left="">    <span data-darkreader-inline-color="">}</span><br></span><span data-darkreader-inline-border-left=""><span data-darkreader-inline-color="">}</span><br></span></code>
```

#### webpack.config.js

这是插件的基础配置文件,主要讲解几个关键的配置

-   `entry`
    

我们看到`entry`主要是`background`、`popup`、`content`、`set`的几个文件，这是打包的入口文件，在`webpack`入口文件，会根据`entry`找到自己依赖的模块，从而进行加载

```
<section><span data-darkreader-inline-bgcolor=""></span><span data-darkreader-inline-bgcolor=""></span><span data-darkreader-inline-bgcolor=""></span></section><code data-line="106" data-darkreader-inline-bgimage=""><span data-darkreader-inline-border-left=""><span data-darkreader-inline-color="">// webpack.confg.js</span><br></span><span data-darkreader-inline-border-left=""><span data-darkreader-inline-color="">const</span> path <span data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor="">=</span> <span data-darkreader-inline-color="">require</span><span data-darkreader-inline-color="">(</span><span data-darkreader-inline-color="">"path"</span><span data-darkreader-inline-color="">)</span><span data-darkreader-inline-color="">;</span><br></span><span data-darkreader-inline-border-left=""><span data-darkreader-inline-color="">const</span> <span data-darkreader-inline-color="">resolvePath</span> <span data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor="">=</span> <span data-darkreader-inline-color="">(</span>dir<span data-darkreader-inline-color="">)</span> <span data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor="">=&gt;</span> <span data-darkreader-inline-color="">{</span><br></span><span data-darkreader-inline-border-left="">  <span data-darkreader-inline-color="">return</span> path<span data-darkreader-inline-color="">.</span><span data-darkreader-inline-color="">resolve</span><span data-darkreader-inline-color="">(</span>__dirname<span data-darkreader-inline-color="">,</span> dir<span data-darkreader-inline-color="">)</span><span data-darkreader-inline-color="">;</span><br></span><span data-darkreader-inline-border-left=""><span data-darkreader-inline-color="">}</span><span data-darkreader-inline-color="">;</span><br></span><span data-darkreader-inline-border-left="">module<span data-darkreader-inline-color="">.</span><span data-darkreader-inline-color="">exports</span> <span data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor="">=</span> <span data-darkreader-inline-color="">(</span>env<span data-darkreader-inline-color="">)</span> <span data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor="">=&gt;</span> <span data-darkreader-inline-color="">{</span><br></span><span data-darkreader-inline-border-left="">  <span data-darkreader-inline-color="">return</span> <span data-darkreader-inline-color="">{</span><br></span><span data-darkreader-inline-border-left="">    entry<span data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor="">:</span> <span data-darkreader-inline-color="">{</span><br></span><span data-darkreader-inline-border-left="">        background<span data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor="">:</span> <span data-darkreader-inline-color="">resolvePath</span><span data-darkreader-inline-color="">(</span><span data-darkreader-inline-color="">"src/background/index"</span><span data-darkreader-inline-color="">)</span><span data-darkreader-inline-color="">,</span><br></span><span data-darkreader-inline-border-left="">        popup<span data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor="">:</span> <span data-darkreader-inline-color="">resolvePath</span><span data-darkreader-inline-color="">(</span><span data-darkreader-inline-color="">"src/pages/popup/index"</span><span data-darkreader-inline-color="">)</span><span data-darkreader-inline-color="">,</span><br></span><span data-darkreader-inline-border-left="">        content<span data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor="">:</span> <span data-darkreader-inline-color="">resolvePath</span><span data-darkreader-inline-color="">(</span><span data-darkreader-inline-color="">"src/pages/content/index"</span><span data-darkreader-inline-color="">)</span><span data-darkreader-inline-color="">,</span><br></span><span data-darkreader-inline-border-left="">        set<span data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor="">:</span> <span data-darkreader-inline-color="">resolvePath</span><span data-darkreader-inline-color="">(</span><span data-darkreader-inline-color="">"src/pages/tabs/set/index"</span><span data-darkreader-inline-color="">)</span><span data-darkreader-inline-color="">,</span><br></span><span data-darkreader-inline-border-left="">    <span data-darkreader-inline-color="">}</span><br></span><span data-darkreader-inline-border-left="">  <span data-darkreader-inline-color="">}</span><br></span><span data-darkreader-inline-border-left=""><span data-darkreader-inline-color="">}</span><br></span></code>
```

-   `output`
    

`output`会根据`entry`的文件，输出到指定`path`的文件夹中，其中`publicPatch`指定绝对路径访问打包后的资源

```
<section><span data-darkreader-inline-bgcolor=""></span><span data-darkreader-inline-bgcolor=""></span><span data-darkreader-inline-bgcolor=""></span></section><code data-line="122" data-darkreader-inline-bgimage=""><span data-darkreader-inline-border-left=""> module<span data-darkreader-inline-color="">.</span><span data-darkreader-inline-color="">exports</span> <span data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor="">=</span> <span data-darkreader-inline-color="">(</span>env<span data-darkreader-inline-color="">)</span> <span data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor="">=&gt;</span> <span data-darkreader-inline-color="">{</span><br></span><span data-darkreader-inline-border-left="">  <span data-darkreader-inline-color="">const</span> PluginFileAssetsName <span data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor="">=</span> <span data-darkreader-inline-color="">`</span><span data-darkreader-inline-color="">dist/</span><span data-darkreader-inline-color="">${</span>env<span data-darkreader-inline-color="">.</span>mode<span data-darkreader-inline-color="">}</span><span data-darkreader-inline-color="">/</span><span data-darkreader-inline-color="">${</span>fileName<span data-darkreader-inline-color="">}</span><span data-darkreader-inline-color="">`</span><span data-darkreader-inline-color="">;</span><br></span><span data-darkreader-inline-border-left="">   <span data-darkreader-inline-color="">return</span> <span data-darkreader-inline-color="">{</span><br></span><span data-darkreader-inline-border-left="">     <span data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor="">...</span><br></span><span data-darkreader-inline-border-left="">    output<span data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor="">:</span> <span data-darkreader-inline-color="">{</span><br></span><span data-darkreader-inline-border-left="">      publicPath<span data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor="">:</span> <span data-darkreader-inline-color="">"/"</span><span data-darkreader-inline-color="">,</span><br></span><span data-darkreader-inline-border-left="">      path<span data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor="">:</span> path<span data-darkreader-inline-color="">.</span><span data-darkreader-inline-color="">join</span><span data-darkreader-inline-color="">(</span>__dirname<span data-darkreader-inline-color="">,</span> PluginFileAssetsName<span data-darkreader-inline-color="">)</span><span data-darkreader-inline-color="">,</span><br></span><span data-darkreader-inline-border-left="">      filename<span data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor="">:</span> <span data-darkreader-inline-color="">"src/[name]/index.js"</span><span data-darkreader-inline-color="">,</span><br></span><span data-darkreader-inline-border-left="">    <span data-darkreader-inline-color="">}</span><span data-darkreader-inline-color="">,</span><br></span><span data-darkreader-inline-border-left="">   <span data-darkreader-inline-color="">}</span><br></span><span data-darkreader-inline-border-left=""> <span data-darkreader-inline-color="">}</span><br></span></code>
```

-   `plugins`
    

在这个配置中，主要做了一下几件事情

-   注册`env`变量，让`.env.xx`中的变量在其他文件中能被访问
    
-   使用`html-webpack-plugin`插件生成`popup`、`set`页面
    
-   使用`copy-webpack-plugin`插件将引入的资源复制到指定输出的文件夹中
    

```
<section><span data-darkreader-inline-bgcolor=""></span><span data-darkreader-inline-bgcolor=""></span><span data-darkreader-inline-bgcolor=""></span></section><code data-line="188" data-darkreader-inline-bgimage=""><span data-darkreader-inline-border-left="">module<span data-darkreader-inline-color="">.</span><span data-darkreader-inline-color="">exports</span> <span data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor="">=</span> <span data-darkreader-inline-color="">(</span>env<span data-darkreader-inline-color="">)</span> <span data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor="">=&gt;</span> <span data-darkreader-inline-color="">{</span><br></span><span data-darkreader-inline-border-left="">    <span data-darkreader-inline-color="">return</span> <span data-darkreader-inline-color="">{</span><br></span><span data-darkreader-inline-border-left="">      <span data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor="">...</span><span data-darkreader-inline-color="">,</span><br></span><span data-darkreader-inline-border-left="">       plugins<span data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor="">:</span> <span data-darkreader-inline-color="">[</span><br></span><span data-darkreader-inline-border-left="">      <span data-darkreader-inline-color="">new</span> <span data-darkreader-inline-color="">Dotenv</span><span data-darkreader-inline-color="">(</span><span data-darkreader-inline-color="">{</span><br></span><span data-darkreader-inline-border-left="">        path<span data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor="">:</span> path<span data-darkreader-inline-color="">.</span><span data-darkreader-inline-color="">resolve</span><span data-darkreader-inline-color="">(</span>process<span data-darkreader-inline-color="">.</span><span data-darkreader-inline-color="">cwd</span><span data-darkreader-inline-color="">(</span><span data-darkreader-inline-color="">)</span><span data-darkreader-inline-color="">,</span> <span data-darkreader-inline-color="">`</span><span data-darkreader-inline-color="">.env.</span><span data-darkreader-inline-color="">${</span>env<span data-darkreader-inline-color="">.</span>mode<span data-darkreader-inline-color="">}</span><span data-darkreader-inline-color="">`</span><span data-darkreader-inline-color="">)</span><span data-darkreader-inline-color="">,</span><br></span><span data-darkreader-inline-border-left="">      <span data-darkreader-inline-color="">}</span><span data-darkreader-inline-color="">)</span><span data-darkreader-inline-color="">,</span> <span data-darkreader-inline-color="">// 读取本地.env本地</span><br></span><span data-darkreader-inline-border-left=""><br></span><span data-darkreader-inline-border-left="">      <span data-darkreader-inline-color="">new</span> <span data-darkreader-inline-color="">Html</span><span data-darkreader-inline-color="">(</span><span data-darkreader-inline-color="">{</span><br></span><span data-darkreader-inline-border-left="">        filename<span data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor="">:</span> <span data-darkreader-inline-color="">"popup.html"</span><span data-darkreader-inline-color="">,</span><br></span><span data-darkreader-inline-border-left="">        template<span data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor="">:</span> <span data-darkreader-inline-color="">"./public/index.html"</span><span data-darkreader-inline-color="">,</span><br></span><span data-darkreader-inline-border-left="">        chunks<span data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor="">:</span> <span data-darkreader-inline-color="">[</span><span data-darkreader-inline-color="">"popup"</span><span data-darkreader-inline-color="">]</span><span data-darkreader-inline-color="">,</span> <span data-darkreader-inline-color="">// 打包后只会包含popup与content,避免将其他js引入</span><br></span><span data-darkreader-inline-border-left="">        hash<span data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor="">:</span> false<span data-darkreader-inline-color="">,</span><br></span><span data-darkreader-inline-border-left="">        minify<span data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor="">:</span> <span data-darkreader-inline-color="">{</span><br></span><span data-darkreader-inline-border-left="">          removeComments<span data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor="">:</span> true<span data-darkreader-inline-color="">,</span><br></span><span data-darkreader-inline-border-left="">          collapseWhitespace<span data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor="">:</span> true<span data-darkreader-inline-color="">,</span><br></span><span data-darkreader-inline-border-left="">          minifyCSS<span data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor="">:</span> true<span data-darkreader-inline-color="">,</span><br></span><span data-darkreader-inline-border-left="">        <span data-darkreader-inline-color="">}</span><span data-darkreader-inline-color="">,</span><br></span><span data-darkreader-inline-border-left="">        title<span data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor="">:</span> <span data-darkreader-inline-color="">"test popup"</span><span data-darkreader-inline-color="">,</span><br></span><span data-darkreader-inline-border-left="">      <span data-darkreader-inline-color="">}</span><span data-darkreader-inline-color="">)</span><span data-darkreader-inline-color="">,</span><br></span><span data-darkreader-inline-border-left="">      <span data-darkreader-inline-color="">new</span> <span data-darkreader-inline-color="">Html</span><span data-darkreader-inline-color="">(</span><span data-darkreader-inline-color="">{</span><br></span><span data-darkreader-inline-border-left="">        filename<span data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor="">:</span> <span data-darkreader-inline-color="">"set.html"</span><span data-darkreader-inline-color="">,</span><br></span><span data-darkreader-inline-border-left="">        template<span data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor="">:</span> <span data-darkreader-inline-color="">"./public/index.html"</span><span data-darkreader-inline-color="">,</span><br></span><span data-darkreader-inline-border-left="">        chunks<span data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor="">:</span> <span data-darkreader-inline-color="">[</span><span data-darkreader-inline-color="">"set"</span><span data-darkreader-inline-color="">]</span><span data-darkreader-inline-color="">,</span><br></span><span data-darkreader-inline-border-left="">        hash<span data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor="">:</span> false<span data-darkreader-inline-color="">,</span><br></span><span data-darkreader-inline-border-left="">        title<span data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor="">:</span> <span data-darkreader-inline-color="">"set"</span><span data-darkreader-inline-color="">,</span><br></span><span data-darkreader-inline-border-left="">        minify<span data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor="">:</span> <span data-darkreader-inline-color="">{</span><br></span><span data-darkreader-inline-border-left="">          removeComments<span data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor="">:</span> true<span data-darkreader-inline-color="">,</span><br></span><span data-darkreader-inline-border-left="">          collapseWhitespace<span data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor="">:</span> true<span data-darkreader-inline-color="">,</span><br></span><span data-darkreader-inline-border-left="">          minifyCSS<span data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor="">:</span> true<span data-darkreader-inline-color="">,</span><br></span><span data-darkreader-inline-border-left="">        <span data-darkreader-inline-color="">}</span><span data-darkreader-inline-color="">,</span><br></span><span data-darkreader-inline-border-left="">      <span data-darkreader-inline-color="">}</span><span data-darkreader-inline-color="">)</span><span data-darkreader-inline-color="">,</span><br></span><span data-darkreader-inline-border-left="">      <span data-darkreader-inline-color="">new</span> <span data-darkreader-inline-color="">MiniCssExtractPlugin</span><span data-darkreader-inline-color="">(</span><span data-darkreader-inline-color="">{</span><br></span><span data-darkreader-inline-border-left="">        filename<span data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor="">:</span> <span data-darkreader-inline-color="">"css/[name].css"</span><span data-darkreader-inline-color="">,</span><br></span><span data-darkreader-inline-border-left="">        chunkFilename<span data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor="">:</span> <span data-darkreader-inline-color="">"css/[name].css"</span><span data-darkreader-inline-color="">,</span><br></span><span data-darkreader-inline-border-left="">      <span data-darkreader-inline-color="">}</span><span data-darkreader-inline-color="">)</span><span data-darkreader-inline-color="">,</span><br></span><span data-darkreader-inline-border-left=""><br></span><span data-darkreader-inline-border-left="">      <span data-darkreader-inline-color="">new</span> <span data-darkreader-inline-color="">copyWebpackPlugin</span><span data-darkreader-inline-color="">(</span><span data-darkreader-inline-color="">{</span><br></span><span data-darkreader-inline-border-left="">        patterns<span data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor="">:</span> <span data-darkreader-inline-color="">[</span><br></span><span data-darkreader-inline-border-left="">          <span data-darkreader-inline-color="">{</span><br></span><span data-darkreader-inline-border-left="">            <span data-darkreader-inline-color="">from</span><span data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor="">:</span> path<span data-darkreader-inline-color="">.</span><span data-darkreader-inline-color="">join</span><span data-darkreader-inline-color="">(</span>__dirname<span data-darkreader-inline-color="">,</span> <span data-darkreader-inline-color="">"manifest.json"</span><span data-darkreader-inline-color="">)</span><span data-darkreader-inline-color="">,</span><br></span><span data-darkreader-inline-border-left="">            to<span data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor="">:</span> path<span data-darkreader-inline-color="">.</span><span data-darkreader-inline-color="">join</span><span data-darkreader-inline-color="">(</span>__dirname<span data-darkreader-inline-color="">,</span> <span data-darkreader-inline-color="">`</span><span data-darkreader-inline-color="">${</span>PluginFileAssetsName<span data-darkreader-inline-color="">}</span><span data-darkreader-inline-color="">/</span><span data-darkreader-inline-color="">`</span><span data-darkreader-inline-color="">)</span><span data-darkreader-inline-color="">,</span><br></span><span data-darkreader-inline-border-left="">          <span data-darkreader-inline-color="">}</span><span data-darkreader-inline-color="">,</span><br></span><span data-darkreader-inline-border-left="">          <span data-darkreader-inline-color="">{</span><br></span><span data-darkreader-inline-border-left="">            <span data-darkreader-inline-color="">from</span><span data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor="">:</span> path<span data-darkreader-inline-color="">.</span><span data-darkreader-inline-color="">join</span><span data-darkreader-inline-color="">(</span>__dirname<span data-darkreader-inline-color="">,</span> <span data-darkreader-inline-color="">"src/assets/imgs"</span><span data-darkreader-inline-color="">)</span><span data-darkreader-inline-color="">,</span><br></span><span data-darkreader-inline-border-left="">            to<span data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor="">:</span> path<span data-darkreader-inline-color="">.</span><span data-darkreader-inline-color="">join</span><span data-darkreader-inline-color="">(</span>__dirname<span data-darkreader-inline-color="">,</span> <span data-darkreader-inline-color="">`</span><span data-darkreader-inline-color="">${</span>PluginFileAssetsName<span data-darkreader-inline-color="">}</span><span data-darkreader-inline-color="">/assets/imgs</span><span data-darkreader-inline-color="">`</span><span data-darkreader-inline-color="">)</span><span data-darkreader-inline-color="">,</span><br></span><span data-darkreader-inline-border-left="">          <span data-darkreader-inline-color="">}</span><span data-darkreader-inline-color="">,</span><br></span><span data-darkreader-inline-border-left="">          <span data-darkreader-inline-color="">{</span><br></span><span data-darkreader-inline-border-left="">            <span data-darkreader-inline-color="">from</span><span data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor="">:</span> path<span data-darkreader-inline-color="">.</span><span data-darkreader-inline-color="">join</span><span data-darkreader-inline-color="">(</span>__dirname<span data-darkreader-inline-color="">,</span> <span data-darkreader-inline-color="">"src/assets/css"</span><span data-darkreader-inline-color="">)</span><span data-darkreader-inline-color="">,</span><br></span><span data-darkreader-inline-border-left="">            to<span data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor="">:</span> path<span data-darkreader-inline-color="">.</span><span data-darkreader-inline-color="">join</span><span data-darkreader-inline-color="">(</span>__dirname<span data-darkreader-inline-color="">,</span> <span data-darkreader-inline-color="">`</span><span data-darkreader-inline-color="">${</span>PluginFileAssetsName<span data-darkreader-inline-color="">}</span><span data-darkreader-inline-color="">/assets/css</span><span data-darkreader-inline-color="">`</span><span data-darkreader-inline-color="">)</span><span data-darkreader-inline-color="">,</span><br></span><span data-darkreader-inline-border-left="">          <span data-darkreader-inline-color="">}</span><span data-darkreader-inline-color="">,</span><br></span><span data-darkreader-inline-border-left="">        <span data-darkreader-inline-color="">]</span><span data-darkreader-inline-color="">,</span><br></span><span data-darkreader-inline-border-left="">      <span data-darkreader-inline-color="">}</span><span data-darkreader-inline-color="">)</span><span data-darkreader-inline-color="">,</span><br></span><span data-darkreader-inline-border-left="">      <span data-darkreader-inline-color="">new</span> <span data-darkreader-inline-color="">CleanWebpackPlugin</span><span data-darkreader-inline-color="">(</span><span data-darkreader-inline-color="">)</span><span data-darkreader-inline-color="">,</span><br></span><span data-darkreader-inline-border-left="">    <span data-darkreader-inline-color="">]</span><span data-darkreader-inline-color="">,</span><br></span><span data-darkreader-inline-border-left="">    <span data-darkreader-inline-color="">}</span><br></span><span data-darkreader-inline-border-left=""><span data-darkreader-inline-color="">}</span><br></span></code>
```

-   支持`jsx`与`tsx`
    

支持`jsx`与`tsx`主要是利用`babel-loader`,在`rules`这个配置中,同时我们也对`.tsx,.ts`单独使用`ts-loader`去加载

```
<section><span data-darkreader-inline-bgcolor=""></span><span data-darkreader-inline-bgcolor=""></span><span data-darkreader-inline-bgcolor=""></span></section><code data-line="217" data-darkreader-inline-bgimage=""><span data-darkreader-inline-border-left="">module<span data-darkreader-inline-color="">.</span>exports <span data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor="">=</span> <span data-darkreader-inline-color="">{</span><br></span><span data-darkreader-inline-border-left="">  rules<span data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor="">:</span> <span data-darkreader-inline-color="">[</span><br></span><span data-darkreader-inline-border-left="">      <span data-darkreader-inline-color="">{</span><br></span><span data-darkreader-inline-border-left="">      test<span data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor="">:</span> /\.<span data-darkreader-inline-color="">(</span>js<span data-darkreader-inline-color="">|</span>jsx<span data-darkreader-inline-color="">|</span>tsx<span data-darkreader-inline-color="">)</span><span data-darkreader-inline-color="">$</span>/i<span data-darkreader-inline-color="">,</span><br></span><span data-darkreader-inline-border-left="">      exclude<span data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor="">:</span> /node_modules/<span data-darkreader-inline-color="">,</span><br></span><span data-darkreader-inline-border-left="">      use<span data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor="">:</span> <span data-darkreader-inline-color="">[</span><br></span><span data-darkreader-inline-border-left="">        <span data-darkreader-inline-color="">{</span><br></span><span data-darkreader-inline-border-left="">          loader<span data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor="">:</span> <span data-darkreader-inline-color="">"babel-loader"</span><span data-darkreader-inline-color="">,</span><br></span><span data-darkreader-inline-border-left="">          options<span data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor="">:</span> <span data-darkreader-inline-color="">{</span><br></span><span data-darkreader-inline-border-left="">            presets<span data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor="">:</span> <span data-darkreader-inline-color="">[</span><span data-darkreader-inline-color="">"@babel/preset-env"</span><span data-darkreader-inline-color="">,</span> <span data-darkreader-inline-color="">"@babel/preset-react"</span><span data-darkreader-inline-color="">]</span><span data-darkreader-inline-color="">,</span><br></span><span data-darkreader-inline-border-left="">          <span data-darkreader-inline-color="">}</span><span data-darkreader-inline-color="">,</span><br></span><span data-darkreader-inline-border-left="">        <span data-darkreader-inline-color="">}</span><span data-darkreader-inline-color="">,</span><br></span><span data-darkreader-inline-border-left="">      <span data-darkreader-inline-color="">]</span><span data-darkreader-inline-color="">,</span><br></span><span data-darkreader-inline-border-left="">    <span data-darkreader-inline-color="">}</span><span data-darkreader-inline-color="">,</span><br></span><span data-darkreader-inline-border-left="">    <span data-darkreader-inline-color="">{</span><br></span><span data-darkreader-inline-border-left="">      test<span data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor="">:</span> /\.<span data-darkreader-inline-color="">(</span>tsx<span data-darkreader-inline-color="">|</span>ts<span data-darkreader-inline-color="">)</span><span data-darkreader-inline-color="">$</span>/i<span data-darkreader-inline-color="">,</span><br></span><span data-darkreader-inline-border-left="">      use<span data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor="">:</span> <span data-darkreader-inline-color="">[</span><br></span><span data-darkreader-inline-border-left="">        <span data-darkreader-inline-color="">{</span><br></span><span data-darkreader-inline-border-left="">          loader<span data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor="">:</span> <span data-darkreader-inline-color="">"ts-loader"</span><span data-darkreader-inline-color="">,</span><br></span><span data-darkreader-inline-border-left="">        <span data-darkreader-inline-color="">}</span><span data-darkreader-inline-color="">,</span><br></span><span data-darkreader-inline-border-left="">      <span data-darkreader-inline-color="">]</span><span data-darkreader-inline-color="">,</span><br></span><span data-darkreader-inline-border-left="">    <span data-darkreader-inline-color="">}</span><span data-darkreader-inline-color="">,</span><br></span><span data-darkreader-inline-border-left="">  <span data-darkreader-inline-color="">]</span><br></span><span data-darkreader-inline-border-left=""><span data-darkreader-inline-color="">}</span><br></span></code>
```

同时，在`tsconfig.json`中我们也需要设置

```
<section><span data-darkreader-inline-bgcolor=""></span><span data-darkreader-inline-bgcolor=""></span><span data-darkreader-inline-bgcolor=""></span></section><code data-line="236" data-darkreader-inline-bgimage=""><span data-darkreader-inline-border-left=""><span data-darkreader-inline-color="">{</span><br></span><span data-darkreader-inline-border-left="">    "compilerOptions"<span data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor="">:</span> <span data-darkreader-inline-color="">{</span><br></span><span data-darkreader-inline-border-left="">        ...<br></span><span data-darkreader-inline-border-left="">      "target"<span data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor="">:</span> <span data-darkreader-inline-color="">"ES5"</span><span data-darkreader-inline-color="">,</span><br></span><span data-darkreader-inline-border-left="">      "jsx"<span data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor="">:</span> <span data-darkreader-inline-color="">"react-jsx"</span><span data-darkreader-inline-color="">,</span><br></span><span data-darkreader-inline-border-left="">       "paths"<span data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor="">:</span> <span data-darkreader-inline-color="">{</span><br></span><span data-darkreader-inline-border-left="">          "@public/*"<span data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor="">:</span> <span data-darkreader-inline-color="">[</span><span data-darkreader-inline-color="">"public/*"</span><span data-darkreader-inline-color="">]</span><span data-darkreader-inline-color="">,</span><br></span><span data-darkreader-inline-border-left="">          "@comp/*"<span data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor="">:</span> <span data-darkreader-inline-color="">[</span><span data-darkreader-inline-color="">"src/components/*"</span><span data-darkreader-inline-color="">]</span><span data-darkreader-inline-color="">,</span><br></span><span data-darkreader-inline-border-left="">          "@utils/*"<span data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor="">:</span> <span data-darkreader-inline-color="">[</span><span data-darkreader-inline-color="">"src/utils/*"</span><span data-darkreader-inline-color="">]</span><span data-darkreader-inline-color="">,</span><br></span><span data-darkreader-inline-border-left="">          "@src/*"<span data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor="">:</span> <span data-darkreader-inline-color="">[</span><span data-darkreader-inline-color="">"src/*"</span><span data-darkreader-inline-color="">]</span><span data-darkreader-inline-color="">,</span><br></span><span data-darkreader-inline-border-left="">          "@assets"<span data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor="">:</span> <span data-darkreader-inline-color="">[</span><span data-darkreader-inline-color="">"src/assets/*"</span><span data-darkreader-inline-color="">]</span><br></span><span data-darkreader-inline-border-left="">        <span data-darkreader-inline-color="">}</span><span data-darkreader-inline-color="">,</span><br></span><span data-darkreader-inline-border-left="">        "baseUrl"<span data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor="">:</span> <span data-darkreader-inline-color="">"."</span><br></span><span data-darkreader-inline-border-left="">    <span data-darkreader-inline-color="">}</span><span data-darkreader-inline-color="">,</span><br></span><span data-darkreader-inline-border-left="">  <br></span><span data-darkreader-inline-border-left=""><span data-darkreader-inline-color="">}</span><br></span></code>
```

其中你看到有设置通用路径别名，不过，除了整理设置，我们同时也需要设置`resolve.alains`

```
<section><span data-darkreader-inline-bgcolor=""></span><span data-darkreader-inline-bgcolor=""></span><span data-darkreader-inline-bgcolor=""></span></section><code data-line="252" data-darkreader-inline-bgimage=""><span data-darkreader-inline-border-left="">module<span data-darkreader-inline-color="">.</span>exports <span data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor="">=</span> <span data-darkreader-inline-color="">{</span><br></span><span data-darkreader-inline-border-left="">    <span data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor="">...</span><br></span><span data-darkreader-inline-border-left="">    resolve<span data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor="">:</span> <span data-darkreader-inline-color="">{</span><br></span><span data-darkreader-inline-border-left="">      extensions<span data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor="">:</span> <span data-darkreader-inline-color="">[</span><span data-darkreader-inline-color="">".tsx"</span><span data-darkreader-inline-color="">,</span> <span data-darkreader-inline-color="">".ts"</span><span data-darkreader-inline-color="">,</span> <span data-darkreader-inline-color="">".js"</span><span data-darkreader-inline-color="">,</span> <span data-darkreader-inline-color="">".jsx"</span><span data-darkreader-inline-color="">]</span><span data-darkreader-inline-color="">,</span><br></span><span data-darkreader-inline-border-left="">      alias<span data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor="">:</span> <span data-darkreader-inline-color="">{</span><br></span><span data-darkreader-inline-border-left="">        "@public"<span data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor="">:</span> <span data-darkreader-inline-color="">resolvePath</span><span data-darkreader-inline-color="">(</span><span data-darkreader-inline-color="">"public/"</span><span data-darkreader-inline-color="">)</span><span data-darkreader-inline-color="">,</span><br></span><span data-darkreader-inline-border-left="">        "@utils"<span data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor="">:</span> <span data-darkreader-inline-color="">resolvePath</span><span data-darkreader-inline-color="">(</span><span data-darkreader-inline-color="">"src/utils/"</span><span data-darkreader-inline-color="">)</span><span data-darkreader-inline-color="">,</span><br></span><span data-darkreader-inline-border-left="">        "@src"<span data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor="">:</span> <span data-darkreader-inline-color="">resolvePath</span><span data-darkreader-inline-color="">(</span><span data-darkreader-inline-color="">"src/"</span><span data-darkreader-inline-color="">)</span><span data-darkreader-inline-color="">,</span><br></span><span data-darkreader-inline-border-left="">        "@comp"<span data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor="">:</span> <span data-darkreader-inline-color="">resolvePath</span><span data-darkreader-inline-color="">(</span><span data-darkreader-inline-color="">"src/components/"</span><span data-darkreader-inline-color="">)</span><span data-darkreader-inline-color="">,</span><br></span><span data-darkreader-inline-border-left="">        "@assets"<span data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor="">:</span> <span data-darkreader-inline-color="">resolvePath</span><span data-darkreader-inline-color="">(</span><span data-darkreader-inline-color="">"src/assets/"</span><span data-darkreader-inline-color="">)</span><span data-darkreader-inline-color="">,</span><br></span><span data-darkreader-inline-border-left="">      <span data-darkreader-inline-color="">}</span><br></span><span data-darkreader-inline-border-left="">    <span data-darkreader-inline-color="">}</span><br></span><span data-darkreader-inline-border-left=""><span data-darkreader-inline-color="">}</span><br></span></code>
```

这样你就可以在`tsx,jsx`文件中构建我们的组件了。

-   支持tailwindcss 参考官网tailwindcss\[1\],不过注意在`postcss.config.js`中设置
    

```
<section><span data-darkreader-inline-bgcolor=""></span><span data-darkreader-inline-bgcolor=""></span></section><code data-line="267" data-darkreader-inline-bgimage=""><span data-darkreader-inline-border-left="">module<span data-darkreader-inline-color="">.</span>exports <span data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor="">=</span> <span data-darkreader-inline-color="">{</span><br></span><span data-darkreader-inline-border-left="">    plugins<span data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor="">:</span> <span data-darkreader-inline-color="">{</span><br></span><span data-darkreader-inline-border-left="">      "postcss-import"<span data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor="">:</span> <span data-darkreader-inline-color="">{</span><span data-darkreader-inline-color="">}</span><span data-darkreader-inline-color="">,</span><br></span><span data-darkreader-inline-border-left="">      "tailwindcss/nesting"<span data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor="">:</span> <span data-darkreader-inline-color="">{</span><span data-darkreader-inline-color="">}</span><span data-darkreader-inline-color="">,</span><br></span><span data-darkreader-inline-border-left="">      tailwindcss<span data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor="">:</span> <span data-darkreader-inline-color="">{</span><span data-darkreader-inline-color="">}</span><span data-darkreader-inline-color="">,</span><br></span><span data-darkreader-inline-border-left="">      autoprefixer<span data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor="">:</span> <span data-darkreader-inline-color="">{</span><span data-darkreader-inline-color="">}</span><span data-darkreader-inline-color="">,</span><br></span><span data-darkreader-inline-border-left="">    <span data-darkreader-inline-color="">}</span><span data-darkreader-inline-color="">,</span><br></span><span data-darkreader-inline-border-left="">  <span data-darkreader-inline-color="">}</span><span data-darkreader-inline-color="">;</span><br></span><span data-darkreader-inline-border-left="">  <br></span></code>
```

其实我们已经完成了一个插件，当我们执行`pnpm run build:local`时，就会打包成一个插件的最终输出文件了

![Image](data:image/svg+xml,%3C%3Fxml version='1.0' encoding='UTF-8'%3F%3E%3Csvg width='1px' height='1px' viewBox='0 0 1 1' version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3E%3Ctitle%3E%3C/title%3E%3Cg stroke='none' stroke-width='1' fill='none' fill-rule='evenodd' fill-opacity='0'%3E%3Cg transform='translate(-249.000000, -126.000000)' fill='%23FFFFFF'%3E%3Crect x='249' y='126' width='1' height='1'%3E%3C/rect%3E%3C/g%3E%3C/g%3E%3C/svg%3E)

我们打开`chrome浏览器`,`扩展程序`\>`打开开发者模式`\>`加载已解压的扩展程序`这个文件夹即可

![Image](data:image/svg+xml,%3C%3Fxml version='1.0' encoding='UTF-8'%3F%3E%3Csvg width='1px' height='1px' viewBox='0 0 1 1' version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3E%3Ctitle%3E%3C/title%3E%3Cg stroke='none' stroke-width='1' fill='none' fill-rule='evenodd' fill-opacity='0'%3E%3Cg transform='translate(-249.000000, -126.000000)' fill='%23FFFFFF'%3E%3Crect x='249' y='126' width='1' height='1'%3E%3C/rect%3E%3C/g%3E%3C/g%3E%3C/svg%3E)

安装插件后，访问任何一个网站，我们在`content`写入的内容就生效了

![Image](data:image/svg+xml,%3C%3Fxml version='1.0' encoding='UTF-8'%3F%3E%3Csvg width='1px' height='1px' viewBox='0 0 1 1' version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3E%3Ctitle%3E%3C/title%3E%3Cg stroke='none' stroke-width='1' fill='none' fill-rule='evenodd' fill-opacity='0'%3E%3Cg transform='translate(-249.000000, -126.000000)' fill='%23FFFFFF'%3E%3Crect x='249' y='126' width='1' height='1'%3E%3C/rect%3E%3C/g%3E%3C/g%3E%3C/svg%3E)

不知道你有没有好奇，当我们使用插件时，我们必须修改代码，然后执行打包，然后重新加载插件看效果，这显然与我们实际开发有些繁琐，因此，你可以执行将`content`变成一个多页页面，这样可以就可以高效的开发了,不过你需要稍修改下`manifest.json`的`exclude_matches`,主要为了插件不在当前访问本地开发页面生效

```
<section><span data-darkreader-inline-bgcolor=""></span><span data-darkreader-inline-bgcolor=""></span><span data-darkreader-inline-bgcolor=""></span></section><code data-line="301" data-darkreader-inline-bgimage=""><span data-darkreader-inline-border-left="">   "content_scripts"<span data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor="">:</span> <span data-darkreader-inline-color="">[</span><br></span><span data-darkreader-inline-border-left="">        <span data-darkreader-inline-color="">{</span><br></span><span data-darkreader-inline-border-left="">            "matches"<span data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor="">:</span> <span data-darkreader-inline-color="">[</span><br></span><span data-darkreader-inline-border-left="">                <span data-darkreader-inline-color="">"&lt;all_urls&gt;"</span><br></span><span data-darkreader-inline-border-left="">            <span data-darkreader-inline-color="">]</span><span data-darkreader-inline-color="">,</span><br></span><span data-darkreader-inline-border-left="">            "exclude_matches"<span data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor="">:</span> <span data-darkreader-inline-color="">[</span><br></span><span data-darkreader-inline-border-left="">               <span data-darkreader-inline-color="">"http://localhost:8080/*"</span><br></span><span data-darkreader-inline-border-left="">            <span data-darkreader-inline-color="">]</span><span data-darkreader-inline-color="">,</span><br></span><span data-darkreader-inline-border-left="">            "js"<span data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor="">:</span> <span data-darkreader-inline-color="">[</span><br></span><span data-darkreader-inline-border-left="">                <span data-darkreader-inline-color="">"src/content/index.js"</span><br></span><span data-darkreader-inline-border-left="">            <span data-darkreader-inline-color="">]</span><span data-darkreader-inline-color="">,</span><br></span><span data-darkreader-inline-border-left="">            "css"<span data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor="">:</span> <span data-darkreader-inline-color="">[</span><br></span><span data-darkreader-inline-border-left="">                <span data-darkreader-inline-color="">"assets/css/index.css"</span><br></span><span data-darkreader-inline-border-left="">            <span data-darkreader-inline-color="">]</span><span data-darkreader-inline-color="">,</span><br></span><span data-darkreader-inline-border-left="">            <br></span><span data-darkreader-inline-border-left="">            "run_at"<span data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor="">:</span> <span data-darkreader-inline-color="">"document_end"</span><span data-darkreader-inline-color="">,</span><br></span><span data-darkreader-inline-border-left="">            "all_frames"<span data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor="">:</span> false<br></span><span data-darkreader-inline-border-left="">        <span data-darkreader-inline-color="">}</span><br></span><span data-darkreader-inline-border-left="">    <span data-darkreader-inline-color="">]</span><span data-darkreader-inline-color="">,</span><br></span></code>
```

![Image](data:image/svg+xml,%3C%3Fxml version='1.0' encoding='UTF-8'%3F%3E%3Csvg width='1px' height='1px' viewBox='0 0 1 1' version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3E%3Ctitle%3E%3C/title%3E%3Cg stroke='none' stroke-width='1' fill='none' fill-rule='evenodd' fill-opacity='0'%3E%3Cg transform='translate(-249.000000, -126.000000)' fill='%23FFFFFF'%3E%3Crect x='249' y='126' width='1' height='1'%3E%3C/rect%3E%3C/g%3E%3C/g%3E%3C/svg%3E)

至于`tab`页面，我们也是直接访问`/set.html`就可以了

![Image](data:image/svg+xml,%3C%3Fxml version='1.0' encoding='UTF-8'%3F%3E%3Csvg width='1px' height='1px' viewBox='0 0 1 1' version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3E%3Ctitle%3E%3C/title%3E%3Cg stroke='none' stroke-width='1' fill='none' fill-rule='evenodd' fill-opacity='0'%3E%3Cg transform='translate(-249.000000, -126.000000)' fill='%23FFFFFF'%3E%3Crect x='249' y='126' width='1' height='1'%3E%3C/rect%3E%3C/g%3E%3C/g%3E%3C/svg%3E)

因此一个插件的基础就基本完成了。

### 总结

-   理解一个插件的基本要素，关键是`manifest.json`这个文件必不可少
    
-   `webpack5`支持构建`react18.x`,支持`tsx`、`jsx`构建组件
    
-   如何让项目支持`tailwindcss`
    
-   预览当前构建的页面比如`set`页面，需要在`exclude_matches`字段中排出当前指定的端口域名
    
-   本文示例code example\[2\]
    

\[1\]tailwindcss： _https://tailwindcss.com/docs/installation_

\[2\]code example： _https://github.com/maicFir/base-chrome-plugin_

最后，看完觉得有收获的，点个赞，在看，转发，收藏等于学会，原创不易，欢迎关注Web技术学苑，好好学习，天天向上！  

Web Technology Learn

Web技术学苑

Interesting Original Story

有趣原创故事

https://skill.iruns.xyz

搜索

![Image](data:image/svg+xml,%3C%3Fxml version='1.0' encoding='UTF-8'%3F%3E%3Csvg width='1px' height='1px' viewBox='0 0 1 1' version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3E%3Ctitle%3E%3C/title%3E%3Cg stroke='none' stroke-width='1' fill='none' fill-rule='evenodd' fill-opacity='0'%3E%3Cg transform='translate(-249.000000, -126.000000)' fill='%23FFFFFF'%3E%3Crect x='249' y='126' width='1' height='1'%3E%3C/rect%3E%3C/g%3E%3C/g%3E%3C/svg%3E)

chrome · 目录

上一篇vue仿掘金chrome插件下一篇chrome插件实时通信的几种方式