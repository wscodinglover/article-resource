关注 Vue社区，回复“加群”

加入我们一起学习，天天进步

![Image](https://mmbiz.qpic.cn/sz_mmbiz_jpg/kzFgl6ibibNKqj8Ro0IiaWVTo0XkAXxniamcHOeGib71Qh7SE8El1QWHBAkYkGiaTrfe8t5UZHMmPemRoEQRlhPicsNicA/640?wx_fmt=jpeg&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1)

作者：八月十八  

https://juejin.cn/post/7277089907974422588

## 保持单向数据流

大家都知道 vue 是单项数据流的，子组件不能直接修改父组件传过来的 props，但是在我们封装组件使用 v-model 时，不小心就会打破单行数据流的规则，例如下面这样：

```
<span data-lazy-bgimg="https://mmbiz.qpic.cn/mmbiz_svg/eytJa9K5jkppu5YlAEcsYRUTDhfUjcCicGs5m3H4tZLwjNjjuyGTTvdRFV8LVHaMbicnjTFut86xLfldypE1yUdY5jicYcD5vUe/640?wx_fmt=svg" data-fail="0" data-darkreader-inline-outline="" data-darkreader-inline-bgcolor=""></span><code data-darkreader-inline-outline="" data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor=""><span data-darkreader-inline-outline="" data-darkreader-inline-color="">&lt;!--&nbsp;父组件&nbsp;--&gt;</span><br><span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">my-component</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">v-model</span>=<span data-darkreader-inline-outline="" data-darkreader-inline-color="">"msg"</span>&gt;</span><span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">my-component</span>&gt;</span><br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">&lt;!--&nbsp;子组件&nbsp;--&gt;</span><br><span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">template</span>&gt;</span><br>&nbsp;&nbsp;<span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">div</span>&gt;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">el-input</span>&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">v-model</span>=<span data-darkreader-inline-outline="" data-darkreader-inline-color="">"msg"</span>&gt;</span><span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">el-input</span>&gt;</span><br>&nbsp;&nbsp;<span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">div</span>&gt;</span><br><span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">template</span>&gt;</span><br><span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">script</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">setup</span>&gt;</span><span data-darkreader-inline-outline=""><br>defineOptions({<br>&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">name</span>:&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">"my-component"</span>,<br>});<br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">const</span>&nbsp;props&nbsp;=&nbsp;defineProps({<br>&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">msg</span>:&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">type</span>:&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">String</span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">default</span>:&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">""</span>,<br>&nbsp;&nbsp;},<br>});<br></span><span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">script</span>&gt;</span><br></code>
```

## v-model 实现原理

直接在子组件上修改 props 的值，就打破了单向数据流，那我们该怎么做呢，先看下 v-model 的实现原理：

```
<span data-lazy-bgimg="https://mmbiz.qpic.cn/mmbiz_svg/eytJa9K5jkppu5YlAEcsYRUTDhfUjcCicGs5m3H4tZLwjNjjuyGTTvdRFV8LVHaMbicnjTFut86xLfldypE1yUdY5jicYcD5vUe/640?wx_fmt=svg" data-fail="0" data-darkreader-inline-outline="" data-darkreader-inline-bgcolor=""></span><code data-darkreader-inline-outline="" data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor=""><span data-darkreader-inline-outline="" data-darkreader-inline-color="">&lt;!--&nbsp;父组件&nbsp;--&gt;</span><br><span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">template</span>&gt;</span><br>&nbsp;&nbsp;<span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">my-component</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">v-model</span>=<span data-darkreader-inline-outline="" data-darkreader-inline-color="">"msg"</span>&gt;</span><span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">my-component</span>&gt;</span><br>&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">&lt;!--&nbsp;等同于&nbsp;--&gt;</span><br>&nbsp;&nbsp;<span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">my-component</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">:modelValue</span>=<span data-darkreader-inline-outline="" data-darkreader-inline-color="">"msg"</span>&nbsp;@<span data-darkreader-inline-outline="" data-darkreader-inline-color="">update:modelValue</span>=<span data-darkreader-inline-outline="" data-darkreader-inline-color="">"msg&nbsp;=&nbsp;$event"</span>&gt;</span><span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">my-component</span>&gt;</span><br><span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">template</span>&gt;</span><br></code>
```

## emit 通知父组件修改 prop 值

所以，我们可以通过 emit，子组件的值变化了，不是直接修改 props,而是通知父组件去修改该值!

子组件值修改，触发父组件的 update:modelValue 事件，并将新的值传过去，父组件将 msg 更新为新的值，代码如下：

```
<span data-lazy-bgimg="https://mmbiz.qpic.cn/mmbiz_svg/eytJa9K5jkppu5YlAEcsYRUTDhfUjcCicGs5m3H4tZLwjNjjuyGTTvdRFV8LVHaMbicnjTFut86xLfldypE1yUdY5jicYcD5vUe/640?wx_fmt=svg" data-fail="0" data-darkreader-inline-outline="" data-darkreader-inline-bgcolor=""></span><code data-darkreader-inline-outline="" data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor=""><span data-darkreader-inline-outline="" data-darkreader-inline-color="">&lt;!--&nbsp;父组件&nbsp;--&gt;</span><br><span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">template</span>&gt;</span><br>&nbsp;&nbsp;<span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">my-component</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">v-model</span>=<span data-darkreader-inline-outline="" data-darkreader-inline-color="">"msg"</span>&gt;</span><span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">my-component</span>&gt;</span><br>&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">&lt;!--&nbsp;等同于&nbsp;--&gt;</span><br>&nbsp;&nbsp;<span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">my-component</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">:modelValue</span>=<span data-darkreader-inline-outline="" data-darkreader-inline-color="">"msg"</span>&nbsp;@<span data-darkreader-inline-outline="" data-darkreader-inline-color="">update:modelValue</span>=<span data-darkreader-inline-outline="" data-darkreader-inline-color="">"msg&nbsp;=&nbsp;$event"</span>&gt;</span><span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">my-component</span>&gt;</span><br><span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">template</span>&gt;</span><br><span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">script</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">setup</span>&gt;</span><span data-darkreader-inline-outline=""><br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">import</span>&nbsp;{&nbsp;ref&nbsp;}&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">from</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">'vue'</span><br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">const</span>&nbsp;msg&nbsp;=&nbsp;ref(<span data-darkreader-inline-outline="" data-darkreader-inline-color="">'hello'</span>)<br></span><span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">script</span>&gt;</span><br><br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">&lt;!--&nbsp;子组件&nbsp;--&gt;</span><br><span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">template</span>&gt;</span><br>&nbsp;&nbsp;<span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">el-input</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">:modelValue</span>=<span data-darkreader-inline-outline="" data-darkreader-inline-color="">"modelValue"</span>&nbsp;@<span data-darkreader-inline-outline="" data-darkreader-inline-color="">update:modelValue</span>=<span data-darkreader-inline-outline="" data-darkreader-inline-color="">"handleValueChange"</span>&gt;</span><span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">el-input</span>&gt;</span><br><span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">template</span>&gt;</span><br><span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">script</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">setup</span>&gt;</span><span data-darkreader-inline-outline=""><br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">const</span>&nbsp;props&nbsp;=&nbsp;defineProps({<br>&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">modelValue</span>:&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">type</span>:&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">String</span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">default</span>:&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">''</span>,<br>&nbsp;&nbsp;}<br>});<br><br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">const</span>&nbsp;emit&nbsp;=&nbsp;defineEmits([<span data-darkreader-inline-outline="" data-darkreader-inline-color="">'update:modelValue'</span>]);<br><br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">const</span>&nbsp;handleValueChange&nbsp;=&nbsp;<span data-darkreader-inline-outline="">(<span data-darkreader-inline-outline="">value</span>)&nbsp;=&gt;</span>&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">//&nbsp;子组件值修改，触发父组件的update:modelValue事件，并将新的值传过去，父组件将msg更新为新的值</span><br>&nbsp;&nbsp;&nbsp;&nbsp;emit(<span data-darkreader-inline-outline="" data-darkreader-inline-color="">'update:modelValue'</span>,&nbsp;value)<br>}<br></span><span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">script</span>&gt;</span><br></code>
```

这也是大多数开发者封装组件修改值的方法，其实还有另一种方案，就是利用计算数据的 `get`、`set`

## computed 拦截 prop

大多数同学使用计算属性，都是用 get，或许有部分同学甚至不知道计算属性还有 set，下面我们看下实现方式吧：

```
<span data-lazy-bgimg="https://mmbiz.qpic.cn/mmbiz_svg/eytJa9K5jkppu5YlAEcsYRUTDhfUjcCicGs5m3H4tZLwjNjjuyGTTvdRFV8LVHaMbicnjTFut86xLfldypE1yUdY5jicYcD5vUe/640?wx_fmt=svg" data-fail="0" data-darkreader-inline-outline="" data-darkreader-inline-bgcolor=""></span><code data-darkreader-inline-outline="" data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor="">&lt;!--&nbsp;父组件&nbsp;--&gt;<br><span data-darkreader-inline-outline=""><span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">script</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">setup</span>&gt;</span><span data-darkreader-inline-outline=""><br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">import</span>&nbsp;myComponent&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">from</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">"./components/MyComponent.vue"</span>;<br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">import</span>&nbsp;{&nbsp;ref&nbsp;}&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">from</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">"vue"</span>;<br><br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">const</span>&nbsp;msg&nbsp;=&nbsp;ref(<span data-darkreader-inline-outline="" data-darkreader-inline-color="">'hello'</span>)<br></span><span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">script</span>&gt;</span></span><br><br><span data-darkreader-inline-outline=""><span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">template</span>&gt;</span><br>&nbsp;&nbsp;<span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">div</span>&gt;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">my-component</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">v-model</span>=<span data-darkreader-inline-outline="" data-darkreader-inline-color="">"msg"</span>&gt;</span><span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">my-component</span>&gt;</span><br>&nbsp;&nbsp;<span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">div</span>&gt;</span><br><span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">template</span>&gt;</span></span><br><br><br>&lt;!--&nbsp;子组件&nbsp;--&gt;<br><span data-darkreader-inline-outline=""><span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">template</span>&gt;</span><br>&nbsp;&nbsp;<span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">el-input</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">v-model</span>=<span data-darkreader-inline-outline="" data-darkreader-inline-color="">"msg"</span>&gt;</span><span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">el-input</span>&gt;</span><br><span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">template</span>&gt;</span></span><br><span data-darkreader-inline-outline=""><span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">script</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">setup</span>&gt;</span><span data-darkreader-inline-outline=""><br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">import</span>&nbsp;{&nbsp;computed&nbsp;}&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">from</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">"vue"</span>;<br><br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">const</span>&nbsp;props&nbsp;=&nbsp;defineProps({<br>&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">modelValue</span>:&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">type</span>:&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">String</span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">default</span>:&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">""</span>,<br>&nbsp;&nbsp;},<br>});<br><br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">const</span>&nbsp;emit&nbsp;=&nbsp;defineEmits([<span data-darkreader-inline-outline="" data-darkreader-inline-color="">"update:modelValue"</span>]);<br><br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">const</span>&nbsp;msg&nbsp;=&nbsp;computed({<br>&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">//&nbsp;getter</span><br>&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">get</span>()&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">return</span>&nbsp;props.modelValue<br>&nbsp;&nbsp;},<br>&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">//&nbsp;setter</span><br>&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">set</span>(newValue)&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;emit(<span data-darkreader-inline-outline="" data-darkreader-inline-color="">'update:modelValue'</span>,newValue)<br>&nbsp;&nbsp;},<br>});<br></span><span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">script</span>&gt;</span></span><br></code>
```

## v-model 绑定对象

那么当 v-model 绑定的是对象呢？可以像下面这样，computed 拦截多个值

```
<span data-lazy-bgimg="https://mmbiz.qpic.cn/mmbiz_svg/eytJa9K5jkppu5YlAEcsYRUTDhfUjcCicGs5m3H4tZLwjNjjuyGTTvdRFV8LVHaMbicnjTFut86xLfldypE1yUdY5jicYcD5vUe/640?wx_fmt=svg" data-fail="0" data-darkreader-inline-outline="" data-darkreader-inline-bgcolor=""></span><code data-darkreader-inline-outline="" data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor=""><span data-darkreader-inline-outline="" data-darkreader-inline-color="">&lt;!--&nbsp;父组件&nbsp;--&gt;</span><br><span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">script</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">setup</span>&gt;</span><span data-darkreader-inline-outline=""><br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">import</span>&nbsp;myComponent&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">from</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">"./components/MyComponent.vue"</span>;<br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">import</span>&nbsp;{&nbsp;ref&nbsp;}&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">from</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">"vue"</span>;<br><br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">const</span>&nbsp;form&nbsp;=&nbsp;ref({<br>&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">name</span>:<span data-darkreader-inline-outline="" data-darkreader-inline-color="">'张三'</span>,<br>&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">age</span>:<span data-darkreader-inline-outline="" data-darkreader-inline-color="">18</span>,<br>&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">sex</span>:<span data-darkreader-inline-outline="" data-darkreader-inline-color="">'man'</span><br>})<br></span><span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">script</span>&gt;</span><br><br><span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">template</span>&gt;</span><br>&nbsp;&nbsp;<span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">div</span>&gt;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">my-component</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">v-model</span>=<span data-darkreader-inline-outline="" data-darkreader-inline-color="">"form"</span>&gt;</span><span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">my-component</span>&gt;</span><br>&nbsp;&nbsp;<span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">div</span>&gt;</span><br><span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">template</span>&gt;</span><br><br><br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">&lt;!--&nbsp;子组件&nbsp;--&gt;</span><br><span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">template</span>&gt;</span><br>&nbsp;&nbsp;<span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">div</span>&gt;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">el-input</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">v-model</span>=<span data-darkreader-inline-outline="" data-darkreader-inline-color="">"name"</span>&gt;</span><span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">el-input</span>&gt;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">el-input</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">v-model</span>=<span data-darkreader-inline-outline="" data-darkreader-inline-color="">"age"</span>&gt;</span><span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">el-input</span>&gt;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">el-input</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">v-model</span>=<span data-darkreader-inline-outline="" data-darkreader-inline-color="">"sex"</span>&gt;</span><span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">el-input</span>&gt;</span><br>&nbsp;&nbsp;<span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">div</span>&gt;</span><br><span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">template</span>&gt;</span><br><span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">script</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">setup</span>&gt;</span><span data-darkreader-inline-outline=""><br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">import</span>&nbsp;{&nbsp;computed&nbsp;}&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">from</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">"vue"</span>;<br><br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">const</span>&nbsp;props&nbsp;=&nbsp;defineProps({<br>&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">modelValue</span>:&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">type</span>:&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">Object</span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">default</span>:&nbsp;<span data-darkreader-inline-outline=""><span data-darkreader-inline-outline="">()</span>&nbsp;=&gt;</span>&nbsp;{},<br>&nbsp;&nbsp;},<br>});<br><br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">const</span>&nbsp;emit&nbsp;=&nbsp;defineEmits([<span data-darkreader-inline-outline="" data-darkreader-inline-color="">"update:modelValue"</span>]);<br><br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">const</span>&nbsp;name&nbsp;=&nbsp;computed({<br>&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">//&nbsp;getter</span><br>&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">get</span>()&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">return</span>&nbsp;props.modelValue.name;<br>&nbsp;&nbsp;},<br>&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">//&nbsp;setter</span><br>&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">set</span>(newValue)&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;emit(<span data-darkreader-inline-outline="" data-darkreader-inline-color="">"update:modelValue"</span>,&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...props.modelValue,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">name</span>:&nbsp;newValue,<br>&nbsp;&nbsp;&nbsp;&nbsp;});<br>&nbsp;&nbsp;},<br>});<br><br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">const</span>&nbsp;age&nbsp;=&nbsp;computed({<br>&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">get</span>()&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">return</span>&nbsp;props.modelValue.age;<br>&nbsp;&nbsp;},<br>&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">set</span>(newValue)&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;emit(<span data-darkreader-inline-outline="" data-darkreader-inline-color="">"update:modelValue"</span>,&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...props.modelValue,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">age</span>:&nbsp;newValue,<br>&nbsp;&nbsp;&nbsp;&nbsp;});<br>&nbsp;&nbsp;},<br>});<br><br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">const</span>&nbsp;sex&nbsp;=&nbsp;computed({<br>&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">get</span>()&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">return</span>&nbsp;props.modelValue.sex;<br>&nbsp;&nbsp;},<br>&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">set</span>(newValue)&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;emit(<span data-darkreader-inline-outline="" data-darkreader-inline-color="">"update:modelValue"</span>,&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...props.modelValue,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">sex</span>:&nbsp;newValue,<br>&nbsp;&nbsp;&nbsp;&nbsp;});<br>&nbsp;&nbsp;},<br>});<br></span><span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">script</span>&gt;</span><br></code>
```

这样是可以实现我们的需求，但是一个个手动拦截 v-model 对象的属性值，太过于麻烦，假如有 10 个输入，我们就需要拦截 10 次，所以我们需要将拦截整合起来！

## 监听整个对象

```
<span data-lazy-bgimg="https://mmbiz.qpic.cn/mmbiz_svg/eytJa9K5jkppu5YlAEcsYRUTDhfUjcCicGs5m3H4tZLwjNjjuyGTTvdRFV8LVHaMbicnjTFut86xLfldypE1yUdY5jicYcD5vUe/640?wx_fmt=svg" data-fail="0" data-darkreader-inline-outline="" data-darkreader-inline-bgcolor=""></span><code data-darkreader-inline-outline="" data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor=""><span data-darkreader-inline-outline="" data-darkreader-inline-color="">&lt;!--&nbsp;父组件&nbsp;--&gt;</span><br><span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">script</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">setup</span>&gt;</span><span data-darkreader-inline-outline=""><br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">import</span>&nbsp;myComponent&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">from</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">"./components/MyComponent.vue"</span>;<br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">import</span>&nbsp;{&nbsp;ref&nbsp;}&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">from</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">"vue"</span>;<br><br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">const</span>&nbsp;form&nbsp;=&nbsp;ref({<br>&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">name</span>:<span data-darkreader-inline-outline="" data-darkreader-inline-color="">'张三'</span>,<br>&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">age</span>:<span data-darkreader-inline-outline="" data-darkreader-inline-color="">18</span>,<br>&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">sex</span>:<span data-darkreader-inline-outline="" data-darkreader-inline-color="">'man'</span><br>})<br></span><span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">script</span>&gt;</span><br><br><span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">template</span>&gt;</span><br>&nbsp;&nbsp;<span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">div</span>&gt;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">my-component</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">v-model</span>=<span data-darkreader-inline-outline="" data-darkreader-inline-color="">"form"</span>&gt;</span><span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">my-component</span>&gt;</span><br>&nbsp;&nbsp;<span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">div</span>&gt;</span><br><span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">template</span>&gt;</span><br><br><br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">&lt;!--&nbsp;子组件&nbsp;--&gt;</span><br><span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">template</span>&gt;</span><br>&nbsp;&nbsp;<span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">div</span>&gt;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">el-input</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">v-model</span>=<span data-darkreader-inline-outline="" data-darkreader-inline-color="">"form.name"</span>&gt;</span><span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">el-input</span>&gt;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">el-input</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">v-model</span>=<span data-darkreader-inline-outline="" data-darkreader-inline-color="">"form.age"</span>&gt;</span><span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">el-input</span>&gt;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">el-input</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">v-model</span>=<span data-darkreader-inline-outline="" data-darkreader-inline-color="">"form.sex"</span>&gt;</span><span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">el-input</span>&gt;</span><br>&nbsp;&nbsp;<span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">div</span>&gt;</span><br><span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">template</span>&gt;</span><br><span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">script</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">setup</span>&gt;</span><span data-darkreader-inline-outline=""><br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">import</span>&nbsp;{&nbsp;computed&nbsp;}&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">from</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">"vue"</span>;<br><br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">const</span>&nbsp;props&nbsp;=&nbsp;defineProps({<br>&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">modelValue</span>:&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">type</span>:&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">Object</span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">default</span>:&nbsp;<span data-darkreader-inline-outline=""><span data-darkreader-inline-outline="">()</span>&nbsp;=&gt;</span>&nbsp;{},<br>&nbsp;&nbsp;},<br>});<br><br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">const</span>&nbsp;emit&nbsp;=&nbsp;defineEmits([<span data-darkreader-inline-outline="" data-darkreader-inline-color="">"update:modelValue"</span>]);<br><br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">const</span>&nbsp;form&nbsp;=&nbsp;computed({<br>&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">get</span>()&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">return</span>&nbsp;props.modelValue;<br>&nbsp;&nbsp;},<br>&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">set</span>(newValue)&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;alert(<span data-darkreader-inline-outline="" data-darkreader-inline-color="">123</span>)<br>&nbsp;&nbsp;&nbsp;&nbsp;emit(<span data-darkreader-inline-outline="" data-darkreader-inline-color="">"update:modelValue"</span>,&nbsp;newValue);<br>&nbsp;&nbsp;},<br>});<br></span><span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">script</span>&gt;</span><br></code>
```

这样看起来很完美，但是，我们在 set 中 alert(123),它却并未执行！！

原因是：form.xxx = xxx 时，并不会触发 computed 的 set，只有 form = xxx 时，才会触发 set

## Proxy 代理对象

那么，我们需要想一个办法，在 form 的属性修改时，也能 emit("update:modelValue", newValue);，为了解决这个问题，我们可以通过 Proxy 代理

```
<span data-lazy-bgimg="https://mmbiz.qpic.cn/mmbiz_svg/eytJa9K5jkppu5YlAEcsYRUTDhfUjcCicGs5m3H4tZLwjNjjuyGTTvdRFV8LVHaMbicnjTFut86xLfldypE1yUdY5jicYcD5vUe/640?wx_fmt=svg" data-fail="0" data-darkreader-inline-outline="" data-darkreader-inline-bgcolor=""></span><code data-darkreader-inline-outline="" data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor=""><span data-darkreader-inline-outline="" data-darkreader-inline-color="">&lt;!--&nbsp;父组件&nbsp;--&gt;</span><br><span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">script</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">setup</span>&gt;</span><span data-darkreader-inline-outline=""><br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">import</span>&nbsp;myComponent&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">from</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">"./components/MyComponent.vue"</span>;<br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">import</span>&nbsp;{&nbsp;ref,&nbsp;watch&nbsp;}&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">from</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">"vue"</span>;<br><br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">const</span>&nbsp;form&nbsp;=&nbsp;ref({<br>&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">name</span>:&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">"张三"</span>,<br>&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">age</span>:&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">18</span>,<br>&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">sex</span>:&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">"man"</span>,<br>});<br><br>watch(form,&nbsp;(newValue)&nbsp;=&gt;&nbsp;{<br>&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">console</span>.log(newValue);<br>});<br></span><span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">script</span>&gt;</span><br><br><span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">template</span>&gt;</span><br>&nbsp;&nbsp;<span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">div</span>&gt;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">my-component</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">v-model</span>=<span data-darkreader-inline-outline="" data-darkreader-inline-color="">"form"</span>&gt;</span><span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">my-component</span>&gt;</span><br>&nbsp;&nbsp;<span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">div</span>&gt;</span><br><span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">template</span>&gt;</span><br><br><br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">&lt;!--&nbsp;子组件&nbsp;--&gt;</span><br><span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">template</span>&gt;</span><br>&nbsp;&nbsp;<span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">div</span>&gt;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">el-input</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">v-model</span>=<span data-darkreader-inline-outline="" data-darkreader-inline-color="">"form.name"</span>&gt;</span><span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">el-input</span>&gt;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">el-input</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">v-model</span>=<span data-darkreader-inline-outline="" data-darkreader-inline-color="">"form.age"</span>&gt;</span><span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">el-input</span>&gt;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">el-input</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">v-model</span>=<span data-darkreader-inline-outline="" data-darkreader-inline-color="">"form.sex"</span>&gt;</span><span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">el-input</span>&gt;</span><br>&nbsp;&nbsp;<span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">div</span>&gt;</span><br><span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">template</span>&gt;</span><br><span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">script</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">setup</span>&gt;</span><span data-darkreader-inline-outline=""><br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">import</span>&nbsp;{&nbsp;computed&nbsp;}&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">from</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">"vue"</span>;<br><br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">const</span>&nbsp;props&nbsp;=&nbsp;defineProps({<br>&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">modelValue</span>:&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">type</span>:&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">Object</span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">default</span>:&nbsp;<span data-darkreader-inline-outline=""><span data-darkreader-inline-outline="">()</span>&nbsp;=&gt;</span>&nbsp;{},<br>&nbsp;&nbsp;},<br>});<br><br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">const</span>&nbsp;emit&nbsp;=&nbsp;defineEmits([<span data-darkreader-inline-outline="" data-darkreader-inline-color="">"update:modelValue"</span>]);<br><br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">const</span>&nbsp;form&nbsp;=&nbsp;computed({<br>&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">get</span>()&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">return</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">new</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">Proxy</span>(props.modelValue,&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">get</span>(target,&nbsp;key)&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">return</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">Reflect</span>.get(target,&nbsp;key);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;},<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">set</span>(target,&nbsp;key,&nbsp;value,receiver)&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;emit(<span data-darkreader-inline-outline="" data-darkreader-inline-color="">"update:modelValue"</span>,&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...target,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[key]:&nbsp;value,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;});<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">return</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">true</span>;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;},<br>&nbsp;&nbsp;&nbsp;&nbsp;});<br>&nbsp;&nbsp;},<br>&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">set</span>(newValue)&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;emit(<span data-darkreader-inline-outline="" data-darkreader-inline-color="">"update:modelValue"</span>,&nbsp;newValue);<br>&nbsp;&nbsp;},<br>});<br></span><span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">script</span>&gt;</span><br></code>
```

这样，我们就通过了 Proxy + computed 完美拦截了 v-model 的对象!

然后，为了后面使用方便，我们直接将其封装成 hook

```
<span data-lazy-bgimg="https://mmbiz.qpic.cn/mmbiz_svg/eytJa9K5jkppu5YlAEcsYRUTDhfUjcCicGs5m3H4tZLwjNjjuyGTTvdRFV8LVHaMbicnjTFut86xLfldypE1yUdY5jicYcD5vUe/640?wx_fmt=svg" data-fail="0" data-darkreader-inline-outline="" data-darkreader-inline-bgcolor=""></span><code data-darkreader-inline-outline="" data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor=""><span data-darkreader-inline-outline="" data-darkreader-inline-color="">//&nbsp;useVModel.js</span><br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">import</span>&nbsp;{&nbsp;computed&nbsp;}&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">from</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">"vue"</span>;<br><br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">export</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">default</span>&nbsp;<span data-darkreader-inline-outline=""><span data-darkreader-inline-outline="" data-darkreader-inline-color="">function</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">useVModle</span>(<span data-darkreader-inline-outline="">props,&nbsp;propName,&nbsp;emit</span>)&nbsp;</span>{<br>&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">return</span>&nbsp;computed({<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">get</span>()&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">return</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">new</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">Proxy</span>(props[propName],&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">get</span>(target,&nbsp;key)&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">return</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">Reflect</span>.get(target,&nbsp;key)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;},<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">set</span>(target,&nbsp;key,&nbsp;newValue)&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;emit(<span data-darkreader-inline-outline="" data-darkreader-inline-color="">'update:'</span>&nbsp;+&nbsp;propName,&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...target,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[key]:&nbsp;newValue<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;})<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">return</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">true</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;})<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;},<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">set</span>(value)&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;emit(<span data-darkreader-inline-outline="" data-darkreader-inline-color="">'update:'</span>&nbsp;+&nbsp;propName,&nbsp;value)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;})<br>}<br></code>
```

```
<span data-lazy-bgimg="https://mmbiz.qpic.cn/mmbiz_svg/eytJa9K5jkppu5YlAEcsYRUTDhfUjcCicGs5m3H4tZLwjNjjuyGTTvdRFV8LVHaMbicnjTFut86xLfldypE1yUdY5jicYcD5vUe/640?wx_fmt=svg" data-fail="0" data-darkreader-inline-outline="" data-darkreader-inline-bgcolor=""></span><code data-darkreader-inline-outline="" data-darkreader-inline-color="" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor=""><span data-darkreader-inline-outline="" data-darkreader-inline-color="">&lt;!--&nbsp;子组件使用&nbsp;--&gt;</span><br><span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">template</span>&gt;</span><br>&nbsp;&nbsp;<span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">div</span>&gt;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">el-input</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">v-model</span>=<span data-darkreader-inline-outline="" data-darkreader-inline-color="">"form.name"</span>&gt;</span><span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">el-input</span>&gt;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">el-input</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">v-model</span>=<span data-darkreader-inline-outline="" data-darkreader-inline-color="">"form.age"</span>&gt;</span><span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">el-input</span>&gt;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">el-input</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">v-model</span>=<span data-darkreader-inline-outline="" data-darkreader-inline-color="">"form.sex"</span>&gt;</span><span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">el-input</span>&gt;</span><br>&nbsp;&nbsp;<span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">div</span>&gt;</span><br><span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">template</span>&gt;</span><br><span data-darkreader-inline-outline="">&lt;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">script</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">setup</span>&gt;</span><span data-darkreader-inline-outline=""><br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">import</span>&nbsp;useVModel&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">from</span>&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">"../hooks/useVModel"</span>;<br><br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">const</span>&nbsp;props&nbsp;=&nbsp;defineProps({<br>&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">modelValue</span>:&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">type</span>:&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">Object</span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">default</span>:&nbsp;<span data-darkreader-inline-outline=""><span data-darkreader-inline-outline="">()</span>&nbsp;=&gt;</span>&nbsp;{},<br>&nbsp;&nbsp;},<br>});<br><br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">const</span>&nbsp;emit&nbsp;=&nbsp;defineEmits([<span data-darkreader-inline-outline="" data-darkreader-inline-color="">"update:modelValue"</span>]);<br><br><span data-darkreader-inline-outline="" data-darkreader-inline-color="">const</span>&nbsp;form&nbsp;=&nbsp;useVModel(props,&nbsp;<span data-darkreader-inline-outline="" data-darkreader-inline-color="">"modelValue"</span>,&nbsp;emit);<br><br></span><span data-darkreader-inline-outline="">&lt;/<span data-darkreader-inline-outline="" data-darkreader-inline-color="">script</span>&gt;</span></code>
```

## ❤️ 看完两件事

如果你觉得这篇内容对你挺有启发，我想邀请你帮我两个小忙：

1.  点个「**在看**」，让更多的人也能看到这篇内容（喜欢不点在看，都是耍流氓 -\_-）
    
2.  关注公众号「**Vue社区**」，每周重点攻克一个前端面试重难点，
    
    公众号后台回复「**电子书**」即可免费获取 27本 精选的前端电子书！
    

![Image](data:image/svg+xml,%3C%3Fxml version='1.0' encoding='UTF-8'%3F%3E%3Csvg width='1px' height='1px' viewBox='0 0 1 1' version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3E%3Ctitle%3E%3C/title%3E%3Cg stroke='none' stroke-width='1' fill='none' fill-rule='evenodd' fill-opacity='0'%3E%3Cg transform='translate(-249.000000, -126.000000)' fill='%23FFFFFF'%3E%3Crect x='249' y='126' width='1' height='1'%3E%3C/rect%3E%3C/g%3E%3C/g%3E%3C/svg%3E)

点个在看支持我吧，转发就更好了