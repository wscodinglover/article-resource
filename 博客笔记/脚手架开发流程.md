目前日常工作中常用的脚手架有 vue-cli、create-react-app、angular-cli 等等，都是通过简单的初始化命令，完成内容的快速构建。脚手架是我们经常用到的可以提效的工具，经常用在一些代码重复性高的项目中，开发者通过输入命令行、回答问题，就能快速生成一套代码，来避免手动编写。下面我们就来了解脚手架的构建流程和必备工具。

## 1\. 搭建框架

#### 1.1 新建cli目录

```
mkdir&nbsp;my-cli&nbsp;&amp;&amp;&nbsp;<span data-darkreader-inline-color="">cd</span>&nbsp;my-cli&nbsp;//&nbsp;创建仓库目录<br>npm&nbsp;init&nbsp;//&nbsp;初始化&nbsp;package.json<br>
```

#### 1.2 新建bin文件夹，添加main.js

```
mkdir&nbsp;bin&nbsp;&amp;&amp;&nbsp;cd&nbsp;bin&nbsp;&amp;&amp;&nbsp;touch&nbsp;main.js<br>
```

编辑main.js文件：

```
<span data-darkreader-inline-color="">#!&nbsp;/usr/bin/env&nbsp;node</span><br><br>console.log(<span data-darkreader-inline-color="">'my-cli&nbsp;start'</span>)<br>
```

##### #! /usr/bin/env node 作用：

`#!` 是为了指定脚本的解释程序，可是不同用户或者不同的脚本解释器有可能安装在不同的目录下，系统如何知道要去哪里找你的解释程序呢？ `/usr/bin/env` 就是告诉系统可以在PATH目录中查找。所以配置`#!/usr/bin/env node`, 就是解决了不同的用户node路径不同的问题，可以让系统动态的去查找node来执行你的脚本文件。可以通过`which node`命令来找到你本地的node安装路径，将 `/usr/bin/env` 改为你查找到的node路径即可。目录结构如下：

```
my-cli&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>├─&nbsp;bin&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>│&nbsp;&nbsp;└─&nbsp;main.js&nbsp;&nbsp;<br>├─&nbsp;package-lock.json<br>└─&nbsp;package.json&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
```

#### 1.3 在 package.json 文件中指定入口文件为 bin/main.js

```
{<br>&nbsp;&nbsp;<span data-darkreader-inline-color="">"name"</span>:&nbsp;<span data-darkreader-inline-color="">"my-cli"</span>,<br>&nbsp;&nbsp;<span data-darkreader-inline-color="">"version"</span>:&nbsp;<span data-darkreader-inline-color="">"1.0.0"</span>,<br>&nbsp;&nbsp;<span data-darkreader-inline-color="">"description"</span>:&nbsp;<span data-darkreader-inline-color="">""</span>,<br>&nbsp;&nbsp;<span data-darkreader-inline-color="">"main"</span>:&nbsp;<span data-darkreader-inline-color="">"bin/cli.js"</span>,<br>&nbsp;&nbsp;<span data-darkreader-inline-color="">"bin"</span>:&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-color="">"test-cli"</span>:&nbsp;<span data-darkreader-inline-color="">"bin/cli.js"</span>&nbsp;<span data-darkreader-inline-color="">//手动添加入口文件</span><br>&nbsp;&nbsp;},<br>&nbsp;&nbsp;<span data-darkreader-inline-color="">"scripts"</span>:&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-color="">"test"</span>:&nbsp;<span data-darkreader-inline-color="">"echo&nbsp;\"Error:&nbsp;no&nbsp;test&nbsp;specified\"&nbsp;&amp;&amp;&nbsp;exit&nbsp;1"</span><br>&nbsp;&nbsp;},<br>&nbsp;&nbsp;<span data-darkreader-inline-color="">"author"</span>:&nbsp;<span data-darkreader-inline-color="">""</span>,<br>&nbsp;&nbsp;<span data-darkreader-inline-color="">"license"</span>:&nbsp;<span data-darkreader-inline-color="">"ISC"</span><br>}<br>
```

#### 1.4 npm link 链接到全局

`npm install`可以把发布在npmjs平台上的模块包下载到本地，但这仅限于已经发布的包，对于未发布的包，或者调试一个线上的包，我们如何测试使用呢？npm官方早已考虑到了这一点，给我们提供了测试本地的包的工具指令`npm link`。npm link可以帮助我们模拟包安装后的状态，它会在系统中做一个快捷方式映射，让本地的包就好像install过一样，可以直接使用。在MAC中，我们在终端可以直接敲命令，其实是在执行/usr/local/bin目录下的脚本，这个目录可以认为是我们的全局命令所在的地方。而我们在`npm install -g`的时候，其实是将相关文件安装在/usr/local/lib/node\_modules目录下，同时，在/usr/local/bin目录下会有一个映射脚本，将其指向/usr/local/lib/node\_modules下的真实文件。这么做的好处是，在保证只有一份可执行文件的前提下，给命令取别名。而npm link做的事也差不多，只不过它在/usr/local/lib/node\_modules里存的不是真实的文件，而是存了一个快捷方式，指向你当前执行`npm link`的目录。如果开发的是node包，**则执行的命令名和真实执行的文件入口，会通过项目的package.json里bin的配置来获取。**

```
npm&nbsp;link<br>
```

执行完成：![Image](data:image/svg+xml,%3C%3Fxml version='1.0' encoding='UTF-8'%3F%3E%3Csvg width='1px' height='1px' viewBox='0 0 1 1' version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3E%3Ctitle%3E%3C/title%3E%3Cg stroke='none' stroke-width='1' fill='none' fill-rule='evenodd' fill-opacity='0'%3E%3Cg transform='translate(-249.000000, -126.000000)' fill='%23FFFFFF'%3E%3Crect x='249' y='126' width='1' height='1'%3E%3C/rect%3E%3C/g%3E%3C/g%3E%3C/svg%3E)

这个时候，在终端执行一下 `my-cli`, 就会打印出我们的 `“my-cli start”`![Image](data:image/svg+xml,%3C%3Fxml version='1.0' encoding='UTF-8'%3F%3E%3Csvg width='1px' height='1px' viewBox='0 0 1 1' version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3E%3Ctitle%3E%3C/title%3E%3Cg stroke='none' stroke-width='1' fill='none' fill-rule='evenodd' fill-opacity='0'%3E%3Cg transform='translate(-249.000000, -126.000000)' fill='%23FFFFFF'%3E%3Crect x='249' y='126' width='1' height='1'%3E%3C/rect%3E%3C/g%3E%3C/g%3E%3C/svg%3E)

## 2\. 工具

手脚架开发过程中使用了一些工具，比如交互提示，获取用户输入，高亮，生成模板等等。这里对他们进行简单的介绍，方便后续的开发。

### 2.1 commander 自定义命令行指令

commander 是一个命令行解决方案。通过它可以告诉用户脚手架的命令与功能，以及处理用户输入。安装：`npm install commander` 使用：

```
<span data-darkreader-inline-color="">#!/usr/bin/env&nbsp;node</span><br>const&nbsp;program&nbsp;=&nbsp;require(<span data-darkreader-inline-color="">'commander'</span>);<br>const&nbsp;pkg&nbsp;=&nbsp;require(<span data-darkreader-inline-color="">'../package.json'</span>);<br><br>//&nbsp;名称，描述，版本号，用法提示。<br>program<br>&nbsp;.name(<span data-darkreader-inline-color="">'my-cli'</span>)<br>&nbsp;&nbsp;.description(<span data-darkreader-inline-color="">'这是一个脚手架，用来生成vue/react框架'</span>)<br>&nbsp;&nbsp;.version(`my-cli&nbsp;<span data-darkreader-inline-color="">${pkg.version}</span>`)<br>&nbsp;&nbsp;.usage(<span data-darkreader-inline-color="">'&lt;command&gt;&nbsp;[options]'</span>)<br><br>program<br>&nbsp;&nbsp;.<span data-darkreader-inline-color="">command</span>(<span data-darkreader-inline-color="">'create&nbsp;&lt;app-name&gt;'</span>)<br>&nbsp;&nbsp;.description(<span data-darkreader-inline-color="">'创建项目'</span>)&nbsp;//&nbsp;命令描述<br>&nbsp;&nbsp;.option(<span data-darkreader-inline-color="">'-f,--force'</span>,&nbsp;<span data-darkreader-inline-color="">'是否强制覆盖已有项目'</span>)&nbsp;//&nbsp;传入action的第二个参数<br>&nbsp; .action((name, options)&nbsp;=&gt;&nbsp;{&nbsp;//&nbsp;输入该命令的动作，逻辑实现。<br>&nbsp;&nbsp;&nbsp;//&nbsp;name&nbsp;为用户输入在create命令后面输入的名称<br>&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;options&nbsp;为&nbsp;上一步的f参数<br>&nbsp;&nbsp;&nbsp;&nbsp;console.log(<span data-darkreader-inline-color="">'创建项目name：'</span>,&nbsp;name);<br>&nbsp;&nbsp;&nbsp;&nbsp;console.log(<span data-darkreader-inline-color="">'选项options：'</span>,&nbsp;options)<br>&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;create(name,&nbsp;options)<br>&nbsp;&nbsp;})<br><br>program.parse(process.argv)<br>
```

执行命令： `my-cli create test -f`， 会出现如下：![Image](data:image/svg+xml,%3C%3Fxml version='1.0' encoding='UTF-8'%3F%3E%3Csvg width='1px' height='1px' viewBox='0 0 1 1' version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3E%3Ctitle%3E%3C/title%3E%3Cg stroke='none' stroke-width='1' fill='none' fill-rule='evenodd' fill-opacity='0'%3E%3Cg transform='translate(-249.000000, -126.000000)' fill='%23FFFFFF'%3E%3Crect x='249' y='126' width='1' height='1'%3E%3C/rect%3E%3C/g%3E%3C/g%3E%3C/svg%3E)

### 2.2 chalk

chalk 是一个终端字符串美化工具。安装：`npm install chalk` 使用：chalk.blue 表字体蓝色，chalk.red 表字体红色，chalk.underline 表下划线，chalk.bgRed 表背景红色

```
<span data-darkreader-inline-color="">const</span>&nbsp;chalk&nbsp;=&nbsp;<span data-darkreader-inline-color="">require</span>(<span data-darkreader-inline-color="">'chalk'</span>);<br><br><span data-darkreader-inline-color="">console</span>.log(<span data-darkreader-inline-color="">`<br>&nbsp;&nbsp;<span data-darkreader-inline-color="">${chalk.blue(<span data-darkreader-inline-color="">'hello'</span>)}</span>,<br>&nbsp;&nbsp;<span data-darkreader-inline-color="">${chalk.red(<span data-darkreader-inline-color="">'this'</span>)}</span>&nbsp;<br>&nbsp;&nbsp;<span data-darkreader-inline-color="">${chalk.underline(<span data-darkreader-inline-color="">'is'</span>)}</span>&nbsp;<br>&nbsp;&nbsp;<span data-darkreader-inline-color="">${chalk.bgRed(<span data-darkreader-inline-color="">'chalk'</span>)}</span>!<br>`</span>);<br>
```

美化效果：![Image](data:image/svg+xml,%3C%3Fxml version='1.0' encoding='UTF-8'%3F%3E%3Csvg width='1px' height='1px' viewBox='0 0 1 1' version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3E%3Ctitle%3E%3C/title%3E%3Cg stroke='none' stroke-width='1' fill='none' fill-rule='evenodd' fill-opacity='0'%3E%3Cg transform='translate(-249.000000, -126.000000)' fill='%23FFFFFF'%3E%3Crect x='249' y='126' width='1' height='1'%3E%3C/rect%3E%3C/g%3E%3C/g%3E%3C/svg%3E)

### 2.3 inquirer

交互式命令行界面。提供了询问操作者问题，获取并解析用户输入，多层级的提示，提供错误回调，检测用户回答是否合法等能力。安装：`npm install inquirer`

inquirer.prompt(arr)方法接受一个数组参数，数组的每一项都有一个type值，用来表示交互命令的类型：

-   \*\*input: \*\*输入类型的交互
    
-   \*\*number: \*\*输入数字的交互
    
-   \*\*confirm: \*\*确认类型的交互
    
-   \*\*list: \*\*单选列表交互
    
-   \*\*rawlist: \*\*带序号的单选列表交互
    
-   \*\*expand: \*\*扩展显示的交互
    
-   \*\*checkbox: \*\*多选列表交互
    
-   **password:** 输入类型，但是输入值不可见的交互
    
-   **editor:** 编辑器交互
    

使用：

```
<span data-darkreader-inline-color="">const</span>&nbsp;inquirer&nbsp;=&nbsp;<span data-darkreader-inline-color="">require</span>(<span data-darkreader-inline-color="">'inquirer'</span>)<br><br><span data-darkreader-inline-color="">const</span>&nbsp;arr&nbsp;=&nbsp;[<br>&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-color="">type</span>:&nbsp;<span data-darkreader-inline-color="">'input'</span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-color="">name</span>:&nbsp;<span data-darkreader-inline-color="">'projectName'</span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-color="">message</span>:&nbsp;<span data-darkreader-inline-color="">'项目名称'</span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-color="">default</span>:&nbsp;<span data-darkreader-inline-color="">'vue-demo'</span>,<br>&nbsp;&nbsp;},<br>&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-color="">type</span>:&nbsp;<span data-darkreader-inline-color="">'list'</span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-color="">name</span>:&nbsp;<span data-darkreader-inline-color="">'projectType'</span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-color="">message</span>:&nbsp;<span data-darkreader-inline-color="">'项目类型'</span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-color="">default</span>:&nbsp;<span data-darkreader-inline-color="">'vue2'</span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-color="">choices</span>:&nbsp;[<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;<span data-darkreader-inline-color="">name</span>:&nbsp;<span data-darkreader-inline-color="">'vue2'</span>,&nbsp;<span data-darkreader-inline-color="">value</span>:&nbsp;<span data-darkreader-inline-color="">'vue2'</span>&nbsp;},<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;<span data-darkreader-inline-color="">name</span>:&nbsp;<span data-darkreader-inline-color="">'vue3'</span>,&nbsp;<span data-darkreader-inline-color="">value</span>:&nbsp;<span data-darkreader-inline-color="">'vue3'</span>&nbsp;},<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;<span data-darkreader-inline-color="">name</span>:&nbsp;<span data-darkreader-inline-color="">'react'</span>,&nbsp;<span data-darkreader-inline-color="">value</span>:&nbsp;<span data-darkreader-inline-color="">'react'</span>&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;},<br>&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-color="">type</span>:&nbsp;<span data-darkreader-inline-color="">'checkbox'</span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-color="">name</span>:&nbsp;<span data-darkreader-inline-color="">'plugins'</span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-color="">message</span>:&nbsp;<span data-darkreader-inline-color="">'插件选择'</span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-color="">choices</span>:&nbsp;[<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;<span data-darkreader-inline-color="">name</span>:&nbsp;<span data-darkreader-inline-color="">'babel'</span>,&nbsp;<span data-darkreader-inline-color="">value</span>:&nbsp;<span data-darkreader-inline-color="">'babel'</span>&nbsp;},<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;<span data-darkreader-inline-color="">name</span>:&nbsp;<span data-darkreader-inline-color="">'eslint'</span>,&nbsp;<span data-darkreader-inline-color="">value</span>:&nbsp;<span data-darkreader-inline-color="">'eslint'</span>&nbsp;},<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;<span data-darkreader-inline-color="">name</span>:&nbsp;<span data-darkreader-inline-color="">'vue-router'</span>,&nbsp;<span data-darkreader-inline-color="">value</span>:&nbsp;<span data-darkreader-inline-color="">'vue-router'</span>&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;]<br>&nbsp;&nbsp;},<br>&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-color="">type</span>:&nbsp;<span data-darkreader-inline-color="">'confirm'</span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-color="">name</span>:&nbsp;<span data-darkreader-inline-color="">'confirm'</span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-color="">message</span>:&nbsp;<span data-darkreader-inline-color="">'confirm'</span>,<br>&nbsp;&nbsp;}<br>];<br><br>inquirer.prompt(arr).then(<span><span>answers</span>&nbsp;=&gt;</span>&nbsp;{<br>&nbsp;&nbsp;<span data-darkreader-inline-color="">console</span>.log(<span data-darkreader-inline-color="">'=============='</span>);<br>&nbsp;&nbsp;<span data-darkreader-inline-color="">console</span>.log(answers);<br>}).catch(<span><span>error</span>&nbsp;=&gt;</span>&nbsp;{<br>&nbsp;&nbsp;<span data-darkreader-inline-color="">console</span>.log(<span data-darkreader-inline-color="">'--------------'</span>)<br>&nbsp;&nbsp;<span data-darkreader-inline-color="">console</span>.log(error)<br>})<br>
```

![Image](data:image/svg+xml,%3C%3Fxml version='1.0' encoding='UTF-8'%3F%3E%3Csvg width='1px' height='1px' viewBox='0 0 1 1' version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3E%3Ctitle%3E%3C/title%3E%3Cg stroke='none' stroke-width='1' fill='none' fill-rule='evenodd' fill-opacity='0'%3E%3Cg transform='translate(-249.000000, -126.000000)' fill='%23FFFFFF'%3E%3Crect x='249' y='126' width='1' height='1'%3E%3C/rect%3E%3C/g%3E%3C/g%3E%3C/svg%3E)

image.png

**选择分支，可通过when实现**

```
{<br>&nbsp;&nbsp;<span data-darkreader-inline-color="">type</span>:&nbsp;<span data-darkreader-inline-color="">"checkbox"</span>,<br>&nbsp;&nbsp;<span data-darkreader-inline-color="">name</span>:&nbsp;<span data-darkreader-inline-color="">"preferredJsSkills"</span>,<br>&nbsp;&nbsp;<span data-darkreader-inline-color="">choices</span>:&nbsp;[<br>&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;<span data-darkreader-inline-color="">name</span>:&nbsp;<span data-darkreader-inline-color="">"Express"</span>&nbsp;},<br>&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;<span data-darkreader-inline-color="">name</span>:&nbsp;<span data-darkreader-inline-color="">"Sequelize"</span>&nbsp;},<br>&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;<span data-darkreader-inline-color="">name</span>:&nbsp;<span data-darkreader-inline-color="">"Graphql"</span>&nbsp;}<br>&nbsp;&nbsp;],<br>&nbsp;&nbsp;<span data-darkreader-inline-color="">when</span>:&nbsp;<span><span data-darkreader-inline-color="">function</span>&nbsp;(<span>answers</span>)&nbsp;</span>{<br>&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-color="">return</span>&nbsp;answers.computerLanguage&nbsp;==&nbsp;<span data-darkreader-inline-color="">"JavaScript'<br>&nbsp;&nbsp;}<br>}<br></span>
```

校验输入，比如校验邮箱，输入格式错误不允许继续往下走

```
{<br>&nbsp;&nbsp;<span data-darkreader-inline-color="">type</span>:&nbsp;<span data-darkreader-inline-color="">"input"</span>,<br>&nbsp;&nbsp;<span data-darkreader-inline-color="">name</span>:&nbsp;<span data-darkreader-inline-color="">"email"</span>,<br>&nbsp;&nbsp;<span data-darkreader-inline-color="">message</span>:&nbsp;<span data-darkreader-inline-color="">"What's&nbsp;your&nbsp;email&nbsp;address?"</span>,<br>&nbsp;&nbsp;<span data-darkreader-inline-color="">validate</span>:&nbsp;<span><span data-darkreader-inline-color="">function</span>&nbsp;(<span>value</span>)&nbsp;</span>{<br>&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-color="">let</span>&nbsp;pass&nbsp;=&nbsp;value.match(<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-color="">/^[a-zA-Z0-9.!#$%&amp;'*+/=?^_`{l}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)*$/</span>);&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-color="">if</span>&nbsp;(pass)&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-color="">return</span>&nbsp;<span data-darkreader-inline-color="">true</span>;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-color="">return</span>&nbsp;<span data-darkreader-inline-color="">"Please&nbsp;enter&nbsp;a&nbsp;valid&nbsp;email&nbsp;address."</span>;<br><br>&nbsp;&nbsp;},<br>}<br>
```

现在来实现简化版vue-cli 选择配置部分

```
&nbsp;<span data-darkreader-inline-color="">const</span>&nbsp;arr&nbsp;=&nbsp;[<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-color="">name</span>:&nbsp;<span data-darkreader-inline-color="">'template'</span>,&nbsp;<span data-darkreader-inline-color="">// preset 记录用户选择的选项值。</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-color="">type</span>:&nbsp;<span data-darkreader-inline-color="">'list'</span>,&nbsp;<span data-darkreader-inline-color="">//&nbsp;list&nbsp;表单选</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-color="">message</span>:&nbsp;<span data-darkreader-inline-color="">`选择创建的模版:`</span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-color="">choices</span>:&nbsp;[<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-color="">name</span>:&nbsp;<span data-darkreader-inline-color="">'react'</span>,&nbsp;<span data-darkreader-inline-color="">//&nbsp;手动选择配置，自定义特性配置</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-color="">value</span>:&nbsp;<span data-darkreader-inline-color="">'react'</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;},<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-color="">name</span>:&nbsp;<span data-darkreader-inline-color="">'vue'</span>,&nbsp;<span data-darkreader-inline-color="">//&nbsp;手动选择配置，自定义特性配置</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-color="">value</span>:&nbsp;<span data-darkreader-inline-color="">'vue'</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;]<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;]<br><br>inquirer.prompt(arr).then(<span><span>answers</span>&nbsp;=&gt;</span>&nbsp;{<br>&nbsp;&nbsp;<span data-darkreader-inline-color="">console</span>.log(<span data-darkreader-inline-color="">'=============='</span>);<br>&nbsp;&nbsp;<span data-darkreader-inline-color="">console</span>.log(answers);<br>}).catch(<span><span>error</span>&nbsp;=&gt;</span>&nbsp;{<br>&nbsp;&nbsp;<span data-darkreader-inline-color="">console</span>.log(<span data-darkreader-inline-color="">'--------------'</span>)<br>&nbsp;&nbsp;<span data-darkreader-inline-color="">console</span>.log(error)<br>})<br>
```

执行 `my-cli create test -f` 后，会出现以下选项：![Image](data:image/svg+xml,%3C%3Fxml version='1.0' encoding='UTF-8'%3F%3E%3Csvg width='1px' height='1px' viewBox='0 0 1 1' version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3E%3Ctitle%3E%3C/title%3E%3Cg stroke='none' stroke-width='1' fill='none' fill-rule='evenodd' fill-opacity='0'%3E%3Cg transform='translate(-249.000000, -126.000000)' fill='%23FFFFFF'%3E%3Crect x='249' y='126' width='1' height='1'%3E%3C/rect%3E%3C/g%3E%3C/g%3E%3C/svg%3E)

### 2.4 ejs

高效的嵌入式 JavaScript 模板引擎。模板可以通过数据进行动态渲染。安装：`npm install ejs` 使用：可以根据用户命令行输入的值，渲染模版。

```
<span data-darkreader-inline-color="">#!&nbsp;/usr/bin/env&nbsp;node</span><br><br><span data-darkreader-inline-color="">const</span>&nbsp;inquirer&nbsp;=&nbsp;<span data-darkreader-inline-color="">require</span>(<span data-darkreader-inline-color="">'inquirer'</span>)<br><span data-darkreader-inline-color="">const</span>&nbsp;path&nbsp;=&nbsp;<span data-darkreader-inline-color="">require</span>(<span data-darkreader-inline-color="">'path'</span>)<br><span data-darkreader-inline-color="">const</span>&nbsp;fs&nbsp;=&nbsp;<span data-darkreader-inline-color="">require</span>(<span data-darkreader-inline-color="">'fs'</span>)<br><span data-darkreader-inline-color="">const</span>&nbsp;ejs&nbsp;=&nbsp;<span data-darkreader-inline-color="">require</span>(<span data-darkreader-inline-color="">'ejs'</span>)<br><br>inquirer.prompt([<br>&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-color="">type</span>:&nbsp;<span data-darkreader-inline-color="">'input'</span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-color="">name</span>:&nbsp;<span data-darkreader-inline-color="">'name'</span>,&nbsp;<br>&nbsp;&nbsp;}<br>]).then(<span><span>answers</span>&nbsp;=&gt;</span>&nbsp;{<br>&nbsp;&nbsp;<span data-darkreader-inline-color="">//&nbsp;模版文件目录</span><br>&nbsp;&nbsp;<span data-darkreader-inline-color="">const</span>&nbsp;destUrl&nbsp;=&nbsp;path.join(__dirname,&nbsp;<span data-darkreader-inline-color="">'templates'</span>);&nbsp;<br>&nbsp;&nbsp;<span data-darkreader-inline-color="">//&nbsp;生成文件目录</span><br>&nbsp;&nbsp;<span data-darkreader-inline-color="">//&nbsp;process.cwd()&nbsp;对应控制台所在目录</span><br>&nbsp;&nbsp;<span data-darkreader-inline-color="">const</span>&nbsp;cwdUrl&nbsp;=&nbsp;process.cwd();<br>&nbsp;&nbsp;<span data-darkreader-inline-color="">//&nbsp;从模版目录中读取文件</span><br>&nbsp;&nbsp;fs.readdir(destUrl,&nbsp;(err,&nbsp;files)&nbsp;=&gt;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-color="">if</span>&nbsp;(err)&nbsp;<span data-darkreader-inline-color="">throw</span>&nbsp;err;<br>&nbsp;&nbsp;&nbsp;&nbsp;files.forEach(<span>(<span>file</span>)&nbsp;=&gt;</span>&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-color="">//&nbsp;使用&nbsp;ejs&nbsp;渲染对应的模版文件</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-color="">//&nbsp;renderFile（模版文件地址，传入渲染数据）</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ejs.renderFile(path.join(destUrl,&nbsp;file),&nbsp;answers).then(<span><span>data</span>&nbsp;=&gt;</span>&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span data-darkreader-inline-color="">//&nbsp;生成&nbsp;ejs&nbsp;处理后的模版文件</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fs.writeFileSync(path.join(cwdUrl,&nbsp;file)&nbsp;,&nbsp;data)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;})<br>&nbsp;&nbsp;&nbsp;&nbsp;})<br>&nbsp;&nbsp;})<br>})<br>
```

### 2.5 ora 命令行 loading 动效

安装：npm install ora 用法：

```
<span data-darkreader-inline-color="">const</span>&nbsp;spinner&nbsp;=&nbsp;ora(<span data-darkreader-inline-color="">'Loading&nbsp;unicorns'</span>).start();<br><br>setTimeout(<span><span>()</span>&nbsp;=&gt;</span>&nbsp;{<br>&nbsp;spinner.color&nbsp;=&nbsp;<span data-darkreader-inline-color="">'yellow'</span>;<br>&nbsp;spinner.text&nbsp;=&nbsp;<span data-darkreader-inline-color="">'Loading&nbsp;rainbows'</span>;<br>},&nbsp;<span data-darkreader-inline-color="">1000</span>);<br>
```

### 2.6 download-git-repo 下载模版

安装：npm install download-git-repo 使用：download(repository, destination, options, callback) https://www.npmjs.com/package/download-git-repo

\- END \-

## 关于奇舞团

奇舞团是 360 集团最大的大前端团队，代表集团参与 W3C 和 ECMA 会员（TC39）工作。奇舞团非常重视人才培养，有工程师、讲师、翻译官、业务接口人、团队 Leader 等多种发展方向供员工选择，并辅以提供相应的技术力、专业力、通用力、领导力等培训课程。奇舞团以开放和求贤的心态欢迎各种优秀人才关注和加入奇舞团。  

![Image](data:image/svg+xml,%3C%3Fxml version='1.0' encoding='UTF-8'%3F%3E%3Csvg width='1px' height='1px' viewBox='0 0 1 1' version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3E%3Ctitle%3E%3C/title%3E%3Cg stroke='none' stroke-width='1' fill='none' fill-rule='evenodd' fill-opacity='0'%3E%3Cg transform='translate(-249.000000, -126.000000)' fill='%23FFFFFF'%3E%3Crect x='249' y='126' width='1' height='1'%3E%3C/rect%3E%3C/g%3E%3C/g%3E%3C/svg%3E)